function GetTraitRank(t){return cV.traitInfo[t]?cV.traitInfo[t].rank:0}function ScaleStat(t,a,e,r){var i=a<=800||1==r?1:2==r?Math.pow(.996754034,a-800):Math.pow(.994435486,a-800),s=e<=800||1==r?1:2==r?Math.pow(.996754034,e-800):Math.pow(.994435486,e-800),n=(t/=i)*Math.pow(1.00936,e-a);return n*=s}function MsToFormattedTime(t,a){a&&(t-=currFightData.start_time);var e=Math.floor(t/6e4),r=Math.floor((t-6e4*e)/1e3);return(e<10?"0":"")+e+":"+(r<10?"0":"")+r}function NumberToFormattedNumber(t,a,e,r){return a=a||0,t>1e9?(t/1e9).toFixed(a)+"M":t>1e6?(e&&(a=e),(t/1e6).toFixed(a)+"m"):t>1e3?(r&&(a=r),(t/1e3).toFixed(a)+"k"):Math.floor(t)}function error_msg(t){$("#main").html('<div class="panel"><div class="col-full"><div class="box">'+t+"</div></div></div>")}function AddStatAmount(t,a,e,r,i,s,n){healPerStat[t].amount+=a/r,healPerStat[t].total+=a;var o="int"==t?a:i-a;healPerStat[t].avg+=r*o,healPerStat[t].avgCount+=o,healPerStat[t].all+=i,healPerStat[t].spells||(healPerStat[t].spells={}),healPerStat[t].spells[s]=(healPerStat[t].spells[s]||0)+a/r,Object.keys(statsBuffs[t]).forEach(function(e){buffStatus[e]&&(rV.buffs[t][e]||(rV.buffs[t][e]=0),rV.buffs[t][e]+=statsBuffs[t][e]/r*a*("number"==typeof buffStatus[e]?buffStatus[e]:1))});for(var l=0,c=delayedSpells.length;l<c;l++){var m=pV[delayedSpells[l][0]];if(!delayedSpells[l][2][s]&&n<=m.time){m[t].amount+=e/r,m[t].total+=e,m[t].avg+=r*e,m[t].avgCount+=e,m[t].all+=i,m[t].spells||(m[t].spells={}),m[t].spells[s]=(m[t].spells[s]||0)+i,Object.keys(statsBuffs[t]).forEach(function(a){buffStatus[a]&&(m[t].buffs[a]||(m[t].buffs[a]=0),m[t].buffs[a]+=statsBuffs[t][a]/r*e)});for(var d=0,u=multiplicateCDs.length;d<u;d++)multiplicateCDs[d][0](delayedSpells[l][1],n)&&((m=pV[multiplicateCDs[d][1]][multiplicateCDs[d][2]])[t].amount+=e/r,m[t].total+=e,m[t].avg+=r*e,m[t].avgCount+=e,m[t].all+=i,Object.keys(statsBuffs[t]).forEach(function(a){buffStatus[a]&&(m[t].buffs[a]||(m[t].buffs[a]=0),m[t].buffs[a]+=statsBuffs[t][a]/r*e)}))}}}function ParseLog(t,a,e,r){$.getJSON("https://www.warcraftlogs.com:443/v1/report/events/"+t+"?start="+e+"&end="+r+"&actorid="+a+"&api_key="+WCL_API_KEY).done(function(e){if(400==e.status)throw error_msg(e.error),new Error("Error: Parsing Error");actors[a]=!0;try{for(var i=0,s=e.events.length;i<s;i++){var n=e.events[i];if((1==n.resourceActor?n.sourceID:n.targetID)==a&&n.spellPower&&(cV.intellect=n.spellPower,cV.intellect_min=Math.min(cV.intellect_min,cV.intellect)),"heal"!=n.type&&"absorbed"!=n.type||!actors[n.sourceID]){if("summon"==n.type&&actors[n.sourceID])actors[n.targetID]=!0;else if("applybuff"==n.type&&actors[n.targetID]){c=n.ability.guid;(statsBuffs.vers[c]||statsBuffs.crit[c]||statsBuffs.haste[c]||statsBuffs.haste_mod[c]||statsBuffs.mastery[c]||statsBuffs.int[c])&&(buffStatus[c]=!0),29166==c&&(pV.innervate=!0),cooldownsTrackingIDs[c]&&cooldownsTracking.push({opened:!0,spellID:c,start:n.timestamp,spells:[],mana:0,heal:[],healing:0});for(var o=0,l=parsePlugins.applybuff.length;o<l;o++)parsePlugins.applybuff[o](n,c)}else if("applybuffstack"==n.type&&actors[n.targetID]){c=n.ability.guid;(statsBuffs.vers[c]||statsBuffs.crit[c]||statsBuffs.haste[c]||statsBuffs.haste_mod[c]||statsBuffs.mastery[c]||statsBuffs.int[c])&&(buffStatus[c]=n.stack);for(var o=0,l=parsePlugins.applybuffstack.length;o<l;o++)parsePlugins.applybuffstack[o](n,c)}else if("removebuff"==n.type&&actors[n.targetID]){c=n.ability.guid;if((statsBuffs.vers[c]||statsBuffs.crit[c]||statsBuffs.haste[c]||statsBuffs.haste_mod[c]||statsBuffs.mastery[c]||statsBuffs.int[c])&&(buffStatus[c]=!1),29166==c?pV.innervate=!1:53390==c&&(pV.critTidalLoss=n.timestamp+500),cooldownsTrackingIDs[c])for(var o=0,l=cooldownsTracking.length;o<l;o++)cooldownsTracking[o].opened&&cooldownsTracking[o].spellID==c&&(cooldownsTracking[o].ended=n.timestamp,cooldownsTracking[o].opened=!1);for(var o=0,l=parsePlugins.removebuff.length;o<l;o++)parsePlugins.removebuff[o](n,c)}else if("removebuffstack"==n.type&&actors[n.targetID]){c=n.ability.guid;(statsBuffs.vers[c]||statsBuffs.crit[c]||statsBuffs.haste[c]||statsBuffs.haste_mod[c]||statsBuffs.mastery[c]||statsBuffs.int[c])&&(buffStatus[c]=n.stack),53390==c&&(pV.critTidalLoss=n.timestamp+500);for(var o=0,l=parsePlugins.removebuffstack.length;o<l;o++)parsePlugins.removebuffstack[o](n,c)}else if("begincast"==n.type&&actors[n.sourceID])for(var c=n.ability.guid,o=0,l=parsePlugins.begincast.length;o<l;o++)parsePlugins.begincast[o](n,c);else if("cast"==n.type&&actors[n.sourceID]){c=n.ability.guid;if(cooldownsTrackingIDsbyCast[c]&&cooldownsTracking.push({opened:!0,spellID:c,start:n.timestamp,end_limit:n.timestamp+cooldownsTrackingIDsbyCast[c],spells:[],mana:0,heal:[],healing:0}),spellManaCost[c]&&!pV.innervate){rV.manaUsage+=spellManaCost[c],rV.manaUsageBySpell[c]=(rV.manaUsageBySpell[c]||0)+spellManaCost[c],pV.manaUsageLastSpell=c;for(var o=0,l=cooldownsTracking.length;o<l;o++)cooldownsTracking[o].opened&&(cooldownsTracking[o].mana+=spellManaCost[c])}for(var o=0,l=cooldownsTracking.length;o<l;o++)cooldownsTracking[o].opened&&!ignoredSpellsForCDTracking[c]&&cooldownsTracking[o].spells.push({spell:c,time:n.timestamp-cooldownsTracking[o].start});if(201764==c)for(var o=0,l=cooldownsTracking.length;o<l;o++)cooldownsTracking[o].opened&&157153==cooldownsTracking[o].spellID&&(cooldownsTracking[o].ended=n.timestamp,cooldownsTracking[o].opened=!1);else 98008==c&&sltTracking.push({start:n.timestamp,heal:[],damage:[]});for(var o=0,l=parsePlugins.cast.length;o<l;o++)parsePlugins.cast[o](n,c)}else if("damage"==n.type){if(98021==(c=n.ability.guid))for(var o=0,l=sltTracking.length;o<l;o++)if(n.timestamp-sltTracking[o].start<8e3){for(var m=n.timestamp-sltTracking[o].start,d=-1,u=0,p=sltTracking[o].damage.length;u<p;u++){if(m==sltTracking[o].damage[u].time){d=u;break}if(m>sltTracking[o].damage[u].time&&m-sltTracking[o].damage[u].time<=500){m=sltTracking[o].damage[u].time,d=u;break}}-1==d&&(sltTracking[o].damage.push({time:m,data:[]}),d=sltTracking[o].damage.length-1),sltTracking[o].damage[d].data[n.targetID]||(sltTracking[o].damage[d].data[n.targetID]={amount:0,absorbed:0}),sltTracking[o].damage[d].data[n.targetID].amount+=n.amount,n.absorbed&&(sltTracking[o].damage[d].data[n.targetID].absorbed+=n.absorbed),sltTracking[o].ended=n.timestamp}for(var o=0,l=parsePlugins.damage.length;o<l;o++)parsePlugins.damage[o](n,c)}else if("energize"==n.type&&n.targetID==a){if(0==n.resourceChangeType){c=n.ability.guid;rV.manaGain+=n.resourceChange;for(var o=0,l=parsePlugins.energize.length;o<l;o++)parsePlugins.energize[o](n,c)}}else if("combatantinfo"==n.type&&n.sourceID==a){if(264!=n.specID)throw error_msg("Wrong specialization"),new Error("Wrong specialization");for(var u=0,p=n.gear.length;u<p;u++){var f=n.gear[u];f.slot=u,cV.gearInfo[f.id]=f;for(var o=0,l=parsePlugins.gear.length;o<l;o++)parsePlugins.gear[o](f,f.id)}for(var u=0,p=n.artifact.length;u<p;u++){var v=n.artifact[u];cV.traitInfo[v.traitID]=v}for(var u=0,p=n.talents.length;u<p;u++){var h=n.talents[u];h.row=u+1,cV.talentInfo[h.id]=h}for(var g=0,u=0,p=n.auras.length;u<p;u++){var b=n.auras[u];vantusRunes[b.ability]&&(g=1500);for(var o=0,l=parsePlugins.applybuff.length;o<l;o++)parsePlugins.applybuff[o](n,b.ability)}cV.critSpell=n.critSpell+2e3,cV.intellect=n.intellect,cV.intellect_min=cV.intellect,cV.versatility=n.versatilityHealingDone+g,cV.mastery=n.mastery+3200,cV.haste=n.hasteSpell,cV.gcd=1500/(cV.haste/375/100+1),cV.combantantInfo=n;for(var o=0,l=parsePlugins.combantantInfo.length;o<l;o++)parsePlugins.combantantInfo[o](n)}}else{c=n.ability.guid;healingData[c]||(healingData[c]=[0,0]);var V=n.amount,w=n.overheal||0;if(n.absorbed&&(V+=n.absorbed),n.absorb&&(V+=n.absorb),healingData[c][0]+=V,n.overheal&&(healingData[c][1]+=n.overheal),healingFromMana[c]&&(rV.healFromMana+=V*healingFromMana[c]),spellScaleInt[c]&&AddStatAmount("int",V,V+w,cV.intellect,V,c,n.timestamp),2==n.hitType){pV.critNow=cV.critSpell,pV.critAmount=V/(cV.gearInfo[142170]?2.05/1.05:2);var y=(V+w)/(cV.gearInfo[142170]?2.05/1.05:2);Object.keys(statsBuffs.crit).forEach(function(t){buffStatus[t]&&(pV.critNow+=statsBuffs.crit[t])}),1064==c?pV.critNow+=4*GetTraitRank(1109)*400:73921==c?pV.critNow+=2*GetTraitRank(1107)*400:8004==c&&n.timestamp<=pV.critTidalLoss&&(pV.critNow+=400*(4*GetTraitRank(1103)+40)),AddStatAmount("crit",pV.critAmount,y,pV.critNow,V,c,n.timestamp)}if(spellScaleMastery[c]&&2==n.resourceActor&&n.hitPoints&&n.maxHitPoints){var _=Math.max(n.hitPoints-V,0)/n.maxHitPoints;pV.masteryNow=cV.mastery,Object.keys(statsBuffs.mastery).forEach(function(t){buffStatus[t]&&("number"==typeof buffStatus[t]?pV.masteryNow+=statsBuffs.mastery[t]*buffStatus[t]:pV.masteryNow+=statsBuffs.mastery[t])}),pV.currHealFromMastery=V*(1-1/(1+pV.masteryNow/133.33/100*(1-_)));var T=(V+w)*(1-1/(1+pV.masteryNow/133.33/100*(1-_)));AddStatAmount("mastery",pV.currHealFromMastery,T,pV.masteryNow,V,c,n.timestamp),_<.3?healPerStat.mastery.b30+=pV.currHealFromMastery:_<.4?healPerStat.mastery.b40+=pV.currHealFromMastery:_<.5?healPerStat.mastery.b50+=pV.currHealFromMastery:_<.6?healPerStat.mastery.b60+=pV.currHealFromMastery:_<.7?healPerStat.mastery.b70+=pV.currHealFromMastery:_<.8?healPerStat.mastery.b80+=pV.currHealFromMastery:healPerStat.mastery.b100+=pV.currHealFromMastery,healPerStat.mastery.t[n.targetID]||(healPerStat.mastery.t[n.targetID]={hp:0,amount:0,mamount:0,spells:{}}),healPerStat.mastery.t[n.targetID].hp+=(V-pV.currHealFromMastery)*(1-_),healPerStat.mastery.t[n.targetID].amount+=V-pV.currHealFromMastery,healPerStat.mastery.t[n.targetID].mamount+=pV.currHealFromMastery,healPerStat.mastery.t[n.targetID].spells[c]=(healPerStat.mastery.t[n.targetID].spells[c]||0)+pV.currHealFromMastery}if(spellScaleVers[c]){pV.versNow=cV.versatility,Object.keys(statsBuffs.vers).forEach(function(t){buffStatus[t]&&(pV.versNow+=statsBuffs.vers[t])}),pV.currHealFromVers=V*(1-1/(pV.versNow/475/100+1));var k=(V+w)*(1-1/(pV.versNow/475/100+1));AddStatAmount("vers",pV.currHealFromVers,k,pV.versNow,V,c,n.timestamp)}if(!spellNotScaleHaste[c]&&(n.tick||spellAffectedByHaste[c])){pV.hasteNow=cV.haste,Object.keys(statsBuffs.haste).forEach(function(t){buffStatus[t]&&("number"==typeof buffStatus[t]?pV.hasteNow+=statsBuffs.haste[t]*buffStatus[t]:pV.hasteNow+=statsBuffs.haste[t])});var S=pV.hasteNow/375/100+1;Object.keys(statsBuffs.haste_mod).forEach(function(t){buffStatus[t]&&(S*=statsBuffs.haste_mod[t])}),pV.currHealFromHaste=(1-1/S)*V;var P=(1-1/S)*(V+w);pV.hasteNow=100*(S-1)*375,AddStatAmount("haste",pV.currHealFromHaste,P,pV.hasteNow,V,c,n.timestamp),Object.keys(statsBuffs.haste_mod).forEach(function(t){buffStatus[t]&&(rV.buffs.haste_mod[t]||(rV.buffs.haste_mod[t]=0),rV.buffs.haste_mod[t]+=100*(statsBuffs.haste_mod[t]-1)*375/pV.hasteNow*pV.currHealFromHaste)})}for(var o=0,l=delayedSpells.length;o<l;o++){var A=pV[delayedSpells[o][0]];A&&!delayedSpells[o][2][c]&&n.timestamp<=A.time&&(A.feed+=V+w,A.spellsfeed[c]=(A.spellsfeed[c]||0)+(V+w))}for(var o=0,l=cooldownsTracking.length;o<l;o++)if(cooldownsTracking[o].opened||157153==cooldownsTracking[o].spellID&&157503==c&&n.timestamp-cooldownsTracking[o].start<=2e4){cooldownsTracking[o].healing+=V;for(var m=n.timestamp-cooldownsTracking[o].start,d=-1,u=0,p=cooldownsTracking[o].heal.length;u<p;u++){if(m==cooldownsTracking[o].heal[u].time&&c==cooldownsTracking[o].heal[u].id){d=u;break}if(m>cooldownsTracking[o].heal[u].time&&c==cooldownsTracking[o].heal[u].id&&m-cooldownsTracking[o].heal[u].time<=300){d=u;break}}-1==d&&(cooldownsTracking[o].heal.push({time:m,id:c,amount:0,over:0,count:0}),d=cooldownsTracking[o].heal.length-1),cooldownsTracking[o].heal[d].amount+=n.amount,n.overheal&&(cooldownsTracking[o].heal[d].over+=n.overheal),cooldownsTracking[o].heal[d].count++,157503==c&&157153==cooldownsTracking[o].spellID&&(cooldownsTracking[o].ended=n.timestamp,cooldownsTracking[o].opened=!1)}if(98021==c)for(var o=0,l=sltTracking.length;o<l;o++)if(n.timestamp-sltTracking[o].start<8e3){for(var m=n.timestamp-sltTracking[o].start,d=-1,u=0,p=sltTracking[o].heal.length;u<p;u++){if(m==sltTracking[o].heal[u].time){d=u;break}if(m>sltTracking[o].heal[u].time&&m-sltTracking[o].heal[u].time<=500){m=sltTracking[o].heal[u].time,d=u;break}}-1==d&&(sltTracking[o].heal.push({time:m,data:[]}),d=sltTracking[o].heal.length-1),sltTracking[o].heal[d].data[n.targetID]||(sltTracking[o].heal[d].data[n.targetID]={amount:0,absorbed:0}),sltTracking[o].heal[d].data[n.targetID].amount+=n.amount,n.absorbed&&(sltTracking[o].heal[d].data[n.targetID].absorbed+=n.absorbed),sltTracking[o].ended=n.timestamp}for(var o=0,l=parsePlugins.heal.length;o<l;o++)parsePlugins.heal[o](n,c,V)}for(var o=0,l=cooldownsTracking.length;o<l;o++)cooldownsTracking[o].opened&&cooldownsTracking[o].end_limit&&n.timestamp>=cooldownsTracking[o].end_limit&&(cooldownsTracking[o].ended=n.timestamp,cooldownsTracking[o].opened=!1,157153==cooldownsTracking[o].spellID&&(pV.buffCBTActive=!1));n.ability&&!cV.spellInfo[n.ability.guid]&&(cV.spellInfo[n.ability.guid]={icon:n.ability.abilityIcon,name:n.ability.name})}}catch(t){throw error_msg("Error: "+t),new Error(t)}if(e.nextPageTimestamp){currFightData.end_time_parsed=e.nextPageTimestamp,pV.ReUpdatePage||(pV.ReUpdatePage=setTimeout(function(){BuildReportMinor(),pV.ReUpdatePage=!1},300));var C=(e.nextPageTimestamp-currFightData.start_time)/(currFightData.end_time-currFightData.start_time)*100;$("#navbar-progress").width(C+"%").css("opacity","1"),ParseLog(t,a,e.nextPageTimestamp,r)}else $("#navbar-progress").width("100%").css("opacity","0"),pV.ReUpdatePage&&clearTimeout(pV.ReUpdatePage),BuildReport()}).fail(function(t){throw error_msg("Parsing Error. Log may be private or removed."),new Error("Error: Parsing Error")})}function ParseHeader(t,a,e){$.getJSON("https://www.warcraftlogs.com:443/v1/report/fights/"+t+"?api_key="+WCL_API_KEY).done(function(t){if(400==t.status)throw error_msg(t.error),new Error("Error: Parsing Error");fightsData=[],actorsData=[];for(var r=0,i=t.fights.length;r<i;r++)(n=t.fights[r]).actors=[],fightsData[n.id]=n;for(var s=[t.friendlies,t.enemies,t.friendlyPets,t.enemyPets],r=0,i=s.length;r<i;r++)for(var n=s[r],o=0,l=n.length;o<l;o++){var c=n[o];actorsData[c.id]={name:c.name,class:c.type};for(var m=0,d=c.fights.length;m<d;m++)fightsData[c.fights[m].id]&&fightsData[c.fights[m].id].actors.push(c.id)}currFightData.report_name=t.title,a&&BuildFightsList(),e&&e()}).fail(function(t){throw error_msg("Parsing Error. Log may be private or removed."),new Error("Error: Parsing Error")})}function CalcHealingFromItem(t,a){var e=0,r="Calculated stats:",i=cV.gearInfo[t],s=!1;if(i){var n=a||itemsStats[t];if(n){var o=i.itemLevel,l=n.ilvl;Object.keys(n).forEach(function(t){var a=n[t];if("passive"==t&&i.bonusIDs)for(var s=0,c=i.bonusIDs.length;s<c;s++)if(itemsBonusToStats[i.bonusIDs[s]]){t=itemsBonusToStats[i.bonusIDs[s]];break}if(healPerStat[t]){var m=ScaleStat(a,l,o,"int"==t?1:jewelSlots[i.slot]?2:0);r+="<br>"+t+": "+Math.round(m),"int"==t&&(m*=1.05),e+=healPerStat[t].amount*m}}),s=!0}if(i.gems)for(var c=0,m=i.gems.length;c<m;c++){var d=i.gems[c].id;if(gemToStat[d]){u=gemToStat[d];healPerStat[u[0]]&&(r+="<br>Gem "+u[0]+": "+Math.round(u[1]),e+=healPerStat[u[0]].amount*u[1]*("int"==u[0]?1.05:1))}}if(i.permanentEnchant&&enchToStat[i.permanentEnchant]){var u=enchToStat[i.permanentEnchant];healPerStat[u[0]]&&(r+="<br>Enchant "+u[0]+": "+Math.round(u[1]),e+=healPerStat[u[0]].amount*u[1]*("int"==u[0]?1.05:1))}}return{heal:e,tip:r,base:s}}function GetItemDataFromWowhead(t){if(!IsWowheadResponceRewritten){if(!$WowheadPower||!$WowheadPower.registerItem)return!1;$WowheadPower.registerItem=function(t,a,e){if(e&&e.tooltip_enus){var r=t.match(/^(\d+)/)[1],i=$("#gear-"+r+"-text").attr("data-status"),s={},n=e.tooltip_enus.match(/ilvl-->(\d+)/);n&&(s.ilvl=n[1].replace(",","")),(n=e.tooltip_enus.match(/nstart--><b class=\"[^\"]*\">([^<]*)/))&&(s.name=n[1]),(n=e.tooltip_enus.match(/-->\+([\d,]+) (\[Agility or Intellect\]|Intellect|\[Agility or Strength or Intellect\])/))&&(s.int=n[1].replace(",","")),(n=e.tooltip_enus.match(/([\d,]+) Critical Strike/))&&(s.crit=n[1].replace(",","")),(n=e.tooltip_enus.match(/([\d,]+) Mastery/))&&(s.mastery=n[1].replace(",","")),(n=e.tooltip_enus.match(/([\d,]+) Versatility/))&&(s.vers=n[1].replace(",","")),(n=e.tooltip_enus.match(/([\d,]+) Haste/))&&(s.haste=n[1].replace(",",""));var o=CalcHealingFromItem(r,s),l=$("#gear-"+r+"-name").attr("data-ilvl");if($("#gear-"+r+"-name").html(s.name+" "+l),"locked"!=i){$("#gear-"+r+"-text").attr("data-status","locked");var c="";o.heal>0&&(c+='From <em class="tooltip">passive stats<span class="tip-text" style="width: 120px;margin-left:-60px;">'+o.tip+"</span></em>: "+NumberToFormattedNumber(o.heal,2)+" ("+(o.heal/rV.total*100).toFixed(2)+"%)<br>"),o.heal>0&&(c+='HPS: <em class="result-hps">'+NumberToFormattedNumber(o.heal/currFightData.len*1e3,1)+"</em>"),$("#gear-"+r+"-text").html(c)}}$WowheadPower.register(3,t,a,e)},IsWowheadResponceRewritten=!0}$.ajaxSetup({cache:!0}),$.getScript("https://www.wowhead.com/item="+t+"&power")}function BuildReportMinor(){var t="";console.log("BuildReportMinor",(new Date).getTime());var a=(currFightData.end_time_parsed||currFightData.end_time)-currFightData.start_time,e=0;Object.keys(healingData).forEach(function(t){98021!=t&&(e+=healingData[t][0])}),t+='<div class="panel" style="margin-top:-10px;"><div class="row full" style="margin-bottom:5px;">';var r=Math.round(e/a*1e3);t+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingwavegreater.jpg"></div><div class="col w75">Healing Done: '+NumberToFormattedNumber(e)+"<br>HPS: "+NumberToFormattedNumber(r,0,3)+"</div></div></div></div>",t+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingtouch.jpg"></div><div class="col w75">Mastery healing Done:<br>'+NumberToFormattedNumber(Math.round(healPerStat.mastery.total),1)+" ("+Math.round(healPerStat.mastery.total/healPerStat.mastery.all*100)+"%)</div></div></div></div>",t+="</div></div>",t+='<div class="panel">';var i=Object.keys(healingData);i.sort(function(t,a){return healingData[t][0]>healingData[a][0]?-1:1}),t+='<div class="col-half"><div class="box clearfix spellslist">';for(var s=0,n=i.length;s<n;s++){var o=i[s],l=cV.spellInfo[o];t+='<div class="row full"><div class="line half"><a href="//www.wowhead.com/spell='+o+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+l.icon+'" alt="'+l.name+'">'+l.name+'</a></div><div class="line t-right w15">'+NumberToFormattedNumber(healingData[o][0],1)+'</div><div class="line t-right t-grey w15">'+NumberToFormattedNumber(healingData[o][1],1)+"</div></div>"}t+="</div></div>",$("#main").html(t)}function BuildReport(){if(!cV.combantantInfo)throw error_msg("Error: Combantant info is missing."),new Error("Error: Combantant info is missing.");rV.total=0,Object.keys(healingData).forEach(function(t){98021!=t&&(rV.total+=healingData[t][0])});for(var t=0,a=pluginsList.length;t<a;t++)for(var e=pluginsList[t],r=0,i=e.length;r<i;r++)e[r].afterParse&&e[r].afterParse();console.log(rV);var s="",n=currFightData.start_time,o=currFightData.end_time,l=o-n;s+='<div class="panel" style="margin-top:-10px;"><div class="row full" style="margin-bottom:5px;">';var c=Math.round(rV.total/l*1e3);s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingwavegreater.jpg"></div><div class="col w75">Healing Done: '+NumberToFormattedNumber(rV.total)+"<br>HPS: "+NumberToFormattedNumber(c,0,3)+"</div></div></div></div>",s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingtouch.jpg"></div><div class="col w75">Mastery healing Done:<br>'+NumberToFormattedNumber(Math.round(healPerStat.mastery.total),1)+" ("+Math.round(healPerStat.mastery.total/healPerStat.mastery.all*100)+"%)</div></div></div></div>",s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img style="filter: grayscale(100%);-webkit-filter: grayscale(100%);" src="http://media.blizzard.com/wow/icons/56/spell_shaman_tidalwaves.jpg"></div><div class="col w75">HW or Surge without tidal:<br>'+rV.hwWithoutTidal+" ("+Math.round(rV.hwWithoutTidal/rV.hwWithoutTidalTotal*100)+"%)</div></div></div></div>",s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_shaman_spiritwalkersgrace.jpg"></div><div class="col w75">Spiritwalker\'s uptime:<br>'+Math.round(rV.spiritwalkerUptime/1e3)+"s ("+Math.round(rV.spiritwalkerUptime/l*100)+"%)</div></div></div></div>",s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col w25"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_spiritwolf.jpg"></div><div class="col w75">Wolf uptime:<br>'+Math.round(rV.wolfUptime/1e3)+"s ("+Math.round(rV.wolfUptime/l*100)+"%)</div></div></div></div>",s+="</div></div>",s+='<div class="panel">';var m=Object.keys(healingData);m.sort(function(t,a){return healingData[t][0]>healingData[a][0]?-1:1}),s+='<div class="col-half"><div class="box clearfix spellslist">';for(var d=0,u=m.length;d<u;d++){var p=m[d],f=cV.spellInfo[p];s+='<div class="row full"><div class="line half"><a href="//www.wowhead.com/spell='+p+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+f.icon.replace(/\-/,"")+'" alt="'+f.name+'">'+f.name+'</a></div><div class="line t-right w15">'+NumberToFormattedNumber(healingData[p][0],1)+'</div><div class="line t-right t-grey w15">'+NumberToFormattedNumber(healingData[p][1],1)+"</div></div>"}s+="</div></div>",s+='<div class="col-half"><div class="box clearfix statlist"><header class="box-header" style="padding-bottom:0;padding-top:0">Stats</header>';var v=[["int","Int","From gear: "+cV.intellect_min],["crit","Crit","From gear: "+(cV.critSpell-2e3)+"<br>Base value: 2000<br>Avg number can be much higher due Floodwaters & Empowered Droplets traits and Tidal Waves buff"],["mastery","Mastery","From gear: "+(cV.mastery-3200)+"<br>Base value: 3200"],["vers","Vers","From gear: "+cV.versatility],["haste",'<em class="tooltip">Haste<span class="tip-text" style="width: 300px;margin-left:-150px;">Cast time not counted here, only profit from ticks</span></em>',"From gear: "+cV.haste]];s+='<div class="row full"><div class="col size"> </div><div class="col size">Heal per stat</div><div class="col size">Stat weight</div><div class="col size">Total from stat</div><div class="col size">Avg on fight</div></div>';for(var d=0,u=v.length;d<u;d++){var h=v[d],g=healPerStat[h[0]].amount,b=healPerStat[h[0]].total,V=g.toFixed(3),w=NumberToFormattedNumber(b),y=(g/l*1e3).toFixed(2);if("crit"==h[0]&&rV.resurgenceCritAmount>0){var _=rV.resurgenceCrit/rV.manaUsage*rV.healFromMana,T=b;b+=_;var k=g;V='<em class="tooltip">'+(g+=_/rV.resurgenceCritAmount).toFixed(3)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">From crit heals: '+k.toFixed(3)+"<br>From resurgence: "+(_/rV.resurgenceCritAmount).toFixed(3)+"</span></em>",w='<em class="tooltip">'+NumberToFormattedNumber(b)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">From crit heals: '+NumberToFormattedNumber(T)+"<br>From resurgence: "+NumberToFormattedNumber(_)+"</span></em>",y='<em class="tooltip">'+(g/l*1e3).toFixed(2)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">From crit heals: '+(k/l*1e3).toFixed(2)+"<br>From resurgence: "+(_/rV.resurgenceCritAmount/l*1e3).toFixed(2)+"</span></em>"}else"int"==h[0]?y='<em class="tooltip">'+(g/l*1e3*1.05).toFixed(2)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">5% armor bonus included</span></em>':"mastery"==h[0]&&(w='<em class="tooltip">'+NumberToFormattedNumber(b)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">Based on health %:<br>',w+="100-80: "+NumberToFormattedNumber(healPerStat.mastery.b100,0,1)+"<br>",w+="80-70: "+NumberToFormattedNumber(healPerStat.mastery.b80,0,1)+"<br>",w+="70-60: "+NumberToFormattedNumber(healPerStat.mastery.b70,0,1)+"<br>",w+="60-50: "+NumberToFormattedNumber(healPerStat.mastery.b60,0,1)+"<br>",w+="50-40: "+NumberToFormattedNumber(healPerStat.mastery.b50,0,1)+"<br>",w+="40-30: "+NumberToFormattedNumber(healPerStat.mastery.b40,0,1)+"<br>",w+="30-0: "+NumberToFormattedNumber(healPerStat.mastery.b30,0,1)+"</span></em>");it="";if(healPerStat[h[0]].spells){it=' <em class="tooltip">[?]<span class="tip-text" style="width: 300px;margin-left:-150px;">';var S=Object.keys(healPerStat[h[0]].spells);S.sort(function(t,a){return healPerStat[h[0]].spells[t]>healPerStat[h[0]].spells[a]?-1:1});for(var t=0,a=S.length;t<a;t++){p=S[t];it+='<img src="http://media.blizzard.com/wow/icons/56/'+(G=cV.spellInfo[p]?cV.spellInfo[p].icon:"")+'" alt="'+(O=cV.spellInfo[p]?cV.spellInfo[p].name:"")+'"> '+O+" - "+healPerStat[h[0]].spells[p].toFixed(1)+"<br>"}it+="</span></em>"}s+='<div class="row full"><div class="col size">'+h[1]+'</div><div class="col size">'+V+it+'</div><div class="col size">'+y+'</div><div class="col size">'+w+'</div><div class="col size"><em class="tooltip">'+(healPerStat[h[0]].avg/healPerStat[h[0]].avgCount).format()+'<span class="tip-text" style="width: '+("crit"==h[0]?300:120)+"px;margin-left:-"+("crit"==h[0]?150:60)+'px;">'+h[2]+"</span></em></div></div>"}var P="<br>Mana used by spells:",A=Object.keys(rV.manaUsageBySpell);A.sort(function(t,a){return rV.manaUsageBySpell[t]>rV.manaUsageBySpell[a]?-1:1});for(var t=0,a=A.length;t<a;t++){p=A[t];P+='<br><img src="http://media.blizzard.com/wow/icons/56/'+(G=cV.spellInfo[p]?cV.spellInfo[p].icon:"")+'" alt="'+(O=cV.spellInfo[p]?cV.spellInfo[p].name:"")+'"> '+O+" - "+NumberToFormattedNumber(rV.manaUsageBySpell[p],0,2)}s+='<div class="row full"><div class="col size">Mana</div><div class="col size"><em class="tooltip">'+(rV.healFromMana/rV.manaUsage*1e3).toFixed(2)+'<span class="tip-text" style="width: 200px;margin-left:-100px;">Healing per 1000 mana points</span></em></div><div class="col size"> </div><div class="col size">'+NumberToFormattedNumber(rV.healFromMana)+'</div><div class="col size"><em class="tooltip">'+rV.manaUsage.format()+'<span class="tip-text" style="width: 350px;margin-left:-175px;">Mana used on fight: '+rV.manaUsage.format()+"<br>Mana gained via passives & buffs: "+rV.manaGain.format()+"<br>Mana regened: "+(l/1e3*8800).format()+"<br>Base manapull: "+11e5.format()+P+"</span></em></div></div>",s+="</div></div>",s+='<div class="col-half"><div class="box clearfix predictionlist"><header class="box-header" style="padding-bottom:0;padding-top:0">Items predictions ',s+='<sup class="tooltip" style="font-size: 0.4em"> [?]<span class="tip-text" style="width: 300px;margin-left:-150px;">Only benefit from "spell" part of item is counted here</span></sup></header>';for(var r=0,i=ITEMS.length;r<i;r++)if(ITEMS[r].obj.prediction&&(!ITEMS[r].obj.predictionСondition||ITEMS[r].obj.predictionСondition())&&("item"!=ITEMS[r].obj.type||!ITEMS[r].obj.predictionСondition&&!cV.gearInfo[ITEMS[r].obj.id])){var C=ITEMS[r].obj;s+='<div class="row full"><div class="col s-1"><a href="//www.wowhead.com/'+C.type+"="+C.id+'" target="_blank" style="color: #'+qualityColors[C.quality]+';">'+C.name+'</a></div><div class="col s-2">'+NumberToFormattedNumber(rV[C.prediction],2)+(C.text?" "+C.text():"")+'</div><div class="col s-2">'+(rV[C.prediction]/rV.total*100).toFixed(2)+"%</div></div>"}s+="</div></div>",s+="</div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">ITEMS ',s+='<sup class="tooltip" style="font-size: 0.4em"> [supported items]<span class="tip-text" style="width: 400px;margin-left:-200px;">';for(var x=!1,r=0,i=ITEMS.length;r<i;r++)ITEMS[r].obj.gear&&(x&&(s+=", "),s+=ITEMS[r].obj.name,x=!0);s+='</span></sup></header><div class="list-top-line"> </div><ul class="list special_items">',x=0;for(var D=[],r=0,i=ITEMS.length;r<i;r++)(mt=ITEMS[r].obj).gear&&(!mt.gearFunc&&cV.gearInfo[mt.id]||mt.gearFunc&&mt.gearFunc())&&D.push([mt.gear,ITEMS[r]]);D.sort(function(t,a){return rV[t[0]]>rV[a[0]]?-1:1});for(var r=0,i=D.length;r<i;r++){N=(mt=D[r][1].obj).id;x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33"><div class="col w70p">',s+='<a href="//www.wowhead.com/'+mt.type+"="+N+(cV.gearInfo[N]&&cV.gearInfo[N].bonusIDs?"&bonus="+cV.gearInfo[N].bonusIDs.join(":"):"")+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+(mt.icon||cV.gearInfo[N].icon)+'" alt="'+mt.name+'"></a></div>',s+='<div class="col div_more_1 w80"><header style="color: #'+qualityColors[mt.quality]+';">'+mt.name+"</header>",(g=rV[mt.gear])>0&&(s+='<em class="result">'+NumberToFormattedNumber(g,2)+"</em> ("+(g/rV.total*100).toFixed(2)+"%)<br>"),(j=CalcHealingFromItem(N)).heal=0,j.heal>0&&(s+="From passive stats: "+NumberToFormattedNumber(j.heal,2)+" ("+(j.heal/rV.total*100).toFixed(2)+"%)<br>"),s+='HPS: <em class="result-hps">',g>0&&(s+=NumberToFormattedNumber(g/l*1e3,1)),j.heal>0&&(s+=(g>0?" / ":"")+NumberToFormattedNumber(j.heal/l*1e3,1)),s+="</em>",mt.gearAdditionalText&&(s+="<br>"+mt.gearAdditionalText()),s+="</div></div>",x++}s+="</ul></div></div></div>";var F=[];s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">GEAR</header><div class="list-top-line"> </div><ul class="list gear">',x=0;for(var r=0,i=cV.combantantInfo.gear.length;r<i;r++){var I=cV.combantantInfo.gear[r];if(0!=I.id){var N=I.id;x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33" id="gear-'+N+'"><div class="col w70p">',s+='<a href="//www.wowhead.com/item='+N+(I&&I.bonusIDs?"&bonus="+I.bonusIDs.join(":"):"")+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+I.icon.replace(/\-/,"")+'" alt="'+I.icon+'"></a></div>',s+='<div class="col div_more_1 w80"><header style="color: #'+qualityColors[I.quality]+';" id="gear-'+N+'-name" data-ilvl="'+I.itemLevel+'">'+I.itemLevel+"</header>";var j=CalcHealingFromItem(N);s+='<div class="row-gear full" id="gear-'+N+'-text" data-status="'+(j.base?"locked":"unlocked")+'">',j.heal>0&&(s+='From <em class="tooltip">passive stats<span class="tip-text" style="width: 120px;margin-left:-60px;">'+j.tip+"</span></em>: "+NumberToFormattedNumber(j.heal,2)+" ("+(j.heal/rV.total*100).toFixed(2)+"%)<br>"),j.heal>0&&(s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(j.heal/l*1e3,1)+"</em>"),s+="</div></div></div>",x++,F.push(N)}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">TRAITS</header><div class="list-top-line"> </div><ul class="list traits">',x=0;for(var M=[],r=0,i=TRAITS.length;r<i;r++)GetTraitRank(TRAITS[r].obj.id)>0&&M.push([TRAITS[r].obj.id,TRAITS[r]]);M.sort(function(t,a){return rV.traits[t[0]]>rV.traits[a[0]]?-1:1});for(var r=0,i=M.length;r<i;r++){var B=M[r][1].obj,E=GetTraitRank(B.id);if(E>0){x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+B.spellID+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+B.icon+'" alt="'+B.name+'"></a></div>',s+='<div class="col div_more_1 w80"><header><a href="//www.wowhead.com/spell='+B.spellID+'" target="_blank">'+B.name+"</a>"+(E>1?" [Rank "+E+"]":"")+"</header>";g=rV.traits[B.id];s+='<em class="result '+(B.tip?"tooltip":"")+'">'+NumberToFormattedNumber(g,2)+(B.tip?'<span class="tip-text" style="width: 180px;margin-left:-90px;">'+B.tip()+"</span>":"")+"</em> ("+(g/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(g/l*1e3,1)+"</em>",B.additionalText?s+="<br>"+B.additionalText():E>1&&(s+="<br>Per rank: "+NumberToFormattedNumber(g/E,0,2)+" ("+(g/E/rV.total*100).toFixed(2)+"%)"),s+="</div></div>",x++}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">TALENTS</header><div class="list-top-line"> </div><ul class="list talents">',x=0;for(var z=[],r=0,i=TALENTS.length;r<i;r++)cV.talentInfo[TALENTS[r].obj.id]&&z.push([TALENTS[r].obj.id,TALENTS[r],cV.talentInfo[TALENTS[r].obj.id].row]);z.sort(function(t,a){return t[2]<a[2]?-1:1});for(var r=0,i=z.length;r<i;r++){var L=z[r][1].obj;x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+L.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.talentInfo[L.id].icon+'" alt="'+L.name+'"></a></div>',s+='<div class="col div_more_1 w80"><header><a href="//www.wowhead.com/spell='+L.id+'" target="_blank">'+L.name+"</a></header>";g=rV.talents[L.id];s+='<em class="result">'+NumberToFormattedNumber(g,2)+"</em> ("+(g/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(g/l*1e3,1)+"</em>",L.additionalText&&(s+="<br>"+L.additionalText()),s+="</div></div>",x++}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">RESURGENCE</header><div class="list-top-line"> </div><ul class="list resurgence">',x=0;for(var R=[],r=0,i=RESURGENCE.length;r<i;r++)rV.resurgence[RESURGENCE[r].obj.id][0]>0&&R.push([RESURGENCE[r].obj.id,RESURGENCE[r]]);R.sort(function(t,a){return rV.resurgence[t[0]][0]>rV.resurgence[a[0]][0]?-1:1});for(var r=0,i=R.length;r<i;r++){mt=R[r][1].obj;x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+mt.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+mt.icon+'" alt="'+mt.name+'"></a></div>',s+='<div class="col div_more_1 w80"><header><a href="//www.wowhead.com/spell='+mt.id+'" target="_blank">'+mt.name+"</a></header>";g=rV.resurgence[mt.id][0];s+='Mana gained: <em class="result">'+NumberToFormattedNumber(g,0,2)+"</em> ("+(g/rV.manaUsage*100).toFixed(2)+"%)<br>",s+="Count: "+rV.resurgence[mt.id][1],s+="</div></div>",x++}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">POTIONS</header><div class="list-top-line"> </div><ul class="list potions">',x=0;for(var r=0,i=POTIONS.length;r<i;r++){var H=POTIONS[r].obj;if(rV.potions[H.id]>0){if(x%3==0&&(s+='<li class="item clearfix">'),s+='<div class="row w33"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+H.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+H.icon+'" alt="'+H.name+'"></a></div>',s+='<div class="col div_more_1 w80"><header><a href="//www.wowhead.com/spell='+H.id+'" target="_blank">'+H.name+"</a></header>",H.text)s+=H.text();else{g=rV.potions[H.id];s+='<em class="result">'+NumberToFormattedNumber(g,0,2)+"</em> ("+(g/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(g/l*1e3,1)+"</em>"}s+="</div></div>",x++}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box clearfix procs"><header class="box-header">PROCS</header><div class="list-top-line" style="margin-bottom:10px;"> </div>',x=0;var U=[];Object.keys(rV.buffs).forEach(function(t){Object.keys(rV.buffs[t]).forEach(function(a){for(var e=-1,r=0,i=U.length;r<i;r++)if(U[r][0]==a){e=r;break}-1==e&&(U.push([a,0,[]]),e=U.length-1),U[e][1]+=rV.buffs[t][a],U[e][2].push(("haste_mod"==t?"haste":t)+": "+NumberToFormattedNumber(rV.buffs[t][a],0,2))})}),U.sort(function(t,a){return t[1]>a[1]?-1:1});for(var r=0,i=U.length;r<i;r++){var p=U[r][0],G=cV.spellInfo[p]?cV.spellInfo[p].icon:"",O=cV.spellInfo[p]?cV.spellInfo[p].name:"";s+='<div class="row half"><div class="col w40"><a href="//www.wowhead.com/spell='+p+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+G+'" alt="'+O+'"> '+O+'</a></div><div class="col w30"><em class="tooltip">'+NumberToFormattedNumber(U[r][1],0,2)+'<span class="tip-text" style="width: 120px;margin-left:-60px;">'+U[r][2].join("<br>")+'</span></em></div><div class="col w30">'+(U[r][1]/rV.total*100).toFixed(2)+"%</div></div>"}s+="</div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box clearfix mastery_eff"><header class="box-header">MASTERY</header>',x=0;var W,q,Q=[],K=0,Y=0,J=0;Object.keys(healPerStat.mastery.t).forEach(function(t){healPerStat.mastery.t[t].amount>0&&actorsData[t]&&actorsData[t].class&&classes[actorsData[t].class]&&(healPerStat.mastery.t[t].avg=healPerStat.mastery.t[t].hp/healPerStat.mastery.t[t].amount,(!W||W<healPerStat.mastery.t[t].avg)&&(W=healPerStat.mastery.t[t].avg),Q.push(t),Y+=healPerStat.mastery.t[t].amount,K+=healPerStat.mastery.t[t].mamount,(!q||q<healPerStat.mastery.t[t].mamount)&&(q=healPerStat.mastery.t[t].mamount))}),s+='<div class="row full"><div class="col w20"></div><div class="col w5"></div><div class="col w30">Mastery effectiveness</div><div class="col w5"></div><div class="col w30"><em class="tooltip">Healing done to target<span class="tip-text" style="width: 300px;margin-left:-150px;">Only healing coming from mastery used here</span></em></div></div>',Q.sort(function(t,a){return healPerStat.mastery.t[t].avg>healPerStat.mastery.t[a].avg?-1:1});for(var r=0,i=Q.length;r<i;r++){var X=Q[r],Z=actorsData[X],tt=1-healPerStat.mastery.t[X].avg;s+='<div class="row full"><div class="col w5"></div><div class="col w15">'+Z.name+"</div>",s+='<div class="col w10 t-right"><em class="tooltip">'+(100*(1-tt)).toFixed(2)+'%<span class="tip-text" style="width: 300px;margin-left:-150px;">Mastery effectiveness:'+(100*(1-tt)).toFixed(2)+"%<br>Target avg health:"+(100*tt).toFixed(2)+"%</span></em></div>";var at=healPerStat.mastery.t[X].avg/W;s+='<div class="col w25 clearfix"><div class="performance-bar '+actorsData[X].class+'-bg" style="width: '+(100*at).toFixed(2)+'%;"></div></div>';g=healPerStat.mastery.t[X].mamount/K;s+='<div class="col w10 t-right">'+(100*g).toFixed(2)+"%</div>";var et=healPerStat.mastery.t[X].mamount/q;s+='<div class="col w25 clearfix"><div class="performance-bar '+actorsData[X].class+'-bg" style="width: '+(100*et).toFixed(2)+'%;"></div></div>';var rt=Object.keys(healPerStat.mastery.t[X].spells);rt.sort(function(t,a){return healPerStat.mastery.t[X].spells[t]>healPerStat.mastery.t[X].spells[a]?-1:1});for(var it="",t=0,a=rt.length;t<a;t++){p=rt[t];it+='<img src="http://media.blizzard.com/wow/icons/56/'+(G=cV.spellInfo[p]?cV.spellInfo[p].icon:"")+'" alt="'+(O=cV.spellInfo[p]?cV.spellInfo[p].name:"")+'"> '+O+" - "+NumberToFormattedNumber(healPerStat.mastery.t[X].spells[p],0,2)+"<br>"}J+=(1-tt)*(healPerStat.mastery.t[X].amount/Y),s+='<div class="col w10"><em class="tooltip">'+NumberToFormattedNumber(healPerStat.mastery.t[X].mamount,0,2)+'<span class="tip-text" style="width: 300px;margin-left:-150px;">'+it+"</span></em></div>",s+='<div class="list-top-line"></div>',s+="</div>"}s+='<div class="row full"><div class="col w5"></div><div class="col w20">Average mastery effectiveness</div><div class="col w5 t-right">'+(100*J).toFixed(2)+'%</div><div class="col w25 clearfix"><div class="performance-bar" style="width: '+(100*Math.min(J/W,1)).toFixed(2)+'%;"></div></div><div class="list-top-line"></div></div>',s+="</div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">COOLDOWN USAGES</header><div class="list-top-line"> </div><ul class="list cooldowns">';for(var r=0,i=cooldownsTracking.length;r<i;r++){p=(mt=cooldownsTracking[r]).spellID;s+='<li class="item clearfix"><div class="row full"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+p+'"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[p].icon+'" alt="'+cV.spellInfo[p].name+'"></a></div>',s+='<div class="col half">',s+='<header class="cd_header"><a href="//www.wowhead.com/spell='+p+'">'+cV.spellInfo[p].name+"</a> ("+MsToFormattedTime(mt.start-n)+" -> "+MsToFormattedTime((mt.ended||o)-n)+"):</header>",s+='<div class="col full div_more_1">';for(var d=0,u=mt.spells.length;d<u;d++){ot=mt.spells[d].spell;s+='<a href="//www.wowhead.com/spell='+ot+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[ot].icon+'" alt="'+cV.spellInfo[ot].name+'"></a>'}s+='<br><a href="javascript:void(0)" class="more_1">more</a></div>',s+='<div class="col full div_more_2" style="display:none;">';for(var d=0,u=mt.spells.length;d<u;d++){ot=mt.spells[d].spell;s+='<div class="row full"><div class="cd_more_2_time">'+(mt.spells[d].time/1e3).toFixed(3)+'</div><div class="cd_more_2_info">',s+='<a href="//www.wowhead.com/spell='+ot+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[ot].icon+'" alt="'+cV.spellInfo[ot].name+'"> '+cV.spellInfo[ot].name+"</a></div></div>"}s+='<br><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+"&type=healing&source="+currFightData.actor+"&start="+mt.start+"&end="+(mt.ended||o)+'" target="_blank">WCL link</a>',s+='<br><a href="javascript:void(0)" class="more_2">even more</a></div>',s+='<div class="col full div_more_3" style="display:none;">';for(var st=0,nt=0,d=0,u=mt.spells.length;d<u;d++){var ot=mt.spells[d].spell;s+='<div class="row full"><div class="cd_more_3_time">'+(mt.spells[d].time/1e3).toFixed(3)+'</div><div class="cd_more_3_info">',s+='<a href="//www.wowhead.com/spell='+ot+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[ot].icon+'" alt="'+cV.spellInfo[ot].name+'"> '+cV.spellInfo[ot].name+"</a></div></div>";for(var lt=mt.spells[d+1]?mt.spells[d+1].time:o,t=st,a=mt.heal.length;t<a&&!(mt.heal[t].time>=lt);t++){var ct=mt.heal[t];s+='<div class="row full"><div class="cd_more_3_time">'+(ct.time/1e3).toFixed(3)+'</div><div class="cd_more_3_info cd_more_3_info_heal">',s+='<a href="//www.wowhead.com/spell='+ct.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[ct.id].icon+'" alt="'+cV.spellInfo[ct.id].name+'"> '+cV.spellInfo[ct.id].name+"</a> x"+ct.count,s+='</div><div class="cd_more_3_info cd_more_3_info_amount">'+ct.amount.format()+'</div><div class="cd_more_3_info cd_more_3_info_over">'+ct.over.format()+"</div></div>",nt+=ct.over,st=t+1}}s+='<br><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+"&type=healing&source="+currFightData.actor+"&start="+mt.start+"&end="+(mt.ended||o)+'" target="_blank">WCL link</a>',s+='<br><a href="javascript:void(0)" class="more_3">hide</a></div></div>',s+='<div class="col text-center w13"><div style="font-size: 2em;">'+NumberToFormattedNumber(mt.healing,2)+"</div>HPS: "+NumberToFormattedNumber(mt.healing/((mt.ended?mt.ended:o)-mt.start)*1e3,2)+"</div>",s+='<div class="col text-center w13"><div style="font-size: 2em;">'+(nt/(mt.healing+nt)*100).toFixed(2)+"%</div>overhealing</div>",s+='<div class="col text-center w13"><div style="font-size: 2em;">'+NumberToFormattedNumber(mt.mana)+"</div>Mana</div></div></li>"}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">SPIRIT LINK</header><div class="list-top-line"> </div><ul class="list slt">';for(var r=0,i=sltTracking.length;r<i;r++){var mt=sltTracking[r];s+='<li class="item clearfix"><div class="row full"><div class="col w70p">',s+='<a href="//www.wowhead.com/spell='+(p=98021)+'"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[p].icon+'" alt="'+cV.spellInfo[p].name+'"></a></div>',s+='<div class="col half">',s+='<header class="cd_header"><a href="//www.wowhead.com/spell='+p+'">'+cV.spellInfo[p].name+"</a> ("+MsToFormattedTime(mt.start-n)+" -> "+MsToFormattedTime((mt.ended?mt.ended:o)-n)+"):</header>",s+='<div class="col full div_more_2"><a href="javascript:void(0)" class="more_2">expand</a></div>',s+='<div class="col full div_more_3" style="display:none;">';for(var dt=0,st=0,ut=-1,d=0,u=mt.damage.length;d<u;d++){Object.keys(mt.damage[d].data).forEach(function(t){var a=actorsData[t];a&&(s+='<div class="row full"><div class="cd_more_3_time">'+(ut<mt.damage[d].time?(mt.damage[d].time/1e3).toFixed(3):"")+'</div><div class="cd_more_3_info cd_more_3_info_heal'+(a.class?" "+a.class:"")+'">',s+=a.name+'</div><div class="cd_more_3_info cd_more_3_info_amount slt-damage">'+mt.damage[d].data[t].amount.format()+"</div>",mt.damage[d].data[t].absorbed>0&&(s+='<div class="cd_more_3_info cd_more_3_info_over">'+mt.damage[d].data[t].absorbed.format()+"</div>"),s+="</div>",ut=mt.damage[d].time)});for(var lt=mt.damage[d+1]?mt.damage[d+1].time:o,t=st,a=mt.heal.length;t<a&&!(mt.heal[t].time>=lt);t++)Object.keys(mt.heal[t].data).forEach(function(a){var e=actorsData[a];e&&(s+='<div class="row full"><div class="cd_more_3_time">'+(ut<mt.heal[t].time?(mt.heal[t].time/1e3).toFixed(3):"")+'</div><div class="cd_more_3_info cd_more_3_info_heal'+(e.class?" "+e.class:"")+'">',s+=e.name+'</div><div class="cd_more_3_info cd_more_3_info_amount slt-heal">'+mt.heal[t].data[a].amount.format()+"</div>",mt.heal[t].data[a].absorbed>0&&(s+='<div class="cd_more_3_info cd_more_3_info_over">'+mt.heal[t].data[a].absorbed.format()+"</div>"),s+="</div>",ut=mt.heal[d].time,dt+=mt.heal[t].data[a].amount)}),st=t+1}s+='<br><a href="javascript:void(0)" class="more_3-2">hide</a></div></div>',s+='<div class="col text-center w20"><div style="font-size: 2em;">'+NumberToFormattedNumber(dt,2)+"</div>HPS: "+NumberToFormattedNumber(dt/((mt.ended?mt.ended:o)-mt.start)*1e3,2)+"</div></div></li>"}s+="</ul></div></div></div>",$("#main").html(s),$("a.more_1").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_2").show(),!1}),$("a.more_2").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_3").show(),!1}),$("a.more_3").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_1").show(),!1}),$("a.more_3-2").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_2").show(),!1});for(var r=0,i=F.length;r<i;r++)GetItemDataFromWowhead(F[r])}function BuildFightsList(){a="";a+='<div class="panel"><div class="col-full"><div class="box"><ul class="list fightslist">';var t={};Object.keys(fightsData).forEach(function(e){var r=fightsData[e];if(r.actors&&r.boss&&diffIdToName[r.difficulty]){t[r.boss]=t[r.boss]||{},t[r.boss][r.difficulty]=(t[r.boss][r.difficulty]||0)+1;for(var i=0,s=r.actors.length;i<s;i++)"Shaman"==actorsData[r.actors[i]].class&&(a+='<a href="?report='+reportFightCode+"&fight="+e+"&actor="+r.actors[i]+'" data-fight="'+e+'" data-actor="'+r.actors[i]+'" class="fightlist-btn">',a+='<li class="item clearfix" style="padding: 5px 15px;"><div class="row full"><div class="col" style="width:30%">',a+=diffIdToName[r.difficulty]+" "+r.name+" "+(r.kill?"":"#"+t[r.boss][r.difficulty])+' <em class="'+(r.kill?"kill":"wipe")+'">'+(r.kill?"kill":"wipe")+"</em></div>",a+='<div class="col" style="width:5%">'+MsToFormattedTime(r.end_time-r.start_time)+'</div><div class="col" style="width:20%">'+actorsData[r.actors[i]].name+"</div></div>",a+="</li></a>")}}),a+="</ul></div></div></div>",$("#main").html(a),$(".fightlist-btn").click(function(t){t.preventDefault();var a=$(this).attr("data-fight");fightsData[a]&&PrepParse(a,$(this).attr("data-actor"))});var a="";a+='<li class="breadcrumb-item"><a href="?" id="nav-btn-main">Resto Analyzer</a></li>',a+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+'" target="_blank">Report</a></li>',$("#navbar-header").html(a),$("#nav-btn-main").click(function(t){t.preventDefault(),BuildMainPage()}),$("#navbar-progress").width("0%").css("opacity","0"),window.history.pushState("report","Report","?report="+reportFightCode)}function PrepParse(t,a){$("#navbar-progress").width("1%").css("opacity","1");var e=fightsData[t];currFightData.start_time=e.start_time,currFightData.end_time=e.end_time,currFightData.actor=a,currFightData.id=t,currFightData.name=diffIdToName[e.difficulty]+" "+e.name+(e.kill?" - Kill":""),currFightData.actorName=actorsData[a].name,currFightData.len=e.end_time-e.start_time,actors=[],healingData=[],pV={},rV={talents:[],traits:[],resurgence:[],potions:[],buffs:{vers:[],crit:[],haste:[],haste_mod:[],mastery:[],int:[]},healFromMana:0,manaUsage:0,manaUsageBySpell:[],manaGain:0},cV={traitInfo:[],gearInfo:[],talentInfo:[],spellInfo:[]},healPerStat={int:{amount:0,total:0,avg:0,avgCount:0,all:0},crit:{amount:0,total:0,avg:0,avgCount:0,all:0},haste:{amount:0,total:0,avg:0,avgCount:0,all:0},mastery:{amount:0,total:0,avg:0,avgCount:0,all:0,b100:0,b80:0,b70:0,b60:0,b50:0,b40:0,b30:0,t:{}},vers:{amount:0,total:0,avg:0,avgCount:0,all:0}},cooldownsTracking=[],sltTracking=[],buffStatus=[];for(var r=0,i=pluginsList.length;r<i;r++)for(var s=pluginsList[r],n=0,o=s.length;n<o;n++)s[n].init&&s[n].init();var l="";l+='<li class="breadcrumb-item"><a href="?" id="nav-btn-main">Resto Analyzer</a></li>',l+='<li class="breadcrumb-item"><a href="?report='+reportFightCode+'" id="nav-btn-fights">'+currFightData.report_name+"</a></li>",l+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+'&type=summary" target="_blank">'+currFightData.name+" ("+MsToFormattedTime(currFightData.end_time-currFightData.start_time)+")</a></li>",l+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+"&type=healing&source="+currFightData.actor+'" target="_blank">'+currFightData.actorName+"</a></li>",$("#navbar-header").html(l),$("#nav-btn-main").click(function(t){t.preventDefault(),BuildMainPage()}),$("#nav-btn-fights").click(function(t){t.preventDefault(),BuildFightsList()}),$("#main").html(""),window.history.pushState("result","Result","?report="+reportFightCode+"&fight="+t+"&actor="+a),ParseLog(reportFightCode,a,currFightData.start_time,currFightData.end_time)}function BuildMainPage(){t="";t+='<div class="panel half" style="margin-right:auto;margin-left: auto;float:inherit;"><div class="col-full"><div class="box pos-center" style="font-size: 14px;padding-left:20px;padding-bottom:20px">',t+='<header class="box-header">ANALYZE REPORT</header>',t+='<form id="mainpage-form"><b>Enter your Warcraft Logs report code.</b><br>https://www.warcraftlogs.com/reports/ <input type="text" id="mainpage-input" size="20" class="form-control"> /<br>',t+='<input type="submit" value="Analyze" class="form-btn" id="mainpage-btn"></form></div></div></div>',$("#main").html(t),$("#mainpage-form").submit(function(t){t.preventDefault()}),$("#mainpage-btn").click(function(){ParseHeader(reportFightCode=$("#mainpage-input").val(),!0)});var t="";t+='<li class="breadcrumb-item"><a href="?" id="nav-btn-main">Resto Analyzer</a></li>',$("#navbar-header").html(t),$("#nav-btn-main").click(function(t){t.preventDefault(),BuildMainPage()}),window.history.pushState("main","Main","?")}function QueryString(){for(var t={},a=window.location.search.substring(1).split("&"),e=0;e<a.length;e++){var r=a[e].split("=");if(void 0===t[r[0]])t[r[0]]=decodeURIComponent(r[1]);else if("string"==typeof t[r[0]]){var i=[t[r[0]],decodeURIComponent(r[1])];t[r[0]]=i}else t[r[0]].push(decodeURIComponent(r[1]))}return t}for(var itemsStats={140803:{ilvl:875,int:1634},140793:{ilvl:870,mastery:1055},142507:{ilvl:865,int:1489,passive:1036},139076:{ilvl:865,int:1489,passive:1036},134336:{ilvl:865,int:1489,passive:1036},134204:{ilvl:865,int:1489,passive:1036},139114:{ilvl:865,int:1489,passive:1036},121311:{ilvl:865,int:1489,passive:1036},136750:{ilvl:865,int:1489,passive:1036},134292:{ilvl:865,int:1489,passive:1036},147276:{ilvl:865,int:1489,passive:1036},134160:{ilvl:865,int:1489,passive:1036},134380:{ilvl:865,int:1489,passive:1036},134248:{ilvl:865,int:1489,passive:1036},145231:{ilvl:865,int:1489,passive:1036},145230:{ilvl:865,int:1489,passive:1036},144258:{ilvl:940,int:2994,crit:456,mastery:456,haste:456},134526:{ilvl:825,crit:1062,mastery:797},141482:{ilvl:860,crit:847,mastery:847,vers:847,haste:847},137051:{ilvl:940,crit:2404,haste:1335},128911:{ilvl:825,int:6339,crit:271,mastery:260},128934:{ilvl:825,int:606,crit:356,mastery:342},132466:{ilvl:940,int:3150,crit:658,mastery:685,haste:1234},132452:{ilvl:940,crit:2671,haste:1818},142428:{ilvl:855,vers:1404,mastery:829},142412:{ilvl:855,int:803,crit:544,vers:241},142540:{ilvl:855,int:803,haste:325,vers:460},142521:{ilvl:855,int:803,haste:510,mastery:275},142432:{ilvl:855,int:1427,haste:579,vers:818},142410:{ilvl:855,int:1427,crit:579,haste:818},142431:{ilvl:855,int:1427,haste:579,vers:818},142433:{ilvl:855,int:1427,haste:459,mastery:938},142423:{ilvl:855,int:803,haste:325,mastery:460},142419:{ilvl:855,int:803,crit:527,vers:258},142415:{ilvl:855,int:803,vers:309,mastery:477},142427:{ilvl:855,int:803,haste:510,vers:275},142435:{ilvl:855,int:1070,crit:658,mastery:389},142434:{ilvl:855,int:1070,crit:434,haste:613},142430:{ilvl:855,int:1070,crit:411,mastery:635},142429:{ilvl:855,int:1070,crit:680,vers:366},142411:{ilvl:855,int:1070,haste:299,mastery:748},142420:{ilvl:855,int:1070,crit:680,vers:366},142416:{ilvl:855,int:1070,haste:613,mastery:434},142424:{ilvl:855,int:1070,haste:411,mastery:635},142421:{ilvl:855,int:1427,crit:968,haste:428},142413:{ilvl:855,int:1427,crit:968,haste:428},142425:{ilvl:855,int:1427,crit:459,mastery:938},142418:{ilvl:855,int:1427,vers:518,mastery:878},142422:{ilvl:855,int:1070,vers:658,mastery:389},142417:{ilvl:855,int:1070,crit:680,haste:366},142426:{ilvl:855,int:1070,crit:321,haste:725},142414:{ilvl:855,int:1070,haste:725,mastery:321},142520:{ilvl:855,crit:1021,haste:1212},140870:{ilvl:875,int:1719,crit:1042,mastery:462},138357:{ilvl:875,haste:1075,mastery:430},138314:{ilvl:875,int:1719,haste:978,vers:527},138330:{ilvl:875,int:1719,crit:914,mastery:591},140866:{ilvl:875,int:1719,vers:849,mastery:656},138312:{ilvl:875,int:1719,haste:1042,mastery:462},138331:{ilvl:875,int:1719,crit:1042,vers:462},140851:{ilvl:870,int:1641,crit:865,haste:612},140903:{ilvl:870,int:1641,haste:897,vers:580},140881:{ilvl:875,int:1719,crit:914,mastery:591},138342:{ilvl:875,haste:623,mastery:881},138332:{ilvl:875,crit:559,mastery:946},138355:{ilvl:875,vers:527,mastery:978},138378:{ilvl:875,int:1719,crit:527,haste:978},138356:{ilvl:875,int:1719,crit:462,haste:1042},140901:{ilvl:870,int:1641,haste:485,mastery:991},138313:{ilvl:875,int:1719,crit:527,mastery:978},138343:{ilvl:875,int:1719,crit:527,haste:978},140900:{ilvl:875,haste:1151,vers:1368},140899:{ilvl:875,crit:1440,mastery:1080},140894:{ilvl:870,vers:908,mastery:1537},140898:{ilvl:870,crit:768,haste:1677},140853:{ilvl:870,int:1231,crit:744,mastery:364},138347:{ilvl:875,crit:443,vers:685},138363:{ilvl:875,vers:492,mastery:636},140883:{ilvl:875,int:1289,crit:733,mastery:394},138361:{ilvl:875,crit:346,haste:782},138380:{ilvl:875,int:1289,haste:346,vers:782},138323:{ilvl:875,int:1289,vers:443,mastery:685},138362:{ilvl:875,int:1289,haste:443,vers:685},140872:{ilvl:870,int:1231,crit:673,mastery:435},138337:{ilvl:875,int:1289,vers:419,mastery:709},138338:{ilvl:875,crit:758,haste:371},138348:{ilvl:875,int:1289,haste:636,vers:492},138336:{ilvl:875,int:1289,haste:733,mastery:394},138321:{ilvl:875,int:1289,haste:782,vers:346},138322:{ilvl:875,int:1289,haste:733,mastery:394},140911:{ilvl:875,int:1289,crit:443,vers:685},140864:{ilvl:875,int:1289,crit:492,mastery:636},140917:{ilvl:880,int:1351,haste:328,mastery:822},140855:{ilvl:875,int:967,crit:459,vers:386},138375:{ilvl:875,int:967,crit:550,mastery:296},138370:{ilvl:875,int:967,vers:550,mastery:296},138373:{ilvl:875,int:967,haste:314,vers:532},138366:{ilvl:875,int:967,haste:242,vers:604},138369:{ilvl:875,int:967,haste:604,mastery:242},138365:{ilvl:875,int:967,crit:513,mastery:332},138367:{ilvl:875,int:967,crit:550,haste:296},138368:{ilvl:875,int:967,vers:259,mastery:586},138372:{ilvl:875,int:967,haste:314,mastery:532},140910:{ilvl:875,int:967,haste:278,mastery:568},138371:{ilvl:875,int:967,vers:568,mastery:278},140909:{ilvl:875,int:967,haste:604,vers:242},138374:{ilvl:875,int:967,haste:278,vers:568},138364:{ilvl:875,int:967,vers:278,mastery:568},138351:{ilvl:875,crit:1042,vers:462},140877:{ilvl:875,int:1719,haste:623,vers:881},138350:{ilvl:875,int:1719,crit:591,mastery:914},140913:{ilvl:880,int:1801,haste:997,mastery:536},138349:{ilvl:875,crit:430,haste:1075},140865:{ilvl:870,int:1641,crit:644,haste:833},138325:{ilvl:875,int:1719,haste:1075,mastery:430},138339:{ilvl:875,haste:1075,vers:430},138326:{ilvl:875,haste:623,mastery:881},138376:{ilvl:875,int:1719,crit:978,vers:527},138346:{ilvl:875,int:1719,crit:1042,mastery:462},138324:{ilvl:875,int:1719,vers:462,mastery:1042},138318:{ilvl:875,int:1719,vers:559,mastery:946},140848:{ilvl:870,int:1641,haste:1023,mastery:454},138319:{ilvl:875,int:1719,crit:914,haste:591},138320:{ilvl:875,int:1719,crit:559,mastery:946},140875:{ilvl:870,int:1641,haste:516,mastery:960},140874:{ilvl:875,int:967,crit:568,mastery:278},140878:{ilvl:875,int:967,crit:568,mastery:278},140893:{ilvl:875,int:967,crit:314,haste:532},140876:{ilvl:870,int:923,vers:487,mastery:344},140886:{ilvl:875,int:967,haste:586,vers:259},140889:{ilvl:875,int:967,crit:604,mastery:242},140850:{ilvl:875,int:967,crit:314,mastery:532},140902:{ilvl:870,int:923,vers:344,mastery:487},140857:{ilvl:875,int:967,haste:550,mastery:296},140869:{ilvl:870,int:1231,haste:720,mastery:387},140863:{ilvl:870,int:1231,haste:411,mastery:696},138327:{ilvl:875,int:1289,crit:758,vers:371},138309:{ilvl:875,int:1289,crit:467,vers:661},140905:{ilvl:875,int:1289,crit:467,mastery:661},138328:{ilvl:875,int:1289,haste:443,vers:685},138310:{ilvl:875,int:1289,crit:782,vers:346},140888:{ilvl:870,int:1231,haste:387,mastery:720},138377:{ilvl:875,int:1289,haste:782,mastery:346},138353:{ilvl:875,int:1289,vers:394,mastery:733},138354:{ilvl:875,crit:467,mastery:661},138340:{ilvl:875,crit:685,haste:443},140907:{ilvl:875,int:1289,crit:346,haste:782},140879:{ilvl:870,int:1231,haste:506,mastery:601},138329:{ilvl:875,haste:806,vers:322},138341:{ilvl:875,int:1289,crit:492,vers:636},138352:{ilvl:875,vers:709,mastery:419},138311:{ilvl:875,int:1289,crit:782,mastery:346},140880:{ilvl:870,int:1231,crit:459,mastery:648},140887:{ilvl:875,int:1289,haste:636,mastery:492},140912:{ilvl:875,int:1289,crit:733,vers:394},140919:{ilvl:880,int:1351,crit:501,mastery:649},140892:{ilvl:875,int:1289,haste:346,vers:782},140890:{ilvl:875,int:1289,crit:515,vers:612},140858:{ilvl:870,int:1231,crit:696,haste:411},140868:{ilvl:875,int:1289,haste:661,mastery:467},140859:{ilvl:875,int:1289,haste:733,vers:394},140849:{ilvl:870,int:1231,haste:364,vers:744},138379:{ilvl:875,int:1719,vers:591,mastery:914},140908:{ilvl:875,int:1719,haste:656,vers:849},140882:{ilvl:870,int:1641,haste:454,mastery:1023},140871:{ilvl:870,int:1641,crit:454,haste:1023},138359:{ilvl:875,int:1719,crit:978,vers:527},138360:{ilvl:875,crit:623,haste:881},138358:{ilvl:875,crit:914,haste:591},140862:{ilvl:870,int:1641,haste:929,mastery:548},138317:{ilvl:875,int:1719,crit:849,haste:656},138333:{ilvl:875,int:1719,crit:494,haste:1010},138315:{ilvl:875,int:1719,crit:978,haste:527},138334:{ilvl:875,int:1719,crit:462,mastery:1042},140852:{ilvl:875,int:1719,haste:688,mastery:817},138344:{ilvl:875,crit:946,mastery:559},138316:{ilvl:875,int:1719,haste:946,vers:559},138345:{ilvl:875,int:1719,vers:623,mastery:881},138335:{ilvl:875,crit:1042,vers:462},140891:{ilvl:875,int:1289,haste:782,mastery:346},140867:{ilvl:875,int:1289,vers:443,mastery:685},140904:{ilvl:870,int:1231,crit:387,vers:720},140885:{ilvl:875,int:1289,crit:419,vers:709},140860:{ilvl:870,int:1231,haste:744,vers:364},140854:{ilvl:870,int:1231,haste:506,mastery:601},140861:{ilvl:875,int:1289,crit:492,mastery:636},140914:{ilvl:880,int:1351,crit:772,mastery:378},140884:{ilvl:870,int:1231,crit:673,haste:435},140873:{ilvl:875,int:1289,crit:515,haste:612},140895:{ilvl:875,crit:1728,mastery:792},140896:{ilvl:875,haste:1512,vers:1008},140906:{ilvl:875,crit:864,vers:1656},140897:{ilvl:880,haste:742,mastery:1856},140800:{ilvl:875,haste:1075},140804:{ilvl:875,int:1634},140795:{ilvl:875,haste:1075},140798:{ilvl:875,crit:1075},140793:{ilvl:870,mastery:1055},140807:{ilvl:880,mastery:1095},140808:{ilvl:880,haste:1095},140792:{ilvl:870,int:1560},140791:{ilvl:870,crit:1055},140809:{ilvl:880,int:1712},140805:{ilvl:875,int:1634},140801:{ilvl:875,mastery:1075},144406:{ilvl:870,int:1231,crit:340,mastery:767}},baseMana=22e4,spellManaCost={77472:.09*baseMana,1064:.25*baseMana,61295:.08*baseMana,73685:.05*baseMana,5394:.11*baseMana,157153:.086*baseMana,8004:.2*baseMana,73920:21.6/100*baseMana,79206:.141*baseMana,198838:.11*baseMana,98008:.11*baseMana,108280:5.6/100*baseMana,188838:.15*baseMana,51505:.06*baseMana,192058:.1*baseMana,207399:.11*baseMana,197995:.35*baseMana},OverallBlacklist={98021:!0,208981:!0,198838:!0,235967:!0,206985:!0,143924:!0,225723:!0,206838:!0},spellScaleInt={1064:!0,73921:!0,77472:!0,61295:!0,207778:!0,52042:!0,73685:!0,208899:!0,8004:!0,197997:!0,228401:!0,209069:!0,114942:!0},spellScaleMastery={1064:!0,73921:!0,77472:!0,61295:!0,207778:!0,52042:!0,208899:!0,8004:!0,197997:!0,228401:!0,209069:!0,114942:!0},spellNotScaleHaste={208899:!0,209069:!0,98021:!0,208981:!0},spellScaleVers={1064:!0,73921:!0,77472:!0,61295:!0,207778:!0,52042:!0,208899:!0,8004:!0,197997:!0,228401:!0,209069:!0,114942:!0,73685:!0},delayedSpells=[["buffCBT",157503,{157503:!0,52042:!0,209069:!0,114942:!0,98021:!0,206985:!0,143924:!0,235967:!0,201633:!0}],["buffAG",114911,{114911:!0,52042:!0,209069:!0,114942:!0,98021:!0,206985:!0,143924:!0,235967:!0,201633:!0}],["buffASC",114083,{114083:!0,114911:!0,157503:!0,52042:!0,209069:!0,114942:!0,98021:!0,206985:!0,143924:!0,235967:!0,201633:!0}]],cooldownsTrackingIDs={108281:!0,235966:!0,114052:!0,29166:!0},cooldownsTrackingIDsbyCast={157153:15500},ignoredSpellsForCDTracking={198839:!0,201633:!0,5672:!0},healingFromMana={1064:1,73921:1,157503:.75,77472:1,61295:1,114911:.75,73685:1,235967:.75,114083:.75,8004:1,197997:1},vantusRunes={192776:"guldan",192768:"anomaly",192775:"elisande",192772:"telarn",192773:"krosus",192767:"scorp",192770:"aluriel",192774:"etraeus",192771:"tich",192769:"trillax"},statsBuffs={vers:{240670:600},crit:{240671:800,190909:1e3,225749:3892,238499:3892,224151:3e3},haste:{240673:800,225753:3892,238501:3892,224347:400,214128:6008,190909:1e3},haste_mod:{80353:1.3,2825:1.3,32182:1.3,160452:1.3,90355:1.3,146555:1.25,230935:1.25,208052:1.25,26297:1.15,202842:1.1},mastery:{225752:3892,240672:600,238500:3892,215198:430},int:{33697:2137}},spellAffectedByHaste={73921:!0,114942:!0},spellNotAffectedByHaste={208899:!0},diffIdToName={3:"Normal",4:"Heroic",5:"Mythic"},classes={Priest:!0,Warlock:!0,Druid:!0,Hunter:!0,DemonHunter:!0,Shaman:!0,Monk:!0,Mage:!0,DeathKnight:!0,Paladin:!0,Warrior:!0,Rogue:!0},qualityColors={10:"e45a5a",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80"},itemsBonusToStats={605:"mastery",603:"crit",607:"vers",604:"haste"},jewelSlots={10:!0,11:!0,1:!0},gemToStat={130222:["mastery",150],130220:["haste",150],130219:["crit",150],130221:["vers",150],130248:["int",200]},enchToStat={5436:["int",200],5469:["int",200],5890:["mastery",600],5429:["mastery",150],5427:["crit",150],5428:["haste",150],5430:["vers",150]},WCL_API_KEY="c715943c916421282ae9451912918422",actors=[],actorsData=[],fightsData=[],healingData=[],currFightData=[],pV={},rV={talents:[],traits:[],resurgence:[],potions:[],buffs:{vers:[],crit:[],haste:[],haste_mod:[],mastery:[],int:[]},healFromMana:0,manaUsage:0,manaGain:0},cV={traitInfo:[],gearInfo:[],talentInfo:[],spellInfo:[]},healPerStat={int:{amount:0,total:0,avg:0,avgCount:0},crit:{amount:0,total:0,avg:0,avgCount:0},haste:{amount:0,total:0,avg:0,avgCount:0},mastery:{amount:0,total:0,avg:0,avgCount:0,all:0},vers:{amount:0,total:0,avg:0,avgCount:0}},cooldownsTracking=[],sltTracking=[],buffStatus=[],reportFightCode,ITEMS=[{init:function(){rV.velensAmount=0},parse:["heal",function(t,a,e){pV.velensEnabled&&!OverallBlacklist[a]?rV.velensAmount+=e*(1-1/1.15):235967==a&&(rV.velensAmount+=e)},"applybuff",function(t,a){235966==a&&(pV.velensEnabled=!0)},"removebuff",function(t,a){235966==a&&(pV.velensEnabled=!1)}],obj:{type:"item",name:"Velen's Future Sight",quality:5,id:144258,gear:"velensAmount"}},{init:function(){rV.tidecallersAmount=0,rV.tidecallersPredictionAmount=0},parse:["heal",function(t,a,e){114942==a&&pV.tidecallersLast&&t.timestamp>=pV.tidecallersLast&&(rV.tidecallersAmount+=e)},"cast",function(t,a){108280==a&&(pV.tidecallersLast=t.timestamp+1e4)}],afterParse:function(){healingData[52042]&&(rV.tidecallersAmount+=.16666*healingData[52042][0],rV.tidecallersPredictionAmount+=.2*healingData[52042][0]),healingData[208899]&&(rV.tidecallersAmount+=.16666*healingData[208899][0],rV.tidecallersPredictionAmount+=.2*healingData[208899][0]),healingData[114942]&&(rV.tidecallersPredictionAmount+=.2*healingData[114942][0])},obj:{type:"item",name:"Praetorian's Tidecallers",quality:5,id:137058,prediction:"tidecallersPredictionAmount",gear:"tidecallersAmount"}},{init:function(){rV.jonatAmount=0,pV.jonatCount=0,rV.jonatPredictionAmount=0,pV.jonatLast=0,pV.jonatPredictionLast=0,pV.jonatPredictionCount=0,pV.jonatPredictionCountNow=0,pV.jonatAmountCBT=0,pV.jonatAmountAG=0,pV.jonatAmountASC=0},parse:["heal",function(t,a,e){if(1064==a){if(t.timestamp<pV.jonatLast){rV.jonatAmount+=e*(1-1/(1+.1*pV.jonatCount));var r=(e+(t.overheal||0))*(1-1/(1+.1*pV.jonatCount));pV.buffAGActive&&(pV.jonatAmountAG+=r),pV.buffCBTActive&&(pV.jonatAmountCBT+=r),pV.buffASCActive&&(pV.jonatAmountASC+=r)}t.timestamp<pV.jonatPredictionLast&&(rV.jonatPredictionAmount+=e*(.1*pV.jonatPredictionCountNow))}},"cast",function(t,a){1064==a?(pV.jonatPredictionCountNow=pV.jonatPredictionCount,pV.jonatPredictionLast=t.timestamp+1e3,pV.jonatPredictionCount=0):77472!=a&&8004!=a||(pV.jonatPredictionCount=Math.min(pV.jonatPredictionCount+1,5))},"applybuff",function(t,a){210607==a&&(pV.jonatCount=1)},"applybuffstack",function(t,a){210607==a&&(pV.jonatCount=t.stack)},"removebuff",function(t,a){210607==a&&(pV.jonatLast=t.timestamp+500)},"removebuffstack",function(t,a){210607==a&&(pV.jonatLast=t.timestamp+500)}],afterParse:function(){pV.buffAG.mod&&(rV.jonatAmount+=pV.jonatAmountAG*pV.buffAG.mod),pV.buffCBT.mod&&(rV.jonatAmount+=pV.jonatAmountCBT*pV.buffCBT.mod),pV.buffASC.mod&&(rV.jonatAmount+=pV.jonatAmountASC*pV.buffASC.mod),console.log(pV.jonatAmountCBT,pV.jonatAmountAG,pV.jonatAmountASC)},obj:{type:"item",name:"Focuser of Jonat, the Elder",quality:5,id:137051,prediction:"jonatPredictionAmount",gear:"jonatAmount"}},{init:function(){rV.prydazAmount=0,rV.prydazPredictionAmount=0,pV.prydazNextReset=0,pV.prydazCurrent=0},parse:["damage",function(t,a){if(t.targetID==currFightData.actor&&2==t.resourceActor&&t.maxHitPoints){if(t.timestamp>pV.prydazNextReset)for(pV.prydazCurrent=.25*t.maxHitPoints;pV.prydazNextReset<t.timestamp;)pV.prydazNextReset+=3e4;var e=Math.min(pV.prydazCurrent,t.amount);rV.prydazPredictionAmount+=e,pV.prydazCurrent-=e}},"combantantInfo",function(t){pV.prydazNextReset=t.timestamp-1}],afterParse:function(){healingData[207472]&&(rV.prydazAmount=healingData[207472][0])},obj:{type:"item",name:"Prydaz, Xavaric's Magnum Opus",quality:5,id:132444,prediction:"prydazPredictionAmount",gear:"prydazAmount"}},{init:function(){rV.t20_2p_PredictionAmount=0,rV.t20_2p_Amount=0,rV.t20_2p_Count=0,pV.t20_2p_gearCount=0,pV.t20_2p_last=0,pV.t20_2p_curr=0,pV.t20_2p_curr_targets=[],pV.t20_2p_pred_targets=[],pV.t20_2p_buffLast=0},parse:["heal",function(t,a,e){61295==a&&(t.tick?pV.t20_2p_pred_targets[t.targetID]&&pV.t20_2p_pred_targets[t.targetID]<=t.timestamp&&1==t.hitType&&(rV.t20_2p_PredictionAmount+=e):(t.timestamp>pV.t20_2p_last&&(pV.t20_2p_last=t.timestamp+6e4,pV.t20_2p_curr=3),pV.t20_2p_curr>0&&(1==t.hitType&&(rV.t20_2p_PredictionAmount+=e,pV.t20_4p_PredictionNext=t.timestamp+15e3),pV.t20_2p_pred_targets[t.targetID]=t.timestamp+18e3,pV.t20_2p_curr--)),t.tick||(t.timestamp<=pV.t20_2p_buffLast?(pV.t20_2p_curr_targets[t.targetID]=t.timestamp+18e3,rV.t20_2p_Count++):pV.t20_2p_curr_targets[t.targetID]=0),pV.t20_2p_curr_targets[t.targetID]&&pV.t20_2p_curr_targets[t.targetID]<=t.timestamp&&2==t.hitType&&(rV.t20_2p_Amount+=pV.critAmount*Math.max(1-pV.critNow/4e4,0)))},"removebuff",function(t,a){246729==a&&(pV.t20_2p_buffLast=t.timestamp+500)},"gear",function(t,a){147175!=a&&147176!=a&&147177!=a&&147178!=a&&147179!=a&&147180!=a||pV.t20_2p_gearCount++}],obj:{type:"spell",name:"T20 2 set Bonus",quality:10,id:242287,prediction:"t20_2p_PredictionAmount","predictionСondition":function(){return pV.t20_2p_gearCount<2},gear:"t20_2p_Amount",gearFunc:function(){return pV.t20_4p_gearCount>=2},gearAdditionalText:function(){return rV.t20_2p_Count+" times"},icon:"spell_nature_riptide.jpg"}},{init:function(){rV.t20_4p_Amount=0,rV.t20_4p_Count=0,rV.t20_4p_PredictionAmount=0,pV.t20_4p_gearCount=0,pV.t20_4p_PredictionNext=0,pV.t20_4p_buffLast=0},parse:["heal",function(t,a,e){61295!=a||t.tick||2!=t.hitType?73921==a&&pV.t20_4p_PredictionEnabled&&(rV.t20_4p_PredictionAmount+=.5*e):pV.t20_4p_PredictionNext=t.timestamp+15e3,73921==a&&pV.t20_4p_Active&&(rV.t20_4p_Amount+=e*(1-1/1.5))},"cast",function(t,a){73920==a&&(pV.t20_4p_PredictionEnabled=!1,t.timestamp<=pV.t20_4p_PredictionNext&&(pV.t20_4p_PredictionEnabled=!0),pV.t20_4p_PredictionNext=0,pV.t20_4p_Active=!1,t.timestamp<=pV.t20_4p_buffLast&&(pV.t20_4p_Active=!0,rV.t20_4p_Count++))},"removebuff",function(t,a){246771==a&&(pV.t20_4p_buffLast=t.timestamp+500)},"gear",function(t,a){147175!=a&&147176!=a&&147177!=a&&147178!=a&&147179!=a&&147180!=a||pV.t20_4p_gearCount++}],obj:{type:"spell",name:"T20 4 set Bonus",quality:10,id:242288,prediction:"t20_4p_PredictionAmount","predictionСondition":function(){return pV.t20_2p_gearCount<4},gear:"t20_4p_Amount",gearFunc:function(){return pV.t20_4p_gearCount>=4},gearAdditionalText:function(){return rV.t20_4p_Count+" times"},icon:"spell_nature_giftofthewaterspirit.jpg"}},{init:function(){rV.paradoxAmount=0,rV.paradoxMana=0},parse:["energize",function(t,a){if(225772==a){rV.manaGain+=19800,rV.paradoxAmount+=t.resourceChange+19800,rV.manaUsage-=19800,rV.manaUsageBySpell[77472]&&(rV.manaUsageBySpell[77472]-=19800);for(var e=0,r=cooldownsTracking.length;e<r;e++)cooldownsTracking[e].opened&&(cooldownsTracking[e].mana-=19800)}}],afterParse:function(){rV.paradoxMana=rV.paradoxAmount,rV.paradoxAmount=rV.paradoxMana/rV.manaUsage*rV.healFromMana},obj:{type:"item",name:"Ephemeral Paradox",quality:4,id:140805,gear:"paradoxAmount",gearAdditionalText:function(){return"Mana gain: "+NumberToFormattedNumber(rV.paradoxMana,0,2)}}},{init:function(){rV.t19_2p_Amount=0,rV.t19_2p_Count=0,pV.t19_2p_gearCount=0,pV.t19_2p_twloss=0},parse:["heal",function(t,a,e){(77472==a||8004==a)&&t.timestamp<=pV.t19_2p_twloss&&(rV.t19_2p_Amount+=.13044*e,rV.t19_2p_Count++)},"removebuff",function(t,a){53390==a&&(pV.t19_2p_twloss=t.timestamp+500)},"removebuffstack",function(t,a){53390==a&&(pV.t19_2p_twloss=t.timestamp+500)},"gear",function(t,a){138343!=a&&138341!=a&&138345!=a&&138346!=a&&138348!=a&&138372!=a||pV.t19_2p_gearCount++}],obj:{type:"spell",name:"T19 2 set Bonus",quality:10,id:211992,gear:"t19_2p_Amount",gearFunc:function(){return pV.t19_2p_gearCount>=2},gearAdditionalText:function(){return rV.t19_2p_Count+" times"},icon:"spell_shaman_tidalwaves.jpg"}},{init:function(){rV.uncertainAmount=0,pV.uncertainActive=0,rV.uncertainPredictionAmount=0,pV.uncertainPredictionTime=0},parse:["heal",function(t,a,e){OverallBlacklist[a]||(pV.uncertainActive&&t.timestamp>=pV.uncertainTime&&(rV.uncertainAmount+=e*(1-.8)),t.timestamp<pV.uncertainPredictionTime&&(rV.uncertainPredictionAmount+=.25*e))},"applybuff",function(t,a){208416==a&&(pV.uncertainActive=!0,pV.uncertainTime=t.timestamp+4e4)},"removebuff",function(t,a){208416==a&&(pV.uncertainActive=!1,pV.uncertainTime=0,pV.uncertainPredictionTime=t.timestamp+3e4)}],obj:{type:"item",name:"Uncertain Reminder",quality:5,id:143732,prediction:"uncertainPredictionAmount",gear:"uncertainAmount"}},{init:function(){rV.bootsAmount=0,rV.bootsPredictionAmount=0,pV.bootsData=[],pV.bootsCast=0},parse:["heal",function(t,a,e){73921==a?pV.bootsData[t.targetID]=!0:pV.bootsData[t.targetID]&&t.timestamp<=pV.bootsCast&&(rV.bootsPredictionAmount+=.1*e,rV.bootsAmount+=e*(1-1/1.1))},"cast",function(t,a){73920==a&&(pV.bootsData=[],pV.bootsCast=t.timestamp+1e4)}],obj:{type:"item",name:"Elemental Rebalancers",quality:5,id:137036,prediction:"bootsPredictionAmount",gear:"bootsAmount"}},{init:function(){rV.nobundosAmount=0,rV.nobundosMana=0,rV.nobundosCount=0,rV.nobundosPredictionAmount=0,rV.nobundosPredictionMana=0,rV.nobundosPredictionCount=0,pV.nobundosLastCast=0},parse:["cast",function(t,a){8004==a?(pV.nobundosLast&&(rV.nobundosPredictionMana+=22e3,rV.nobundosPredictionCount++),pV.nobundosLast=!1,pV.nobundosLastCast=t.timestamp+500):1064==a&&(pV.nobundosLast=!0)},"removebuff",function(t,a){208764==a&&t.timestamp<=pV.nobundosLastCast&&(rV.nobundosMana+=22e3,rV.nobundosCount++,rV.manaGain+=22e3,rV.manaUsage-=22e3,rV.manaUsageBySpell[8004]&&(rV.manaUsageBySpell[8004]-=22e3))}],afterParse:function(){rV.nobundosAmount=rV.nobundosMana/rV.manaUsage*rV.healFromMana,rV.nobundosPredictionAmount=rV.nobundosPredictionMana/(rV.manaUsage-rV.nobundosPredictionMana)*rV.healFromMana},obj:{type:"item",name:"Nobundo's Redemption",quality:5,id:137104,prediction:"nobundosPredictionAmount",gear:"nobundosAmount",text:function(){return"(mana saved: "+NumberToFormattedNumber(rV.nobundosPredictionMana,0,2)+")"},gearAdditionalText:function(){return"Mana gain: "+NumberToFormattedNumber(rV.nobundosMana,0,2)}}},{init:function(){rV.manaringAmount=0},parse:["heal",function(t,a,e){pV.manaringActive&&(rV.manaringAmount+=e*(1-1/1.05))},"applybuff",function(t,a){228461==a&&(pV.manaringActive=!0)},"removebuff",function(t,a){228461==a&&(pV.manaringActive=!1)}],obj:{type:"item",name:"Gnawed Thumb Ring",quality:4,id:134526,gear:"manaringAmount"}},{init:function(){rV.rootsAmount=0},afterParse:function(){healingData[208981]&&(rV.rootsAmount=healingData[208981][0])},obj:{type:"item",name:"Roots of Shaladrassil",quality:5,id:132466,gear:"rootsAmount"}},{init:function(){rV.cakeAmount=0},afterParse:function(){healingData[225723]&&(rV.cakeAmount=healingData[225723][0])},obj:{type:"item",name:"Perfectly Preserved Cake",quality:4,id:140793,gear:"cakeAmount"}},{init:function(){rV.etraeusAmount=0},parse:["gear",function(t,a){if(140803==a){var e=ScaleStat(3892.9,875,t.itemLevel);statsBuffs.haste[225753]=e,statsBuffs.mastery[225752]=e,statsBuffs.crit[225749]=e}}],afterParse:function(){rV.buffs.haste[225753]&&(rV.etraeusAmount+=rV.buffs.haste[225753]),rV.buffs.mastery[225752]&&(rV.etraeusAmount+=rV.buffs.mastery[225752]),rV.buffs.crit[225749]&&(rV.etraeusAmount+=rV.buffs.crit[225749])},obj:{type:"item",name:"Etraeus' Celestial Map",quality:4,id:140803,gear:"etraeusAmount"}},{init:function(){rV.coentrinkAmount=0},parse:["gear",function(t,a){if(144480==a){var e=ScaleStat(3892.9,875,t.itemLevel);statsBuffs.haste[238501]=e,statsBuffs.mastery[238500]=e,statsBuffs.crit[238499]=e}}],afterParse:function(){rV.buffs.haste[238501]&&(rV.coentrinkAmount+=rV.buffs.haste[238501]),rV.buffs.mastery[238500]&&(rV.coentrinkAmount+=rV.buffs.mastery[238500]),rV.buffs.crit[238499]&&(rV.coentrinkAmount+=rV.buffs.crit[238499])},obj:{type:"item",name:"Dreadstone of Endless Shadows",quality:4,id:144480,gear:"coentrinkAmount"}},{init:function(){rV.darkmoonAmount=0,rV.darkmoonAmountMana=0,pV.darkmoonManaNow=0,pV.darkmoonBuffs={191615:317,191616:436,191617:555,191618:674,191619:792,191620:911,191621:1030,191622:1268}},parse:["cast",function(t,a){spellManaCost[a]&&!pV.innervate&&pV.darkmoonManaNow>0&&(rV.darkmoonAmountMana+=pV.darkmoonManaNow,rV.manaGain+=pV.darkmoonManaNow,rV.manaUsage-=pV.darkmoonManaNow,rV.manaUsageBySpell[pV.manaUsageLastSpell]-=pV.darkmoonManaNow)},"applybuff",function(t,a){pV.darkmoonBuffs[a]&&(pV.darkmoonManaNow=pV.darkmoonBuffs[a])},"gear",function(t,a){if(128710==a){var e={};Object.keys(pV.darkmoonBuffs).forEach(function(a){e[a]=ScaleStat(pV.darkmoonBuffs[a],805,t.itemLevel,1)}),pV.darkmoonBuffs=e}}],afterParse:function(){rV.darkmoonAmount=rV.darkmoonAmountMana/rV.manaUsage*rV.healFromMana},obj:{type:"item",name:"Darkmoon Deck: Promises",quality:4,id:128710,gear:"darkmoonAmount",gearAdditionalText:function(){return"Mana gain: "+NumberToFormattedNumber(rV.darkmoonAmountMana,0,2)}}},{init:function(){rV.drapeAmount=0},parse:["heal",function(t,a,e){2==t.hitType&&(rV.drapeAmount+=pV.critAmount*(.05/1.05))}],obj:{type:"item",name:"Drape of Shame",quality:4,id:142170,gear:"drapeAmount"}},{init:function(){rV.beltAmount=0,rV.beltCount=0,pV.beltRiptideCount=0},parse:["heal",function(t,a,e){61295==a&&!t.tick&&2==t.resourceActor&&t.hitPoints&&t.maxHitPoints&&Math.max(t.hitPoints-e,0)/t.maxHitPoints<=.4&&rV.beltCount++},"cast",function(t,a){61295==a&&pV.beltRiptideCount++}],afterParse:function(){healingData[61295]&&(rV.beltAmount=healingData[61295][0]/pV.beltRiptideCount*rV.beltCount)},obj:{type:"item",name:"Intact Nazjatar Molting",quality:5,id:137085,gear:"beltAmount",gearAdditionalText:function(){return"Procs number: "+rV.beltCount},prediction:"beltAmount",text:function(){return"(procs: "+rV.beltCount+")"}}},{init:function(){rV.amalgamAmount=0,rV.amalgamMana=0},parse:["energize",function(t,a){215270==a&&(rV.manaGain+=t.resourceChange,rV.amalgamMana+=t.resourceChange)}],afterParse:function(){rV.amalgamAmount=rV.amalgamMana/rV.manaUsage*rV.healFromMana},obj:{type:"item",name:"Amalgam's Seventh Spine",quality:4,id:136714,gear:"amalgamAmount",gearAdditionalText:function(){return"Mana gain: "+NumberToFormattedNumber(rV.amalgamMana,0,2)}}},{init:function(){rV.karatrinkAmount=0,rV.karatrinkMana=0},parse:["energize",function(t,a){230144==a&&(rV.manaGain+=t.resourceChange,rV.karatrinkMana+=t.resourceChange)}],afterParse:function(){rV.karatrinkAmount=rV.karatrinkMana/rV.manaUsage*rV.healFromMana},obj:{type:"item",name:"Fluctuating Energy",quality:4,id:142162,gear:"karatrinkAmount",gearAdditionalText:function(){return"Mana gain: "+NumberToFormattedNumber(rV.karatrinkMana,0,2)}}},{init:function(){rV.darkmoonCritAmount=0,pV.darkmoonCritBuffs={191603:637,191604:718,191605:797,191606:877,191607:956,191608:1037,191609:1116,191610:1275}},parse:["gear",function(t,a){128709==a&&Object.keys(pV.darkmoonCritBuffs).forEach(function(a){statsBuffs.crit[a]=ScaleStat(pV.darkmoonCritBuffs[a],812,t.itemLevel)})}],afterParse:function(){Object.keys(pV.darkmoonCritBuffs).forEach(function(t){rV.darkmoonCritAmount+=rV.buffs.crit[t]||0})},obj:{type:"item",name:"Darkmoon Deck: Hellfire",quality:4,id:128709,gear:"darkmoonCritAmount"}}],TRAITS=[{init:function(){rV.traits[1352]=0},parse:["heal",function(t,a,e){OverallBlacklist[a]||(rV.traits[1352]+=e*(1-1/1.06))}],obj:{name:"Grace of the Sea",id:1352,spellID:224841,icon:"inv_elemental_crystal_water.jpg"}},{init:function(){rV.traits[1693]=0},parse:["heal",function(t,a,e){OverallBlacklist[a]||(rV.traits[1693]+=e*(1-1/1.1))}],obj:{name:"Echo of the Earthen Ring",id:1693,spellID:241205,icon:"misc_legionfall_shaman.jpg"}},{init:function(){rV.traits[1600]=0},parse:["heal",function(t,a,e){spellScaleInt[a]&&pV.paragonTraitActive&&GetTraitRank(1600)>0&&(rV.traits[1600]+=e/cV.intellect*(1.05*(4e3+300*(GetTraitRank(1600)-1))))},"applybuff",function(t,a){242586==a&&(pV.paragonTraitActive=!0)},"removebuff",function(t,a){242586==a&&(pV.paragonTraitActive=!1)}],obj:{name:"Concordance of the Legionfall",id:1600,spellID:239042,icon:"trade_archaeology_sharkjaws.jpg",additionalText:function(){var t=GetTraitRank(1600);if(1==t)return"";var a=300*t/(300*t+4e3)*rV.traits[1600];return t--,"Per rank: "+NumberToFormattedNumber(a/t,0,2)+" ("+(a/t/rV.total*100).toFixed(2)+"%)"}}},{init:function(){rV.traits[1112]=0},parse:["heal",function(t,a,e){OverallBlacklist[a]||pV.blTraitActive&&(rV.traits[1112]+=e*(1-.8))},"applybuff",function(t,a){208416==a&&(pV.blTraitActive=!0)},"removebuff",function(t,a){208416==a&&(pV.blTraitActive=!1)}],obj:{name:"Sense of Urgency",id:1112,spellID:207355,icon:"inv_misc_pocketwatch_02.jpg"}},{init:function(){rV.traits[1109]=0},parse:["heal",function(t,a,e){1064==a&&2==t.hitType&&(rV.traits[1109]+=pV.critAmount*(4*GetTraitRank(1109)*400/pV.critNow))}],obj:{name:"Floodwaters",id:1109,spellID:207348,icon:"spell_nature_healingwavegreater.jpg"}},{init:function(){rV.traits[1107]=0},parse:["heal",function(t,a,e){73921==a&&(2==t.hitType&&(rV.traits[1107]+=pV.critAmount*(2*GetTraitRank(1107)*400/pV.critNow)),rV.traits[1107]+=e*(1-1/(1+.02*GetTraitRank(1107))))}],obj:{name:"Empowered Droplets",id:1107,spellID:207255,icon:"spell_nature_giftofthewaterspirit.jpg"}},{init:function(){rV.traits[1113]=0},afterParse:function(){rV.trait_1113=rV.traits[1113],rV.traits[1113]=rV.traits[1113]/rV.manaUsage*rV.healFromMana},parse:["energize",function(t,a){101033==a&&4125==t.resourceChange&&(rV.traits[1113]+=1325)}],obj:{name:"Refreshing Currents",id:1113,spellID:207356,icon:"ability_monk_cracklingjadelightning.jpg",additionalText:function(){return"Total mana gained: "+NumberToFormattedNumber(rV.trait_1113,0,2)}}},{init:function(){rV.traits[1117]=0,pV.httTraitLast=0,pV.httTraitCount=0},parse:["heal",function(t,a,e){114942==a&&(t.timestamp-pV.httTraitLast>15e3?pV.httTraitCount=0:t.timestamp-pV.httTraitLast>=300&&(pV.httTraitCount=Math.min(pV.httTraitCount+1,7)),pV.httTraitLast=t.timestamp,rV.traits[1117]+=e*(1-1/(1+.1*pV.httTraitCount)))}],obj:{name:"Cumulative Upkeep",id:1117,spellID:207362,icon:"ability_shaman_healingtide.jpg"}},{init:function(){rV.traits[1598]=0},parse:["heal",function(t,a,e){73921==a&&(rV.traits[1598]+=e*(1-1/1.3))}],obj:{name:"Pitter-Patter",id:1598,spellID:242652,icon:"spell_nature_giftofthewaterspirit.jpg"}},{init:function(){rV.traits[1599]=0,pV.gotqLast=0},parse:["heal",function(t,a,e){207778==a&&t.timestamp-pV.gotqLast>2e3&&t.timestamp-pV.gotqLast<4e3&&(rV.traits[1599]+=e)},"cast",function(t,a){207778==a&&(pV.gotqLast=t.timestamp)}],obj:{name:"Deep Waters",id:1599,spellID:238143,icon:"inv_mace_1h_artifactazshara_d_02.jpg"}},{init:function(){rV.traits[1116]=0},afterParse:function(){healingData[208899]&&(rV.traits[1116]=healingData[208899][0])},obj:{name:"Queen's Decree",id:1116,spellID:207360,icon:"inv_misc_volatilewater.jpg"}},{init:function(){rV.traits[1115]=0},afterParse:function(){healingData[209069]&&(rV.traits[1115]=healingData[209069][0])},obj:{name:"Tidal Pools",id:1115,spellID:207358,icon:"achievement_dungeon_throneofthetides.jpg"}},{init:function(){rV.traits[1105]=0},parse:["heal",function(t,a,e){207778==a&&(rV.traits[1105]+=e*(1-1/(1+.05*GetTraitRank(1105))))}],obj:{name:"Pull of the Sea",id:1105,spellID:210031,icon:"inv_tradeskillitem_sorcererswater.jpg"}},{init:function(){rV.traits[1106]=0},parse:["heal",function(t,a,e){52042==a&&(rV.traits[1106]+=e*(1-1/(1+.1*GetTraitRank(1106))))}],obj:{name:"Wavecrash",id:1106,spellID:207206,icon:"inv_spear_04.jpg"}},{init:function(){rV.traits[1104]=0},parse:["heal",function(t,a,e){77472!=a&&8004!=a||(rV.traits[1104]+=e*(1-1/(1+.05*GetTraitRank(1104))))}],obj:{name:"Buffeting Waves",id:1104,spellID:207092,icon:"ability_skyreach_four_wind.jpg"}},{init:function(){rV.traits[1103]=0,rV.traits1103_CastTime=0,rV.traits1103_Crit=0,pV.traits1103_TidalLoss=0,pV.traits1103_HRStartCast=0,pV.traits1103_HRCastTime=0},parse:["heal",function(t,a,e){if((77472==a||8004==a)&&t.timestamp<=pV.hwWithoutTidalLoss)if(8004==a&&2==t.hitType)rV.traits1103_Crit+=4*GetTraitRank(1103)*400/pV.critNow*pV.critAmount;else if(77472==a){var r=.03*GetTraitRank(1103);rV.traits1103_CastTime+=pV.traits1103_HRCastTime/(1-r)*r}},"removebuff",function(t,a){53390==a&&(pV.traits1103_TidalLoss=t.timestamp+500)},"removebuffstack",function(t,a){53390==a&&(pV.traits1103_TidalLoss=t.timestamp+500)},"begincast",function(t,a){77472==a&&(pV.traits1103_HRStartCast=t.timestamp)},"cast",function(t,a){77472==a&&(pV.traits1103_HRCastTime=t.timestamp-pV.traits1103_HRStartCast)}],afterParse:function(){var t=rV.total/(currFightData.end_time-currFightData.start_time);rV.traits[1103]=rV.traits1103_Crit+t*rV.traits1103_CastTime},obj:{name:"Tidal Chains",id:1103,spellID:207088,icon:"spell_frost_chainsofice.jpg",tip:function(){return"From surge crit: "+NumberToFormattedNumber(rV.traits1103_Crit,0,2)+"<br>Reduced HW cast time: "+(rV.traits1103_CastTime/1e3).toFixed(1)+"s"}}},{init:function(){rV.traits[1108]=0,rV.traits1108_CastTime=0,pV.traits1108_LastCast=0,pV.traits1108_QALoss=0},parse:["applybuff",function(t,a){207288==a&&(pV.traits1108_QAActive=!0)},"removebuff",function(t,a){207288==a&&(pV.traits1108_QAActive=!1)},"begincast",function(t,a){77472!=a&&8004!=a&&1064!=a||(pV.traits1108_LastCast=t.timestamp)},"cast",function(t,a){if(pV.traits1108_QAActive&&(77472==a||8004==a||1064==a)){var e=t.timestamp-pV.traits1108_LastCast,r=.05*GetTraitRank(1108);rV.traits1108_CastTime+=e/(1-r)*r}}],afterParse:function(){var t=rV.total/(currFightData.end_time-currFightData.start_time);rV.traits[1108]=t*rV.traits1108_CastTime},obj:{name:"Queen Ascendant",id:1108,spellID:207288,icon:"ability_shaman_watershield.jpg",tip:function(){return"Reduced cast time: "+(rV.traits1108_CastTime/1e3).toFixed(1)+"s<br>To value heal number used HPS*Reduced time"}}}],TALENTS=[{init:function(){rV.talents[157153]=0},afterParse:function(){healingData[157503]&&(rV.talents[157153]=healingData[157503][0])},obj:{name:"Cloudburst Totem",id:157153}},{init:function(){rV.talents[200072]=0},parse:["heal",function(t,a,e){61295!=a||t.tick||(rV.talents[200072]+=e*(1-1/1.3))}],obj:{name:"Torrent",id:200072}},{init:function(){rV.talents[73685]=0,pV.ulLossTime=0},parse:["heal",function(t,a,e){t.timestamp-pV.ulLossTime<=300&&(61295==a&&!t.tick||77472==a||8004==a||1064==a)?rV.talents[73685]+=e*(1-1/1.45):73685==a&&(rV.talents[73685]+=e)},"removebuff",function(t,a){73685==a&&(pV.ulLossTime=t.timestamp)}],obj:{name:"Unleash Life",id:73685}},{init:function(){rV.talents[108281]=0},afterParse:function(){healingData[114911]&&(rV.talents[108281]=healingData[114911][0])},obj:{name:"Ancestral Guidance",id:108281}},{init:function(){rV.talents[198838]=0},afterParse:function(){healingData[201633]&&(rV.talents[198838]=healingData[201633][0])},obj:{name:"Earthen Shield Totem",id:198838}},{init:function(){rV.talents[114052]=0},afterParse:function(){healingData[114083]&&(rV.talents[114052]=healingData[114083][0])},obj:{name:"Ascendance",id:114052}},{init:function(){rV.talents[197995]=0},afterParse:function(){healingData[197997]&&(rV.talents[197995]=healingData[197997][0])},obj:{name:"Wellspring",id:197995}},{init:function(){rV.talents[157154]=0,pV.highTideBounds=0},parse:["heal",function(t,a,e){1064==a&&(pV.highTideBounds>=4?rV.talents[157154]+=e:rV.talents[157154]+=e*(1-Math.pow(.7,pV.highTideBounds)/Math.pow(.85,pV.highTideBounds)),pV.highTideBounds++)},"cast",function(t,a){1064==a&&(pV.highTideBounds=0)}],obj:{name:"High Tide",id:157154}},{init:function(){rV.talents[200071]=0,pV.undulationLossTime=0},parse:["heal",function(t,a,e){(77472==a||8004==a)&&t.timestamp-pV.undulationLossTime<=300&&(rV.talents[200071]+=e*(1-1/1.5))},"removebuff",function(t,a){216251==a&&(pV.undulationLossTime=t.timestamp)}],obj:{name:"Undulation",id:200071}}],RESURGENCE=[{init:function(){rV.resurgence[8004]=[0,0]},parse:["cast",function(t,a){8004==a&&(pV.resurgenceLast6600=8004)},"energize",function(t,a){6600==t.resourceChange&&101033==a&&8004==pV.resurgenceLast6600&&(rV.resurgence[8004][0]+=t.resourceChange,rV.resurgence[8004][1]++)}],obj:{id:8004,name:"Healing Surge",icon:"spell_nature_healingway.jpg"}},{init:function(){rV.resurgence[61295]=[0,0]},parse:["cast",function(t,a){61295==a&&(pV.resurgenceLast6600=61295)},"energize",function(t,a){6600==t.resourceChange&&101033==a&&61295==pV.resurgenceLast6600&&(rV.resurgence[61295][0]+=t.resourceChange,rV.resurgence[61295][1]++)}],obj:{id:61295,name:"Riptide",icon:"spell_nature_riptide.jpg"}},{init:function(){rV.resurgence[73685]=[0,0]},parse:["cast",function(t,a){73685==a&&(pV.resurgenceLast6600=73685)},"energize",function(t,a){6600==t.resourceChange&&101033==a&&73685==pV.resurgenceLast6600&&(rV.resurgence[73685][0]+=t.resourceChange,rV.resurgence[73685][1]++)}],obj:{id:73685,name:"Unleash Life",icon:"spell_shaman_unleashweapon_life.jpg"}},{init:function(){rV.resurgence[1064]=[0,0]},parse:["energize",function(t,a){4125!=t.resourceChange&&2750!=t.resourceChange||101033!=a||(rV.resurgence[1064][0]+=t.resourceChange,rV.resurgence[1064][1]++)}],obj:{id:1064,name:"Chain Heal",icon:"spell_nature_healingwavegreater.jpg"}},{init:function(){rV.resurgence[77472]=[0,0]},parse:["energize",function(t,a){11e3==t.resourceChange&&101033==a&&(rV.resurgence[77472][0]+=t.resourceChange,rV.resurgence[77472][1]++)}],obj:{id:77472,name:"Healing Wave",icon:"spell_nature_healingwavelesser.jpg"}}],POTIONS=[{init:function(){rV.potions[188016]=0},parse:["heal",function(t,a,e){188016==a&&(rV.potions[188016]+=e)}],obj:{id:188016,name:"Ancient Healing Potion",icon:"inv_alchemy_70_red.jpg"}},{init:function(){rV.potions[229206]=0,rV.prolongedTemp=0},parse:["heal",function(t,a,e){spellScaleInt[a]&&(pV.prolongedActive?rV.potions[229206]+=e/cV.intellect*2500*1.05:rV.prolongedTemp+=e/cV.intellect*2500*1.05)},"applybuff",function(t,a){229206==a&&(pV.prolongedActive=!0)},"removebuff",function(t,a){229206==a&&(pV.prolongedActive||(rV.potions[229206]=rV.prolongedTemp),pV.prolongedActive=!1)}],obj:{id:229206,name:"Potion of Prolonged Power",icon:"trade_alchemy_dpotion_a28.jpg"}},{init:function(){rV.potions[188017]=0},parse:["energize",function(t,a){188017==a&&(rV.potions[188017]+=t.resourceChange)}],obj:{id:188017,name:"Ancient Mana Potion",icon:"inv_alchemy_70_blue.jpg",text:function(){var t=rV.potions[188017]/rV.manaUsage*rV.healFromMana;return'Mana gained: <em class="result">'+NumberToFormattedNumber(rV.potions[188017],0,2)+"</em> ("+(rV.potions[188017]/rV.manaUsage*100).toFixed(2)+'%)<br>Helaing: <em class="result-hps">'+NumberToFormattedNumber(t,0,2)+"</em> ("+(t/rV.total*100).toFixed(2)+"%)"}}},{init:function(){rV.potions[188030]=0},parse:["energize",function(t,a){188030==a&&(rV.potions[188030]+=t.resourceChange)}],obj:{id:188030,name:"Leytorrent Potion",icon:"inv_alchemy_70_flask01.jpg",text:function(){var t=rV.potions[188030]/rV.manaUsage*rV.healFromMana;return'Mana gained: <em class="result">'+NumberToFormattedNumber(rV.potions[188030],0,2)+"</em> ("+(rV.potions[188030]/rV.manaUsage*100).toFixed(2)+'%)<br>Helaing: <em class="result-hps">'+NumberToFormattedNumber(t,0,2)+"</em> ("+(t/rV.total*100).toFixed(2)+"%)"}}}],OTHER=[{init:function(){rV.hwWithoutTidal=0,rV.hwWithoutTidalTotal=0,pV.hwWithoutTidalLoss=0},parse:["heal",function(t,a,e){77472!=a&&8004!=a||(t.timestamp<=pV.hwWithoutTidalLoss||rV.hwWithoutTidal++,rV.hwWithoutTidalTotal++)},"removebuff",function(t,a){53390==a&&(pV.hwWithoutTidalLoss=t.timestamp+500)},"removebuffstack",function(t,a){53390==a&&(pV.hwWithoutTidalLoss=t.timestamp+500)}]},{init:function(){rV.spiritwalkerUptime=0,pV.spiritwalkerLast=0},parse:["removebuff",function(t,a){79206==a&&pV.spiritwalkerLast>0&&(rV.spiritwalkerUptime+=t.timestamp-pV.spiritwalkerLast)},"applybuff",function(t,a){79206==a&&(pV.spiritwalkerLast=t.timestamp)}]},{init:function(){rV.wolfUptime=0,pV.wolfLast=0},parse:["removebuff",function(t,a){2645==a&&pV.wolfLast>0&&(rV.wolfUptime+=t.timestamp-pV.wolfLast)},"applybuff",function(t,a){2645==a&&(pV.wolfLast=t.timestamp)}]},{init:function(){function t(){return{amount:0,total:0,avg:0,avgCount:0,all:0,buffs:[],spells:[]}}function a(){return{int:t(),haste:t(),mastery:t(),vers:t(),crit:t(),time:0,feed:0,spellsfeed:[]}}pV.critTidalLoss=0,pV.buffAG=a(),pV.buffAG.buffASC=a(),pV.buffAG.buffCBT=a(),pV.buffASC=a(),pV.buffCBT=a(),pV.buffCBT.buffASC=a(),pV.buffCBT.buffAG=a()},parse:["applybuff",function(t,a){108281==a?(pV.buffAG.time=t.timestamp+11e3,pV.buffAGActive=!0):114052==a&&(pV.buffASC.time=t.timestamp+16e3,pV.buffASCActive=!0)},"removebuff",function(t,a){108281==a?(pV.buffAG.time=0,pV.buffAGActive=!1):114052==a&&(pV.buffASC.time=0,pV.buffASCActive=!1)},"cast",function(t,a){157153==a?(pV.buffCBT.time=t.timestamp+15500,pV.buffCBTActive=!0):201764==a&&(pV.buffCBT.time=0,pV.buffCBTActive=!1)}],afterParse:function(){for(var t=["int","haste","mastery","vers","crit"],a=["buffAG","buffASC","buffCBT"],e=0,r=delayedSpells.length;e<r;e++){i=delayedSpells[e];healingData[i[1]]&&(pV[i[0]].itself=healingData[i[1]][0])}for(var e=0,r=delayedSpells.length;e<r;e++){var i=delayedSpells[e],s=pV[i[0]],n=0;if(healingData[i[1]]&&(n=healingData[i[1]][0]),n>0&&s.feed>0){var o=n/s.feed;s.mod=o;for(var l=0,c=t.length;l<c;l++)healPerStat[f=t[l]].amount+=s[f].amount*o,healPerStat[f].total+=s[f].total*o,healPerStat[f].avg+=s[f].avg*o,healPerStat[f].avgCount+=s[f].avgCount*o,healPerStat[f].all+=s[f].all*o,healPerStat[f].spells||(healPerStat[f].spells={}),healPerStat[f].spells[i[1]]=(healPerStat[f].spells[i[1]]||0)+s[f].amount*o,Object.keys(s[f].buffs).forEach(function(t){rV.buffs[f][t]||(rV.buffs[f][t]=0),rV.buffs[f][t]+=s[f].buffs[t]*o});for(var l=0,c=a.length;l<c;l++){var m=s[a[l]];if(m&&pV[a[l]].feed>0)for(var d=pV[a[l]].itself/pV[a[l]].feed,u=0,p=t.length;u<p;u++){var f=t[u];healPerStat[f].amount+=m[f].amount*o*d,healPerStat[f].total+=m[f].total*o*d,healPerStat[f].avg+=m[f].avg*o*d,healPerStat[f].avgCount+=m[f].avgCount*o*d,healPerStat[f].all+=m[f].all*o*d,healPerStat[f].spells||(healPerStat[f].spells={}),healPerStat[f].spells[i[1]]=(healPerStat[f].spells[i[1]]||0)+m[f].amount*o*d,Object.keys(m[f].buffs).forEach(function(t){rV.buffs[f][t]||(rV.buffs[f][t]=0),rV.buffs[f][t]+=m[f].buffs[t]*o*d})}}}}}},{init:function(){rV.resurgenceCrit=0,rV.resurgenceCritAmount=0,pV.resurgenceCritAvg=0,pV.resurgenceCritCount=0},parse:["heal",function(t,a,e){8004!=a&&(61295!=a||t.tick)&&73685!=a&&1064!=a&&77472!=a||2!=t.hitType||(pV.resurgenceCritAvg+=pV.critNow,pV.resurgenceCritCount++)},"energize",function(t,a){101033==a&&(rV.resurgenceCrit+=t.resourceChange)}],afterParse:function(){rV.resurgenceCritAmount=pV.resurgenceCritAvg/pV.resurgenceCritCount}}],parsePlugins={heal:[],applybuff:[],applybuffstack:[],removebuff:[],removebuffstack:[],cast:[],begincast:[],damage:[],energize:[],gear:[],combantantInfo:[]},pluginsList=[OTHER,ITEMS,TRAITS,TALENTS,RESURGENCE,POTIONS],k=0,k_len=pluginsList.length;k<k_len;k++)for(var pluginData=pluginsList[k],i=0,len=pluginData.length;i<len;i++)if(pluginData[i].parse)for(var j=0,j_len=pluginData[i].parse.length;j<j_len;j+=2)parsePlugins[pluginData[i].parse[j]].push(pluginData[i].parse[j+1]);var multiplicateCDs=[[function(t,a){if(114911==t&&a<=pV.buffCBT.time)return!0},"buffCBT","buffAG"],[function(t,a){if(114083==t&&a<=pV.buffCBT.time)return!0},"buffCBT","buffASC"],[function(t,a){if(157503==t&&a<=pV.buffAG.time)return!0},"buffAG","buffCBT"],[function(t,a){if(114083==t&&a<=pV.buffAG.time)return!0},"buffAG","buffASC"]],IsWowheadResponceRewritten=!1;Number.prototype.format=function(){return this.toLocaleString(void 0,{maximumFractionDigits:0,useGrouping:!0}).replace(/\D/g,",")},$(document).ready(function(){var t=QueryString();t.report&&t.fight&&t.actor?ParseHeader(reportFightCode=t.report,!1,function(){PrepParse(t.fight,t.actor)}):t.report?ParseHeader(reportFightCode=t.report,!0):BuildMainPage()});