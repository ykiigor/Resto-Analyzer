function GetTraitRank(t){return cV.traitInfo[t]?cV.traitInfo[t].rank:0}function ScaleStat(t,e,a,i){var r=e<=800||1==i?1:2==i?Math.pow(.996754034,e-800):Math.pow(.994435486,e-800),s=a<=800||1==i?1:2==i?Math.pow(.996754034,a-800):Math.pow(.994435486,a-800),l=(t/=r)*Math.pow(1.00936,a-e);return l*=s}function MsToFormattedTime(t,e){e&&(t-=currFightData.start_time);var a=Math.floor(t/6e4),i=Math.floor((t-6e4*a)/1e3);return(a<10?"0":"")+a+":"+(i<10?"0":"")+i}function NumberToFormattedNumber(t,e,a,i){return e=e||0,t>1e9?(t/1e9).toFixed(e)+"M":t>1e6?(a&&(e=a),(t/1e6).toFixed(e)+"m"):t>1e3?(i&&(e=i),(t/1e3).toFixed(e)+"k"):Math.floor(t)}function error_msg(t){$("#main").html('<div class="panel"><div class="col-full"><div class="box">'+t+"</div></div></div>")}function ParseLog(t,e,a,i){$.getJSON("https://www.warcraftlogs.com:443/v1/report/events/"+t+"?start="+a+"&end="+i+"&actorid="+e+"&api_key="+WCL_API_KEY).done(function(a){if(400==a.status)throw error_msg(a.error),new Error("Error: Parsing Error");actors[e]=!0;for(var r=0,s=a.events.length;r<s;r++){var l=a.events[r],n=1==l.resourceActor?l.sourceID:l.targetID;if(n&&(currHP[n]||(currHP[n]=[]),currHP[n].num=l.hitPoints,currHP[n].max=l.maxHitPoints,currHP[n].per=l.hitPoints/l.maxHitPoints,n==e&&l.spellPower&&(cV.intellect=l.spellPower,cV.intellect_min=Math.min(cV.intellect_min,cV.intellect))),"heal"==l.type&&actors[l.sourceID]){g=l.ability.guid;healingData[g]||(healingData[g]=[0,0]);f=l.amount;if(l.absorbed&&(f+=l.absorbed),healingData[g][0]+=f,l.overheal&&(healingData[g][1]+=l.overheal),notHealingFromMana[g]||(rV.healFromMana+=f),(!spellsIgnoreStat[g]||spellsNotIgnoreInt[g])&&(healPerStat.int.amount+=f/cV.intellect,healPerStat.int.total+=f,healPerStat.int.avg+=cV.intellect,healPerStat.int.avgCount++,Object.keys(statsBuffs.int).forEach(function(t){buffStatus[t]&&(rV.buffs.int[t]||(rV.buffs.int[t]=0),rV.buffs.int[t]+=statsBuffs.int[t]/cV.intellect*f)}),!spellsNotIgnoreInt[g])){if(2==l.hitType&&(pV.critNow=cV.critSpell,pV.critAmount=f/(cV.gearInfo[142170]?2.05/1.05:2),Object.keys(statsBuffs.crit).forEach(function(t){buffStatus[t]&&(pV.critNow+=statsBuffs.crit[t])}),1064==g?pV.critNow+=4*GetTraitRank(1109)*400:73921==g&&(pV.critNow+=2*GetTraitRank(1107)*400),healPerStat.crit.amount+=pV.critAmount/pV.critNow,healPerStat.crit.total+=pV.critAmount,healPerStat.crit.avg+=pV.critNow,healPerStat.crit.avgCount++,Object.keys(statsBuffs.crit).forEach(function(t){buffStatus[t]&&(rV.buffs.crit[t]||(rV.buffs.crit[t]=0),rV.buffs.crit[t]+=statsBuffs.crit[t]/pV.critNow*pV.critAmount)})),currHP[l.targetID]&&73685!=g){var o=Math.max(currHP[l.targetID].num-f,0)/currHP[l.targetID].max;pV.masteryNow=cV.mastery,Object.keys(statsBuffs.mastery).forEach(function(t){buffStatus[t]&&(pV.masteryNow+=statsBuffs.mastery[t])}),pV.currHealFromMastery=f*(1-1/(1+pV.masteryNow/133.33/100*(1-o))),healPerStat.mastery.amount+=pV.currHealFromMastery/pV.masteryNow,healPerStat.mastery.total+=pV.currHealFromMastery,healPerStat.mastery.avg+=pV.masteryNow,healPerStat.mastery.avgCount++,healPerStat.mastery.all+=f,Object.keys(statsBuffs.mastery).forEach(function(t){buffStatus[t]&&(rV.buffs.mastery[t]||(rV.buffs.mastery[t]=0),rV.buffs.mastery[t]+=statsBuffs.mastery[t]/pV.masteryNow*pV.currHealFromMastery)})}if(pV.versNow=cV.versatility,Object.keys(statsBuffs.vers).forEach(function(t){buffStatus[t]&&(pV.versNow+=statsBuffs.vers[t])}),pV.currHealFromVers=f*(1-1/(pV.versNow/475/100+1)),healPerStat.vers.amount+=pV.currHealFromVers/pV.versNow,healPerStat.vers.total+=pV.currHealFromVers,healPerStat.vers.avg+=pV.versNow,healPerStat.vers.avgCount++,Object.keys(statsBuffs.vers).forEach(function(t){buffStatus[t]&&(rV.buffs.vers[t]||(rV.buffs.vers[t]=0),rV.buffs.vers[t]+=statsBuffs.vers[t]/pV.versNow*pV.currHealFromVers)}),(l.tick||spellAffectedByHaste[g])&&!spellNotAffectedByHaste[g]){pV.hasteNow=cV.haste,Object.keys(statsBuffs.haste).forEach(function(t){buffStatus[t]&&(pV.hasteNow+=statsBuffs.haste[t])});var c=pV.hasteNow/375/100+1;Object.keys(statsBuffs.haste_mod).forEach(function(t){buffStatus[t]&&(c*=statsBuffs.haste_mod[t])}),pV.currHealFromHaste=(1-1/c)*f,pV.hasteNow=100*(c-1)*375,healPerStat.haste.amount+=pV.currHealFromHaste/pV.hasteNow,healPerStat.haste.total+=pV.currHealFromHaste,healPerStat.haste.avg+=pV.hasteNow,healPerStat.haste.avgCount++,Object.keys(statsBuffs.haste).forEach(function(t){buffStatus[t]&&(rV.buffs.haste[t]||(rV.buffs.haste[t]=0),rV.buffs.haste[t]+=statsBuffs.haste[t]/pV.hasteNow*pV.currHealFromHaste)}),Object.keys(statsBuffs.haste_mod).forEach(function(t){buffStatus[t]&&(rV.buffs.haste_mod[t]||(rV.buffs.haste_mod[t]=0),rV.buffs.haste_mod[t]+=100*(statsBuffs.haste_mod[t]-1)*375/pV.hasteNow*pV.currHealFromHaste)})}}for(var d=0,m=cooldownsTracking.length;d<m;d++)if(cooldownsTracking[d].opened||157153==cooldownsTracking[d].spellID&&157503==g&&l.timestamp-cooldownsTracking[d].start<=2e4){cooldownsTracking[d].healing+=f;for(var h=l.timestamp-cooldownsTracking[d].start,p=-1,u=0,v=cooldownsTracking[d].heal.length;u<v;u++){if(h==cooldownsTracking[d].heal[u].time&&g==cooldownsTracking[d].heal[u].id){p=u;break}if(h>cooldownsTracking[d].heal[u].time&&g==cooldownsTracking[d].heal[u].id&&h-cooldownsTracking[d].heal[u].time<=300){p=u;break}}-1==p&&(cooldownsTracking[d].heal.push({time:h,id:g,amount:0,over:0,count:0}),p=cooldownsTracking[d].heal.length-1),cooldownsTracking[d].heal[p].amount+=l.amount,l.overheal&&(cooldownsTracking[d].heal[p].over+=l.overheal),cooldownsTracking[d].heal[p].count++,157503==g&&157153==cooldownsTracking[d].spellID&&(cooldownsTracking[d].ended=l.timestamp,cooldownsTracking[d].opened=!1)}if(98021==g)for(var d=0,m=sltTracking.length;d<m;d++)if(l.timestamp-sltTracking[d].start<8e3){for(var h=l.timestamp-sltTracking[d].start,p=-1,u=0,v=sltTracking[d].heal.length;u<v;u++){if(h==sltTracking[d].heal[u].time){p=u;break}if(h>sltTracking[d].heal[u].time&&h-sltTracking[d].heal[u].time<=500){h=sltTracking[d].heal[u].time,p=u;break}}-1==p&&(sltTracking[d].heal.push({time:h,data:[]}),p=sltTracking[d].heal.length-1),sltTracking[d].heal[p].data[l.targetID]||(sltTracking[d].heal[p].data[l.targetID]={amount:0,absorbed:0}),sltTracking[d].heal[p].data[l.targetID].amount+=l.amount,l.absorbed&&(sltTracking[d].heal[p].data[l.targetID].absorbed+=l.absorbed),sltTracking[d].ended=l.timestamp}for(var d=0,m=parsePlugins.heal.length;d<m;d++)parsePlugins.heal[d](l,g,f)}else if("absorbed"==l.type&&actors[l.sourceID]){g=l.ability.guid;healingData[g]||(healingData[g]=[0,0]);var f=l.amount;l.absorbed&&(f+=l.absorbed),healingData[g][0]+=f,l.overheal&&(healingData[g][1]+=l.overheal),notHealingFromMana[g]||(rV.healFromMana+=f)}else if("summon"==l.type&&actors[l.sourceID])actors[l.targetID]=!0;else if("applybuff"==l.type&&actors[l.targetID]){g=l.ability.guid;(statsBuffs.vers[g]||statsBuffs.crit[g]||statsBuffs.haste[g]||statsBuffs.haste_mod[g]||statsBuffs.mastery[g]||statsBuffs.int[g])&&(buffStatus[g]=!0),29166==g&&(pV.innervate=!0),cooldownsTrackingIDs[g]&&cooldownsTracking.push({opened:!0,spellID:g,start:l.timestamp,spells:[],mana:0,heal:[],healing:0});for(var d=0,m=parsePlugins.applybuff.length;d<m;d++)parsePlugins.applybuff[d](l,g)}else if("applybuffstack"==l.type&&actors[l.targetID])for(var g=l.ability.guid,d=0,m=parsePlugins.applybuffstack.length;d<m;d++)parsePlugins.applybuffstack[d](l,g);else if("removebuff"==l.type&&actors[l.targetID]){g=l.ability.guid;if((statsBuffs.vers[g]||statsBuffs.crit[g]||statsBuffs.haste[g]||statsBuffs.haste_mod[g]||statsBuffs.mastery[g]||statsBuffs.int[g])&&(buffStatus[g]=!1),29166==g&&(pV.innervate=!1),cooldownsTrackingIDs[g])for(var d=0,m=cooldownsTracking.length;d<m;d++)cooldownsTracking[d].opened&&cooldownsTracking[d].spellID==g&&(cooldownsTracking[d].ended=l.timestamp,cooldownsTracking[d].opened=!1);for(var d=0,m=parsePlugins.removebuff.length;d<m;d++)parsePlugins.removebuff[d](l,g)}else if("removebuffstack"==l.type&&actors[l.targetID])for(var g=l.ability.guid,d=0,m=parsePlugins.removebuffstack.length;d<m;d++)parsePlugins.removebuffstack[d](l,g);else if("cast"==l.type&&actors[l.sourceID]){g=l.ability.guid;if(cooldownsTrackingIDsbyCast[g]&&cooldownsTracking.push({opened:!0,spellID:g,start:l.timestamp,end_limit:l.timestamp+cooldownsTrackingIDsbyCast[g],spells:[],mana:0,heal:[],healing:0}),spellManaCost[g]&&!pV.innervate){rV.manaUsage+=spellManaCost[g];for(var d=0,m=cooldownsTracking.length;d<m;d++)cooldownsTracking[d].opened&&(cooldownsTracking[d].mana+=spellManaCost[g])}for(var d=0,m=cooldownsTracking.length;d<m;d++)cooldownsTracking[d].opened&&!ignoredSpellsForCDTracking[g]&&cooldownsTracking[d].spells.push({spell:g,time:l.timestamp-cooldownsTracking[d].start});if(201764==g)for(var d=0,m=cooldownsTracking.length;d<m;d++)cooldownsTracking[d].opened&&157153==cooldownsTracking[d].spellID&&(cooldownsTracking[d].ended=l.timestamp,cooldownsTracking[d].opened=!1);else 98008==g&&sltTracking.push({start:l.timestamp,heal:[],damage:[]});for(var d=0,m=parsePlugins.cast.length;d<m;d++)parsePlugins.cast[d](l,g)}else if("damage"==l.type){if(98021==(g=l.ability.guid))for(var d=0,m=sltTracking.length;d<m;d++)if(l.timestamp-sltTracking[d].start<8e3){for(var h=l.timestamp-sltTracking[d].start,p=-1,u=0,v=sltTracking[d].damage.length;u<v;u++){if(h==sltTracking[d].damage[u].time){p=u;break}if(h>sltTracking[d].damage[u].time&&h-sltTracking[d].damage[u].time<=500){h=sltTracking[d].damage[u].time,p=u;break}}-1==p&&(sltTracking[d].damage.push({time:h,data:[]}),p=sltTracking[d].damage.length-1),sltTracking[d].damage[p].data[l.targetID]||(sltTracking[d].damage[p].data[l.targetID]={amount:0,absorbed:0}),sltTracking[d].damage[p].data[l.targetID].amount+=l.amount,l.absorbed&&(sltTracking[d].damage[p].data[l.targetID].absorbed+=l.absorbed),sltTracking[d].ended=l.timestamp}for(var d=0,m=parsePlugins.damage.length;d<m;d++)parsePlugins.damage[d](l,g)}else if("energize"==l.type&&l.targetID==e){if(0==l.resourceChangeType){g=l.ability.guid;rV.manaGain+=l.resourceChange;for(var d=0,m=parsePlugins.energize.length;d<m;d++)parsePlugins.energize[d](l,g)}}else if("combatantinfo"==l.type&&l.sourceID==e){if(264!=l.specID)throw error_msg("Error: Wrong specialization"),new Error("Error: Wrong specialization");console.log(l);for(var u=0,v=l.gear.length;u<v;u++){var b=l.gear[u];b.slot=u,cV.gearInfo[b.id]=b;for(var d=0,m=parsePlugins.gear.length;d<m;d++)parsePlugins.gear[d](b,b.id)}for(var u=0,v=l.artifact.length;u<v;u++){var V=l.artifact[u];cV.traitInfo[V.traitID]=V}for(var u=0,v=l.talents.length;u<v;u++){var y=l.talents[u];y.row=u+1,cV.talentInfo[y.id]=y}for(var w=0,u=0,v=l.auras.length;u<v;u++){var _=l.auras[u];vantusRunes[_.ability]&&(w=1500);for(var d=0,m=parsePlugins.applybuff.length;d<m;d++)parsePlugins.applybuff[d](l,_.ability)}cV.critSpell=l.critSpell+2e3,cV.intellect=l.intellect,cV.intellect_min=cV.intellect,cV.versatility=l.versatilityHealingDone+w,cV.vers=cV.versatility,cV.mastery=l.mastery+3200,cV.haste=l.hasteSpell,cV.gcd=1500/(cV.haste/375/100+1),cV.combantantInfo=l;for(var d=0,m=parsePlugins.combantantInfo.length;d<m;d++)parsePlugins.combantantInfo[d](l)}for(var d=0,m=cooldownsTracking.length;d<m;d++)cooldownsTracking[d].opened&&cooldownsTracking[d].end_limit&&l.timestamp>=cooldownsTracking[d].end_limit&&(cooldownsTracking[d].ended=l.timestamp,cooldownsTracking[d].opened=!1);l.ability&&!cV.spellInfo[l.ability.guid]&&(cV.spellInfo[l.ability.guid]={icon:l.ability.abilityIcon,name:l.ability.name})}if(a.nextPageTimestamp){var T=(a.nextPageTimestamp-currFightData.start_time)/(currFightData.end_time-currFightData.start_time)*100;$("#navbar-progress").width(T+"%").css("opacity","1"),ParseLog(t,e,a.nextPageTimestamp,i)}else $("#navbar-progress").width("100%").css("opacity","0"),BuildReport()})}function ParseHeader(t,e,a){$.getJSON("https://www.warcraftlogs.com:443/v1/report/fights/"+t+"?api_key="+WCL_API_KEY).done(function(t){if(400==t.status)throw error_msg(t.error),new Error("Error: Parsing Error");for(var i=0,r=t.fights.length;i<r;i++)(l=t.fights[i]).actors=[],fightsData[l.id]=l;for(var s=[t.friendlies,t.enemies,t.friendlyPets,t.enemyPets],i=0,r=s.length;i<r;i++)for(var l=s[i],n=0,o=l.length;n<o;n++){var c=l[n];actorsData[c.id]={name:c.name,class:c.type};for(var d=0,m=c.fights.length;d<m;d++)fightsData[c.fights[d].id]&&fightsData[c.fights[d].id].actors.push(c.id)}currFightData.report_name=t.title,e&&BuildFightsList(),a&&a()})}function CalcHealingFromItem(t,e){var a=0,i="Calculated stats:";if(cV.gearInfo[t]){var r=e||itemsStats[t];if(r){var s=cV.gearInfo[t].itemLevel,l=r.ilvl;Object.keys(r).forEach(function(e){var n=r[e];if("passive"==e&&cV.gearInfo[t].bonusIDs)for(var o=0,c=cV.gearInfo[t].bonusIDs.length;o<c;o++)if(itemsBonusToStats[cV.gearInfo[t].bonusIDs[o]]){e=itemsBonusToStats[cV.gearInfo[t].bonusIDs[o]];break}if(healPerStat[e]){var d=ScaleStat(n,l,s,"int"==e?1:jewelSlots[cV.gearInfo[t].slot]?2:0);i+="<br>"+e+": "+Math.round(d),"int"==e&&(d*=1.05),a+=healPerStat[e].amount*d}})}if(cV.gearInfo[t].gems)for(var n=0,o=cV.gearInfo[t].gems.length;n<o;n++){var c=cV.gearInfo[t].gems[n].id;if(gemToStat[c]){d=gemToStat[c];healPerStat[d[0]]&&(i+="<br>Gem "+d[0]+": "+Math.round(d[1]),a+=healPerStat[d[0]].amount*d[1]*("int"==d[0]?1.05:1))}}if(cV.gearInfo[t].permanentEnchant&&enchToStat[cV.gearInfo[t].permanentEnchant]){var d=enchToStat[cV.gearInfo[t].permanentEnchant];healPerStat[d[0]]&&(i+="<br>Enchant "+d[0]+": "+Math.round(d[1]),a+=healPerStat[d[0]].amount*d[1]*("int"==d[0]?1.05:1))}}return{heal:a,tip:i}}function GetItemDataFromWowhead(t){if(!IsWowheadResponceRewritten){if(!$WowheadPower||!$WowheadPower.registerItem)return!1;$WowheadPower.registerItem=function(t,e,a){if(a&&a.tooltip_enus){var i=t.match(/^(\d+)/)[1],r=$("#gear-"+i+"-text").attr("data-status"),s={},l=a.tooltip_enus.match(/ilvl-->(\d+)/);l&&(s.ilvl=l[1].replace(",","")),(l=a.tooltip_enus.match(/nstart--><b class=\"[^\"]*\">([^<]*)/))&&(s.name=l[1]),(l=a.tooltip_enus.match(/-->\+([\d,]+) (\[Agility or Intellect\]|Intellect|\[Agility or Strength or Intellect\])/))&&(s.int=l[1].replace(",","")),(l=a.tooltip_enus.match(/([\d,]+) Critical Strike/))&&(s.crit=l[1].replace(",","")),(l=a.tooltip_enus.match(/([\d,]+) Mastery/))&&(s.mastery=l[1].replace(",","")),(l=a.tooltip_enus.match(/([\d,]+) Versatility/))&&(s.vers=l[1].replace(",","")),(l=a.tooltip_enus.match(/([\d,]+) Haste/))&&(s.haste=l[1].replace(",",""));var n=CalcHealingFromItem(i,s);if($("#gear-"+i+"-name").html(s.name),"locked"!=r){$("#gear-"+i+"-text").attr("data-status","locked");var o="";n.heal>0&&(o+='From <em class="tooltip">passive stats<span class="tip-text" style="width: 120px;margin-left:-60px;">'+n.tip+"</span></em>: "+NumberToFormattedNumber(n.heal,2)+" ("+(n.heal/rV.total*100).toFixed(2)+"%)<br>"),n.heal>0&&(o+='HPS: <em class="result-hps">'+NumberToFormattedNumber(n.heal/currFightData.len*1e3,1)+"</em>"),$("#gear-"+i+"-text").html(o)}}$WowheadPower.register(3,t,e,a)},IsWowheadResponceRewritten=!0}$.getScript("http://www.wowhead.com/item="+t+"&power")}function BuildReport(){if(!cV.combantantInfo)throw error_msg("Error: Combantant info is missing."),new Error("Error: Combantant info is missing.");for(var t=0,e=pluginsList.length;t<e;t++)for(var a=pluginsList[t],i=0,r=a.length;i<r;i++)a[i].afterParse&&a[i].afterParse();rV.total=0,Object.keys(healingData).forEach(function(t){98021!=t&&(rV.total+=healingData[t][0])}),console.log(rV);var s="",l=currFightData.start_time,n=currFightData.end_time,o=n-l;s+='<div class="panel" style="margin-top:-10px;"><div class="row full" style="margin-bottom:5px;">';var c=Math.round(rV.total/o*1e3);s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col" style="width:25%"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingwavegreater.jpg"></div><div class="col" style="width:75%">Healing Done: '+NumberToFormattedNumber(rV.total)+"<br>HPS: "+NumberToFormattedNumber(c,0,3)+"</div></div></div></div>",s+='<div class="col"><div class="box small-box clearfix"><div class="row"><div class="col" style="width:25%"><img src="http://media.blizzard.com/wow/icons/56/spell_nature_healingtouch.jpg"></div><div class="col" style="width:75%">Mastery healing Done:<br>'+NumberToFormattedNumber(Math.round(healPerStat.mastery.total),1)+" ("+Math.round(healPerStat.mastery.total/healPerStat.mastery.all*100)+"%)</div></div></div></div>",s+="</div></div>",s+='<div class="panel">';var d=Object.keys(healingData);d.sort(function(t,e){return healingData[t][0]>healingData[e][0]?-1:1}),s+='<div class="col-half"><div class="box clearfix spellslist">';for(var m=0,h=d.length;m<h;m++){var p=d[m],u=cV.spellInfo[p];s+='<div class="row full"><div class="line" style="width:50%"><a href="http://www.wowhead.com/spell='+p+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+u.icon+'" alt="'+u.name+'">'+u.name+'</a></div><div class="line t-right" style="width:15%">'+NumberToFormattedNumber(healingData[p][0],1)+'</div><div class="line t-right t-grey" style="width:15%">'+NumberToFormattedNumber(healingData[p][1],1)+"</div></div>"}s+="</div></div>",s+='<div class="col-half"><div class="box clearfix statlist"><header class="box-header" style="padding-bottom:0;padding-top:0">Stats</header>';var v=[["int","Int","From gear: "+cV.intellect_min],["crit","Crit","From gear: "+(cV.critSpell-2e3)+"<br>Base value: 2000"],["mastery","Mastery","From gear: "+(cV.mastery-3200)+"<br>Base value: 3200"],["vers","Vers","From gear: "+cV.$versatility],["haste",'<em class="tooltip">Haste<span class="tip-text" style="width: 300px;margin-left:-150px;">Cast time not counted here, only profit from ticks</span></em>',"From gear: "+cV.haste]];s+='<div class="row full"><div class="col size"> </div><div class="col size">Heal per stat</div><div class="col size">Stat weight</div><div class="col size">Total from stat</div><div class="col size">Avg on fight</div></div>';for(var m=0,h=v.length;m<h;m++){var f=v[m];s+='<div class="row full"><div class="col size">'+f[1]+'</div><div class="col size">'+healPerStat[f[0]].amount+'</div><div class="col size">'+healPerStat[f[0]].amount/o*1e3+'</div><div class="col size">'+NumberToFormattedNumber(healPerStat[f[0]].total)+'</div><div class="col size"><em class="tooltip">'+(healPerStat[f[0]].avg/healPerStat[f[0]].avgCount).toFixed(0)+'<span class="tip-text" style="width: 120px;margin-left:-60px;">'+f[2]+"</span></em></div></div>"}s+='<div class="row full"><div class="col size">Mana</div><div class="col size"><em class="tooltip">'+rV.healFromMana/rV.manaUsage*1e3+'<span class="tip-text" style="width: 200px;margin-left:-100px;">Healing per 1000 mana points</span></em></div><div class="col size"> </div><div class="col size">'+NumberToFormattedNumber(rV.healFromMana)+'</div><div class="col size"><em class="tooltip">'+rV.manaUsage.toFixed(0)+'<span class="tip-text" style="width: 350px;margin-left:-175px;">Mana gained via passives & buffs: '+rV.manaGain.toFixed(0)+"<br>Mana regened: "+(o/1e3*8800).toFixed(0)+"<br>Base manapull: "+11e5.toFixed(0)+"</span></em></div></div>",s+="</div></div>",s+='<div class="col-half"><div class="box clearfix predictionlist"><header class="box-header" style="padding-bottom:0;padding-top:0">Items predictions</header>';for(var i=0,r=ITEMS.length;i<r;i++)if(ITEMS[i].obj.prediction&&(!ITEMS[i].obj.predictionСondition||ITEMS[i].obj.predictionСondition())){var g=ITEMS[i].obj;s+='<div class="row full"><div class="col s-1"><a href="http://www.wowhead.com/'+g.type+"="+g.id+'" target="_blank" style="color: #'+qualityColors[g.quality]+';">'+g.name+'</a></div><div class="col s-2">'+NumberToFormattedNumber(rV[g.prediction],2)+'</div><div class="col s-2">'+(rV[g.prediction]/rV.total*100).toFixed(2)+"%"+(g.text?"<br>"+g.text():"")+"</div></div>"}s+="</div></div>",s+="</div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">ITEMS ',s+='<sup class="tooltip" style="font-size: 0.4em"> [supported items]<span class="tip-text" style="width: 400px;margin-left:-200px;">';for(var b=!1,i=0,r=ITEMS.length;i<r;i++)ITEMS[i].obj.gear&&(b&&(s+=", "),s+=ITEMS[i].obj.name,b=!0);s+='</span></sup></header><div class="list-top-line"> </div><ul class="list">',b=0;for(var V=[],i=0,r=ITEMS.length;i<r;i++)(z=ITEMS[i].obj).gear&&(!z.gearFunc&&cV.gearInfo[z.id]||z.gearFunc&&z.gearFunc())&&V.push([z.gear,ITEMS[i]]);V.sort(function(t,e){return rV[t[0]]>rV[e[0]]?-1:1});for(var i=0,r=V.length;i<r;i++){_=(z=V[i][1].obj).id;b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/'+z.type+"="+_+(cV.gearInfo[_]&&cV.gearInfo[_].bonusIDs?"&bonus="+cV.gearInfo[_].bonusIDs.join(":"):"")+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+(z.icon?z.icon:cV.gearInfo[_].icon)+'" alt="'+z.name+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header style="color: #'+qualityColors[z.quality]+';">'+z.name+"</header>",(S=rV[z.gear])>0&&(s+='<em class="result">'+NumberToFormattedNumber(S,2)+"</em> ("+(S/rV.total*100).toFixed(2)+"%)<br>"),(T=CalcHealingFromItem(_)).heal>0&&(s+="From passive stats: "+NumberToFormattedNumber(T.heal,2)+" ("+(T.heal/rV.total*100).toFixed(2)+"%)<br>"),s+='HPS: <em class="result-hps">',S>0&&(s+=NumberToFormattedNumber(S/o*1e3,1)),T.heal>0&&(s+=(S>0?" / ":"")+NumberToFormattedNumber(T.heal/o*1e3,1)),s+="</em>",z.gearAdditionalText&&(s+="<br>"+z.gearAdditionalText()),s+="</div></div>",b++}s+="</ul></div></div></div>";var y=[];s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">GEAR</header><div class="list-top-line"> </div><ul class="list">',b=0;for(var i=0,r=cV.combantantInfo.gear.length;i<r;i++){var w=cV.combantantInfo.gear[i];if(0!=w.id){var _=w.id;b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%" id="gear-'+_+'"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/item='+_+(w&&w.bonusIDs?"&bonus="+w.bonusIDs.join(":"):"")+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+w.icon+'" alt="'+w.icon+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header style="color: #'+qualityColors[w.quality]+';" id="gear-'+_+'-name">'+w.itemLevel+"</header>";var T=CalcHealingFromItem(_);s+='<div class="row-gear full" id="gear-'+_+'-text" data-status="'+(T.heal>0?"locked":"unlocked")+'">',T.heal>0&&(s+='From <em class="tooltip">passive stats<span class="tip-text" style="width: 120px;margin-left:-60px;">'+T.tip+"</span></em>: "+NumberToFormattedNumber(T.heal,2)+" ("+(T.heal/rV.total*100).toFixed(2)+"%)<br>"),T.heal>0&&(s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(T.heal/o*1e3,1)+"</em>"),s+="</div></div></div>",b++,y.push(_)}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">TRAITS</header><div class="list-top-line"> </div><ul class="list traits">',b=0;for(var k=[],i=0,r=TRAITS.length;i<r;i++)GetTraitRank(TRAITS[i].obj.id)>0&&k.push([TRAITS[i].obj.id,TRAITS[i]]);k.sort(function(t,e){return rV.traits[t[0]]>rV.traits[e[0]]?-1:1});for(var i=0,r=k.length;i<r;i++){var I=k[i][1].obj,P=GetTraitRank(I.id);if(P>0){b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+I.spellID+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+I.icon+'" alt="'+I.name+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header><a href="http://www.wowhead.com/spell='+I.spellID+'" target="_blank">'+I.name+"</a>"+(P>1?" [Rank "+P+"]":"")+"</header>";S=rV.traits[I.id];s+='<em class="result">'+NumberToFormattedNumber(S,2)+"</em> ("+(S/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(S/o*1e3,1)+"</em>",I.additionalText?s+="<br>"+I.additionalText():P>1&&(s+="<br>Per rank: "+NumberToFormattedNumber(S/P,0,2)+" ("+(S/P/rV.total*100).toFixed(2)+"%)"),s+="</div></div>",b++}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">TALENTS</header><div class="list-top-line"> </div><ul class="list talents">',b=0;for(var x=[],i=0,r=TALENTS.length;i<r;i++)cV.talentInfo[TALENTS[i].obj.id]&&x.push([TALENTS[i].obj.id,TALENTS[i],cV.talentInfo[TALENTS[i].obj.id].row]);x.sort(function(t,e){return t[2]<e[2]?-1:1});for(var i=0,r=x.length;i<r;i++){var D=x[i][1].obj;b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+D.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.talentInfo[D.id].icon+'" alt="'+D.name+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header>'+D.name+"</header>";S=rV.talents[D.id];s+='<em class="result">'+NumberToFormattedNumber(S,2)+"</em> ("+(S/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(S/o*1e3,1)+"</em>",D.additionalText&&(s+="<br>"+D.additionalText()),s+="</div></div>",b++}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">RESURGENCE</header><div class="list-top-line"> </div><ul class="list resurgence">',b=0;for(var N=[],i=0,r=RESURGENCE.length;i<r;i++)rV.resurgence[RESURGENCE[i].obj.id][0]>0&&N.push([RESURGENCE[i].obj.id,RESURGENCE[i]]);N.sort(function(t,e){return rV.resurgence[t[0]][0]>rV.resurgence[e[0]][0]?-1:1});for(var i=0,r=N.length;i<r;i++){z=N[i][1].obj;b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+z.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+z.icon+'" alt="'+z.name+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header><a href="http://www.wowhead.com/spell='+z.id+'" target="_blank">'+z.name+"</a></header>";S=rV.resurgence[z.id][0];s+='Mana gained: <em class="result">'+NumberToFormattedNumber(S,0,2)+"</em> ("+(S/rV.total*100).toFixed(2)+"%)<br>",s+="Count: "+rV.resurgence[z.id][1],s+="</div></div>",b++}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">POTIONS</header><div class="list-top-line"> </div><ul class="list potions">',b=0;for(var i=0,r=POTIONS.length;i<r;i++){var F=POTIONS[i].obj;if(rV.potions[F.id]>0){if(b%3==0&&(s+='<li class="item clearfix" style="padding: 1em;">'),s+='<div class="row" style="width:33.3%"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+F.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+F.icon+'" alt="'+F.name+'" style="height: 56px; border-radius: 50%;"></a></div>',s+='<div class="col div_more_1" style="width:80%"><header><a href="http://www.wowhead.com/spell='+F.id+'" target="_blank">'+F.name+"</a></header>",F.text)s+=F.text();else{var S=rV.potions[F.id];s+='<em class="result">'+NumberToFormattedNumber(S,2)+"</em> ("+(S/rV.total*100).toFixed(2)+"%)<br>",s+='HPS: <em class="result-hps">'+NumberToFormattedNumber(S/o*1e3,1)+"</em>"}s+="</div></div>",b++}}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box clearfix"><header class="box-header">PROCS</header><div class="list-top-line" style="margin-bottom:10px;"> </div>',b=0;var j=[];Object.keys(rV.buffs).forEach(function(t){Object.keys(rV.buffs[t]).forEach(function(e){for(var a=-1,i=0,r=j.length;i<r;i++)if(j[i][0]==e){a=i;break}-1==a&&(j.push([e,0,[]]),a=j.length-1),j[a][1]+=rV.buffs[t][e],j[a][2].push(("haste_mod"==t?"haste":t)+": "+NumberToFormattedNumber(rV.buffs[t][e],0,2))})}),j.sort(function(t,e){return t[1]>e[1]?-1:1});for(var i=0,r=j.length;i<r;i++){p=j[i][0];s+='<div class="row" style="width:50%"><div class="col" style="width:40%"><a href="http://www.wowhead.com/spell='+p+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[p].icon+'" alt="'+cV.spellInfo[p].name+'" style="height: 23px; margin-right: 4px;"> '+cV.spellInfo[p].name+'</a></div><div class="col" style="width:30%"><em class="tooltip">'+NumberToFormattedNumber(j[i][1],0,2)+'<span class="tip-text" style="width: 120px;margin-left:-60px;">'+j[i][2].join("<br>")+'</span></em></div><div class="col" style="width:30%">'+(j[i][1]/rV.total*100).toFixed(2)+"%</div></div>"}s+="</div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">COOLDOWN USAGES</header><div class="list-top-line"> </div><ul class="list">';for(var i=0,r=cooldownsTracking.length;i<r;i++){p=(z=cooldownsTracking[i]).spellID;s+='<li class="item clearfix" style="padding: 1em;"><div class="row full"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+p+'"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[p].icon+'" alt="'+cV.spellInfo[p].name+'" style="height: 56px;    border-radius: 50%;"></a></div>',s+='<div class="col half">',s+='<header class="cd_header"><a href="http://www.wowhead.com/spell='+p+'">'+cV.spellInfo[p].name+"</a> ("+MsToFormattedTime(z.start-l)+" -> "+MsToFormattedTime((z.ended?z.ended:n)-l)+"):</header>",s+='<div class="col full div_more_1">';for(var m=0,h=z.spells.length;m<h;m++){M=z.spells[m].spell;s+='<a href="http://www.wowhead.com/spell='+M+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[M].icon+'" alt="'+cV.spellInfo[M].name+'" style="height: 23px; margin-right: 4px;"></a>'}s+='<br><a href="javascript:void(0)" class="more_1">more</a></div>',s+='<div class="col full div_more_2" style="display:none;">';for(var m=0,h=z.spells.length;m<h;m++){M=z.spells[m].spell;s+='<div class="row full"><div class="cd_more_2_time">'+(z.spells[m].time/1e3).toFixed(3)+'</div><div class="cd_more_2_info">',s+='<a href="http://www.wowhead.com/spell='+M+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[M].icon+'" alt="'+cV.spellInfo[M].name+'" style="height: 23px; vertical-align: middle;margin-right: 4px;"> '+cV.spellInfo[M].name+"</a></div></div>"}s+='<br><a href="javascript:void(0)" class="more_2">even more</a></div>',s+='<div class="col full div_more_3" style="display:none;">';for(var C=0,m=0,h=z.spells.length;m<h;m++){var M=z.spells[m].spell;s+='<div class="row" style="width:100%"><div class="cd_more_3_time">'+(z.spells[m].time/1e3).toFixed(3)+'</div><div class="cd_more_3_info">',s+='<a href="http://www.wowhead.com/spell='+M+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[M].icon+'" alt="'+cV.spellInfo[M].name+'" style="height: 23px; vertical-align: middle;margin-right: 4px;"> '+cV.spellInfo[M].name+"</a></div></div>";for(var E=z.spells[m+1]?z.spells[m+1].time:n,t=C,e=z.heal.length;t<e&&!(z.heal[t].time>=E);t++){var A=z.heal[t];s+='<div class="row" style="width:100%"><div class="cd_more_3_time">'+(A.time/1e3).toFixed(3)+'</div><div class="cd_more_3_info cd_more_3_info_heal">',s+='<a href="http://www.wowhead.com/spell='+A.id+'" target="_blank"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[A.id].icon+'" alt="'+cV.spellInfo[A.id].name+'" style="height: 23px; vertical-align: middle;margin-right: 4px;"> '+cV.spellInfo[A.id].name+"</a> x"+A.count,s+='</div><div class="cd_more_3_info cd_more_3_info_amount">'+A.amount+'</div><div class="cd_more_3_info cd_more_3_info_over">'+A.over+"</div></div>",C=t+1}}s+='<br><a href="javascript:void(0)" class="more_3">hide</a></div></div>',s+='<div class="col text-center" style="width:20%"><div style="font-size: 2em;">'+NumberToFormattedNumber(z.healing,2)+"</div>HPS: "+NumberToFormattedNumber(z.healing/((z.ended?z.ended:n)-z.start)*1e3,2)+"</div>",s+='<div class="col text-center" style="width:20%"><div style="font-size: 2em;">'+NumberToFormattedNumber(z.mana)+"</div>Mana</div></div></li>"}s+="</ul></div></div></div>",s+='<div class="panel"><div class="col-full"><div class="box"><header class="box-header">SPIRIT LINK</header><div class="list-top-line"> </div><ul class="list">';for(var i=0,r=sltTracking.length;i<r;i++){var z=sltTracking[i];s+='<li class="item clearfix" style="padding: 1em;"><div class="row full"><div class="col" style="width:70px">',s+='<a href="http://www.wowhead.com/spell='+(p=98021)+'"><img src="http://media.blizzard.com/wow/icons/56/'+cV.spellInfo[p].icon+'" alt="'+cV.spellInfo[p].name+'" style="height: 56px;    border-radius: 50%;"></a></div>',s+='<div class="col half">',s+='<header class="cd_header"><a href="http://www.wowhead.com/spell='+p+'">'+cV.spellInfo[p].name+"</a> ("+MsToFormattedTime(z.start-l)+" -> "+MsToFormattedTime((z.ended?z.ended:n)-l)+"):</header>",s+='<div class="col full div_more_2"><a href="javascript:void(0)" class="more_2">expand</a></div>',s+='<div class="col full div_more_3" style="display:none;">';for(var H=0,C=0,R=-1,m=0,h=z.damage.length;m<h;m++){Object.keys(z.damage[m].data).forEach(function(t){var e=actorsData[t];e&&(s+='<div class="row full"><div class="cd_more_3_time">'+(R<z.damage[m].time?(z.damage[m].time/1e3).toFixed(3):"")+'</div><div class="cd_more_3_info cd_more_3_info_heal'+(e.class?" "+e.class:"")+'">',s+=e.name+'</div><div class="cd_more_3_info cd_more_3_info_amount slt-damage">'+z.damage[m].data[t].amount+"</div>",z.damage[m].data[t].absorbed>0&&(s+='<div class="cd_more_3_info cd_more_3_info_over">'+z.damage[m].data[t].absorbed+"</div>"),s+="</div>",R=z.damage[m].time)});for(var E=z.damage[m+1]?z.damage[m+1].time:n,t=C,e=z.heal.length;t<e&&!(z.heal[t].time>=E);t++)Object.keys(z.heal[t].data).forEach(function(e){var a=actorsData[e];a&&(s+='<div class="row full"><div class="cd_more_3_time">'+(R<z.heal[t].time?(z.heal[t].time/1e3).toFixed(3):"")+'</div><div class="cd_more_3_info cd_more_3_info_heal'+(a.class?" "+a.class:"")+'">',s+=a.name+'</div><div class="cd_more_3_info cd_more_3_info_amount slt-heal">'+z.heal[t].data[e].amount+"</div>",z.heal[t].data[e].absorbed>0&&(s+='<div class="cd_more_3_info cd_more_3_info_over">'+z.heal[t].data[e].absorbed+"</div>"),s+="</div>",R=z.heal[m].time,H+=z.heal[t].data[e].amount)}),C=t+1}s+='<br><a href="javascript:void(0)" class="more_3-2">hide</a></div></div>',s+='<div class="col text-center" style="width:20%"><div style="font-size: 2em;">'+NumberToFormattedNumber(H,2)+"</div>HPS: "+NumberToFormattedNumber(H/((z.ended?z.ended:n)-z.start)*1e3,2)+"</div></div></li>"}s+="</ul></div></div></div>",$("#main").html(s),$("a.more_1").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_2").show(),!1}),$("a.more_2").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_3").show(),!1}),$("a.more_3").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_1").show(),!1}),$("a.more_3-2").click(function(){return $(this).parent().hide(),$(this).parent().parent().find(".div_more_2").show(),!1});for(var i=0,r=y.length;i<r;i++)GetItemDataFromWowhead(y[i])}function BuildFightsList(){t="";t+='<div class="panel"><div class="col-full"><div class="box"><ul class="list fightslist">',Object.keys(fightsData).forEach(function(e){var a=fightsData[e];if(a.actors&&a.boss&&diffIdToName[a.difficulty])for(var i=0,r=a.actors.length;i<r;i++)"Shaman"==actorsData[a.actors[i]].class&&(t+='<a href="javascript:void(0)" data-fight="'+e+'" data-actor="'+a.actors[i]+'" class="fightlist-btn">',t+='<li class="item clearfix" style="padding: 5px 15px;"><div class="row full"><div class="col" style="width:30%">',t+=diffIdToName[a.difficulty]+" "+a.name+' <em class="'+(a.kill?"kill":"wipe")+'">'+(a.kill?"kill":"wipe")+"</em></div>",t+='<div class="col" style="width:5%">'+MsToFormattedTime(a.end_time-a.start_time)+'</div><div class="col" style="width:20%">'+actorsData[a.actors[i]].name+"</div></div>",t+="</li></a>")}),t+="</ul></div></div></div>",$("#main").html(t),$(".fightlist-btn").click(function(t){var e=$(this).attr("data-fight");fightsData[e]&&PrepParse(e,$(this).attr("data-actor"))});var t="";t+='<li class="breadcrumb-item"><a href="javascript:void(0)" id="nav-btn-main">Resto Analyzer</a></li>',t+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+'" target="_blank">Report</a></li>',$("#navbar-header").html(t),$("#nav-btn-main").click(function(){BuildMainPage()}),$("#navbar-progress").width("0%").css("opacity","0"),window.history.pushState("report","Report","?report="+reportFightCode)}function PrepParse(t,e){$("#navbar-progress").width("1%").css("opacity","1");var a=fightsData[t];currFightData.start_time=a.start_time,currFightData.end_time=a.end_time,currFightData.actor=e,currFightData.id=t,currFightData.name=diffIdToName[a.difficulty]+" "+a.name+(a.kill?" - Kill":""),currFightData.actorName=actorsData[e].name,currFightData.len=a.end_time-a.start_time,actors=[],healingData=[],pV={},rV={talents:[],traits:[],resurgence:[],potions:[],buffs:{vers:[],crit:[],haste:[],haste_mod:[],mastery:[],int:[]},healFromMana:0,manaUsage:0,manaGain:0},cV={traitInfo:[],gearInfo:[],talentInfo:[],spellInfo:[]},currHP=[],healPerStat={int:{amount:0,total:0,avg:0,avgCount:0},crit:{amount:0,total:0,avg:0,avgCount:0},haste:{amount:0,total:0,avg:0,avgCount:0},mastery:{amount:0,total:0,avg:0,avgCount:0,all:0},vers:{amount:0,total:0,avg:0,avgCount:0}},cooldownsTracking=[],sltTracking=[];for(var i=0,r=pluginsList.length;i<r;i++)for(var s=pluginsList[i],l=0,n=s.length;l<n;l++)s[l].init&&s[l].init();var o="";o+='<li class="breadcrumb-item"><a href="javascript:void(0)" id="nav-btn-main">Resto Analyzer</a></li>',o+='<li class="breadcrumb-item"><a href="javascript:void(0)" id="nav-btn-fights">'+currFightData.report_name+"</a></li>",o+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+'&type=summary" target="_blank">'+currFightData.name+" ("+MsToFormattedTime(currFightData.end_time-currFightData.start_time)+")</a></li>",o+='<li class="breadcrumb-item"><a href="https://www.warcraftlogs.com/reports/'+reportFightCode+"#fight="+currFightData.id+"&type=healing&source="+currFightData.actor+'" target="_blank">'+currFightData.actorName+"</a></li>",$("#navbar-header").html(o),$("#nav-btn-main").click(function(){BuildMainPage()}),$("#nav-btn-fights").click(function(){BuildFightsList()}),$("#main").html(""),window.history.pushState("result","Result","?report="+reportFightCode+"&fight="+t+"&actor="+e),ParseLog(reportFightCode,e,currFightData.start_time,currFightData.end_time)}function BuildMainPage(){t="";t+='<div class="panel"><div class="col-full"><div class="box" style="font-size: 14px;padding-left:20px;padding-bottom:20px">',t+='<header class="box-header">ANALYZE REPORT</header>',t+='<form id="mainpage-form"><b>Enter your Warcraft Logs report code.</b><br>https://www.warcraftlogs.com/reports/<input type="text" id="mainpage-input" size="30" class="form-control">/<br>',t+='<input type="submit" value="Analyze" class="form-btn" id="mainpage-btn"></form></div></div></div>',$("#main").html(t),$("#mainpage-form").submit(function(t){t.preventDefault()}),$("#mainpage-btn").click(function(){ParseHeader(reportFightCode=$("#mainpage-input").val(),!0)});var t="";t+='<li class="breadcrumb-item"><a href="javascript:void(0)" id="nav-btn-main">Resto Analyzer</a></li>',$("#navbar-header").html(t),$("#nav-btn-main").click(function(){BuildMainPage()}),window.history.pushState("main","Main","?")}function QueryString(){for(var t={},e=window.location.search.substring(1).split("&"),a=0;a<e.length;a++){var i=e[a].split("=");if(void 0===t[i[0]])t[i[0]]=decodeURIComponent(i[1]);else if("string"==typeof t[i[0]]){var r=[t[i[0]],decodeURIComponent(i[1])];t[i[0]]=r}else t[i[0]].push(decodeURIComponent(i[1]))}return t}for(var itemsStats={140803:{ilvl:875,int:1634},140793:{ilvl:870,mastery:1055},142507:{ilvl:865,int:1489,passive:1036},144258:{ilvl:940,int:2994,crit:456,mastery:456,haste:456},134526:{ilvl:825,crit:1062,mastery:797},141482:{ilvl:860,crit:847,mastery:847,vers:847,haste:847},137051:{ilvl:940,crit:2404,haste:1335},128911:{ilvl:825,int:6339,crit:271,mastery:260},128934:{ilvl:825,int:606,crit:356,mastery:342},132466:{ilvl:940,int:3150,crit:658,mastery:685,haste:1234},132452:{ilvl:940,crit:2671,haste:1818},139114:{ilvl:865,int:1489,passive:1036},142428:{ilvl:855,vers:1404,mastery:829},142412:{ilvl:855,int:803,crit:544,vers:241},142540:{ilvl:855,int:803,haste:325,vers:460},142521:{ilvl:855,int:803,haste:510,mastery:275},142432:{ilvl:855,int:1427,haste:579,vers:818},142410:{ilvl:855,int:1427,crit:579,haste:818},142431:{ilvl:855,int:1427,haste:579,vers:818},142433:{ilvl:855,int:1427,haste:459,mastery:938},142423:{ilvl:855,int:803,haste:325,mastery:460},142419:{ilvl:855,int:803,crit:527,vers:258},142415:{ilvl:855,int:803,vers:309,mastery:477},142427:{ilvl:855,int:803,haste:510,vers:275},142435:{ilvl:855,int:1070,crit:658,mastery:389},142434:{ilvl:855,int:1070,crit:434,haste:613},142430:{ilvl:855,int:1070,crit:411,mastery:635},142429:{ilvl:855,int:1070,crit:680,vers:366},142411:{ilvl:855,int:1070,haste:299,mastery:748},142420:{ilvl:855,int:1070,crit:680,vers:366},142416:{ilvl:855,int:1070,haste:613,mastery:434},142424:{ilvl:855,int:1070,haste:411,mastery:635},142421:{ilvl:855,int:1427,crit:968,haste:428},142413:{ilvl:855,int:1427,crit:968,haste:428},142425:{ilvl:855,int:1427,crit:459,mastery:938},142418:{ilvl:855,int:1427,vers:518,mastery:878},142422:{ilvl:855,int:1070,vers:658,mastery:389},142417:{ilvl:855,int:1070,crit:680,haste:366},142426:{ilvl:855,int:1070,crit:321,haste:725},142414:{ilvl:855,int:1070,haste:725,mastery:321},142520:{ilvl:855,crit:1021,haste:1212},140870:{ilvl:875,int:1719,crit:1042,mastery:462},138357:{ilvl:875,haste:1075,mastery:430},138314:{ilvl:875,int:1719,haste:978,vers:527},138330:{ilvl:875,int:1719,crit:914,mastery:591},140866:{ilvl:875,int:1719,vers:849,mastery:656},138312:{ilvl:875,int:1719,haste:1042,mastery:462},138331:{ilvl:875,int:1719,crit:1042,vers:462},140851:{ilvl:870,int:1641,crit:865,haste:612},140903:{ilvl:870,int:1641,haste:897,vers:580},140881:{ilvl:875,int:1719,crit:914,mastery:591},138342:{ilvl:875,haste:623,mastery:881},138332:{ilvl:875,crit:559,mastery:946},138355:{ilvl:875,vers:527,mastery:978},138378:{ilvl:875,int:1719,crit:527,haste:978},138356:{ilvl:875,int:1719,crit:462,haste:1042},140901:{ilvl:870,int:1641,haste:485,mastery:991},138313:{ilvl:875,int:1719,crit:527,mastery:978},138343:{ilvl:875,int:1719,crit:527,haste:978},140900:{ilvl:875,haste:1151,vers:1368},140899:{ilvl:875,crit:1440,mastery:1080},140894:{ilvl:870,vers:908,mastery:1537},140898:{ilvl:870,crit:768,haste:1677},140853:{ilvl:870,int:1231,crit:744,mastery:364},138347:{ilvl:875,crit:443,vers:685},138363:{ilvl:875,vers:492,mastery:636},140883:{ilvl:875,int:1289,crit:733,mastery:394},138361:{ilvl:875,crit:346,haste:782},138380:{ilvl:875,int:1289,haste:346,vers:782},138323:{ilvl:875,int:1289,vers:443,mastery:685},138362:{ilvl:875,int:1289,haste:443,vers:685},140872:{ilvl:870,int:1231,crit:673,mastery:435},138337:{ilvl:875,int:1289,vers:419,mastery:709},138338:{ilvl:875,crit:758,haste:371},138348:{ilvl:875,int:1289,haste:636,vers:492},138336:{ilvl:875,int:1289,haste:733,mastery:394},138321:{ilvl:875,int:1289,haste:782,vers:346},138322:{ilvl:875,int:1289,haste:733,mastery:394},140911:{ilvl:875,int:1289,crit:443,vers:685},140864:{ilvl:875,int:1289,crit:492,mastery:636},140917:{ilvl:880,int:1351,haste:328,mastery:822},140855:{ilvl:875,int:967,crit:459,vers:386},138375:{ilvl:875,int:967,crit:550,mastery:296},138370:{ilvl:875,int:967,vers:550,mastery:296},138373:{ilvl:875,int:967,haste:314,vers:532},138366:{ilvl:875,int:967,haste:242,vers:604},138369:{ilvl:875,int:967,haste:604,mastery:242},138365:{ilvl:875,int:967,crit:513,mastery:332},138367:{ilvl:875,int:967,crit:550,haste:296},138368:{ilvl:875,int:967,vers:259,mastery:586},138372:{ilvl:875,int:967,haste:314,mastery:532},140910:{ilvl:875,int:967,haste:278,mastery:568},138371:{ilvl:875,int:967,vers:568,mastery:278},140909:{ilvl:875,int:967,haste:604,vers:242},138374:{ilvl:875,int:967,haste:278,vers:568},138364:{ilvl:875,int:967,vers:278,mastery:568},138351:{ilvl:875,crit:1042,vers:462},140877:{ilvl:875,int:1719,haste:623,vers:881},138350:{ilvl:875,int:1719,crit:591,mastery:914},140913:{ilvl:880,int:1801,haste:997,mastery:536},138349:{ilvl:875,crit:430,haste:1075},140865:{ilvl:870,int:1641,crit:644,haste:833},138325:{ilvl:875,int:1719,haste:1075,mastery:430},138339:{ilvl:875,haste:1075,vers:430},138326:{ilvl:875,haste:623,mastery:881},138376:{ilvl:875,int:1719,crit:978,vers:527},138346:{ilvl:875,int:1719,crit:1042,mastery:462},138324:{ilvl:875,int:1719,vers:462,mastery:1042},138318:{ilvl:875,int:1719,vers:559,mastery:946},140848:{ilvl:870,int:1641,haste:1023,mastery:454},138319:{ilvl:875,int:1719,crit:914,haste:591},138320:{ilvl:875,int:1719,crit:559,mastery:946},140875:{ilvl:870,int:1641,haste:516,mastery:960},140874:{ilvl:875,int:967,crit:568,mastery:278},140878:{ilvl:875,int:967,crit:568,mastery:278},140893:{ilvl:875,int:967,crit:314,haste:532},140876:{ilvl:870,int:923,vers:487,mastery:344},140886:{ilvl:875,int:967,haste:586,vers:259},140889:{ilvl:875,int:967,crit:604,mastery:242},140850:{ilvl:875,int:967,crit:314,mastery:532},140902:{ilvl:870,int:923,vers:344,mastery:487},140857:{ilvl:875,int:967,haste:550,mastery:296},140869:{ilvl:870,int:1231,haste:720,mastery:387},140863:{ilvl:870,int:1231,haste:411,mastery:696},138327:{ilvl:875,int:1289,crit:758,vers:371},138309:{ilvl:875,int:1289,crit:467,vers:661},140905:{ilvl:875,int:1289,crit:467,mastery:661},138328:{ilvl:875,int:1289,haste:443,vers:685},138310:{ilvl:875,int:1289,crit:782,vers:346},140888:{ilvl:870,int:1231,haste:387,mastery:720},138377:{ilvl:875,int:1289,haste:782,mastery:346},138353:{ilvl:875,int:1289,vers:394,mastery:733},138354:{ilvl:875,crit:467,mastery:661},138340:{ilvl:875,crit:685,haste:443},140907:{ilvl:875,int:1289,crit:346,haste:782},140879:{ilvl:870,int:1231,haste:506,mastery:601},138329:{ilvl:875,haste:806,vers:322},138341:{ilvl:875,int:1289,crit:492,vers:636},138352:{ilvl:875,vers:709,mastery:419},138311:{ilvl:875,int:1289,crit:782,mastery:346},140880:{ilvl:870,int:1231,crit:459,mastery:648},140887:{ilvl:875,int:1289,haste:636,mastery:492},140912:{ilvl:875,int:1289,crit:733,vers:394},140919:{ilvl:880,int:1351,crit:501,mastery:649},140892:{ilvl:875,int:1289,haste:346,vers:782},140890:{ilvl:875,int:1289,crit:515,vers:612},140858:{ilvl:870,int:1231,crit:696,haste:411},140868:{ilvl:875,int:1289,haste:661,mastery:467},140859:{ilvl:875,int:1289,haste:733,vers:394},140849:{ilvl:870,int:1231,haste:364,vers:744},138379:{ilvl:875,int:1719,vers:591,mastery:914},140908:{ilvl:875,int:1719,haste:656,vers:849},140882:{ilvl:870,int:1641,haste:454,mastery:1023},140871:{ilvl:870,int:1641,crit:454,haste:1023},138359:{ilvl:875,int:1719,crit:978,vers:527},138360:{ilvl:875,crit:623,haste:881},138358:{ilvl:875,crit:914,haste:591},140862:{ilvl:870,int:1641,haste:929,mastery:548},138317:{ilvl:875,int:1719,crit:849,haste:656},138333:{ilvl:875,int:1719,crit:494,haste:1010},138315:{ilvl:875,int:1719,crit:978,haste:527},138334:{ilvl:875,int:1719,crit:462,mastery:1042},140852:{ilvl:875,int:1719,haste:688,mastery:817},138344:{ilvl:875,crit:946,mastery:559},138316:{ilvl:875,int:1719,haste:946,vers:559},138345:{ilvl:875,int:1719,vers:623,mastery:881},138335:{ilvl:875,crit:1042,vers:462},140891:{ilvl:875,int:1289,haste:782,mastery:346},140867:{ilvl:875,int:1289,vers:443,mastery:685},140904:{ilvl:870,int:1231,crit:387,vers:720},140885:{ilvl:875,int:1289,crit:419,vers:709},140860:{ilvl:870,int:1231,haste:744,vers:364},140854:{ilvl:870,int:1231,haste:506,mastery:601},140861:{ilvl:875,int:1289,crit:492,mastery:636},140914:{ilvl:880,int:1351,crit:772,mastery:378},140884:{ilvl:870,int:1231,crit:673,haste:435},140873:{ilvl:875,int:1289,crit:515,haste:612},140895:{ilvl:875,crit:1728,mastery:792},140896:{ilvl:875,haste:1512,vers:1008},140906:{ilvl:875,crit:864,vers:1656},140897:{ilvl:880,haste:742,mastery:1856},140800:{ilvl:875,haste:1075},140804:{ilvl:875,int:1634},140795:{ilvl:875,haste:1075},140798:{ilvl:875,crit:1075},140793:{ilvl:870,mastery:1055},140807:{ilvl:880,mastery:1095},140808:{ilvl:880,haste:1095},140792:{ilvl:870,int:1560},140791:{ilvl:870,crit:1055},140809:{ilvl:880,int:1712},140805:{ilvl:875,int:1634},140801:{ilvl:875,mastery:1075},144406:{ilvl:870,int:1231,crit:340,mastery:767}},baseMana=22e4,spellManaCost={77472:.09*baseMana,1064:.25*baseMana,61295:.08*baseMana,73685:.05*baseMana,5394:.11*baseMana,157153:.086*baseMana,8004:.2*baseMana,73920:21.6/100*baseMana,79206:.141*baseMana,198838:.11*baseMana,98008:.11*baseMana,108280:5.6/100*baseMana,188838:.15*baseMana,51505:.06*baseMana,192058:.1*baseMana,207399:.11*baseMana,197995:.35*baseMana},velensBlackList={98021:!0,208981:!0,198838:!0,235967:!0,206985:!0,143924:!0},chestBlackList={98021:!0,198838:!0,206985:!0,143924:!0,114942:!0,52042:!0,208899:!0},spellsIgnoreStat={98021:!0,157503:!0,206985:!0,198838:!0,208981:!0,188016:!0,143924:!0,59547:!0},spellsNotIgnoreInt={157503:!0},cooldownsTrackingIDs={108281:!0,235966:!0,114052:!0,29166:!0},cooldownsTrackingIDsbyCast={157153:16e3},ignoredSpellsForCDTracking={198839:!0,201633:!0,5672:!0},notHealingFromMana={98021:!0,208981:!0,206985:!0,143924:!0,188016:!0,59547:!0,207778:!0,114942:!0,198838:!0},vantusRunes={192776:"guldan",192768:"anomaly",192775:"elisande",192772:"telarn",192773:"krosus",192767:"scorp",192770:"aluriel",192774:"etraeus",192771:"tich",192769:"trillax"},statsBuffs={vers:{240670:600},crit:{240671:800,190909:1e3,225749:3892},haste:{240673:800,225753:3892},haste_mod:{80353:1.3,2825:1.3,32182:1.3,208052:1.25},mastery:{225752:3892,240672:600},int:{33697:2137}},buffStatus=[],darkmoonCardBuffs_Mana={191615:317,191616:436,191617:555,191618:674,191619:792,191620:911,191621:1030,191622:1268},spellAffectedByHaste={73921:!0,114942:!0},spellNotAffectedByHaste={208899:!0},diffIdToName={3:"Normal",4:"Heroic",5:"Mythic"},classes={Priest:!0,Warlock:!0,Druid:!0,Hunter:!0,DemonHunter:!0,Shaman:!0,Monk:!0,Mage:!0,DeathKnight:!0,Paladin:!0,Warrior:!0,Rogue:!0},qualityColors={10:"e45a5a",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80"},itemsBonusToStats={605:"mastery",603:"crit",607:"vers",604:"haste"},jewelSlots={10:!0,11:!0,1:!0},gemToStat={130222:["mastery",150],130220:["haste",150],130219:["crit",150],130221:["vers",150],130248:["int",200]},enchToStat={5436:["int",200],5469:["int",200],5890:["mastery",600],5429:["mastery",150],5427:["crit",150],5428:["haste",150],5430:["vers",150]},WCL_API_KEY="c715943c916421282ae9451912918422",actors=[],actorsData=[],fightsData=[],healingData=[],currFightData=[],pV={},rV={talents:[],traits:[],resurgence:[],potions:[],buffs:{vers:[],crit:[],haste:[],haste_mod:[],mastery:[],int:[]},healFromMana:0,manaUsage:0,manaGain:0},cV={traitInfo:[],gearInfo:[],talentInfo:[],spellInfo:[]},currHP=[],healPerStat={int:{amount:0,total:0,avg:0,avgCount:0},crit:{amount:0,total:0,avg:0,avgCount:0},haste:{amount:0,total:0,avg:0,avgCount:0},mastery:{amount:0,total:0,avg:0,avgCount:0,all:0},vers:{amount:0,total:0,avg:0,avgCount:0}},cooldownsTracking=[],sltTracking=[],reportFightCode,ITEMS=[{init:function(){rV.velensAmount=0},parse:["heal",function(t,e,a){pV.velensEnabled&&!velensBlackList[e]?rV.velensAmount+=a*(1-1/1.15):235967==e&&(rV.velensAmount+=a)},"applybuff",function(t,e){235966==e&&(pV.velensEnabled=!0)},"removebuff",function(t,e){235966==e&&(pV.velensEnabled=!1)}],obj:{type:"item",name:"Velen's Future Sight",quality:5,id:144258,gear:"velensAmount"}},{init:function(){rV.tidecallersAmount=0,rV.tidecallersPredictionAmount=0},parse:["heal",function(t,e,a){114942==e&&pV.tidecallersLast&&t.timestamp>=pV.tidecallersLast&&(rV.tidecallersAmount+=a)},"cast",function(t,e){108280==e&&(pV.tidecallersLast=t.timestamp+1e4)}],afterParse:function(){healingData[52042]&&(rV.tidecallersAmount+=.16666*healingData[52042][0],rV.tidecallersPredictionAmount+=.2*healingData[52042][0]),healingData[208899]&&(rV.tidecallersAmount+=.16666*healingData[208899][0],rV.tidecallersPredictionAmount+=.2*healingData[208899][0]),healingData[114942]&&(rV.tidecallersPredictionAmount+=.2*healingData[114942][0])},obj:{type:"item",name:"Praetorian's Tidecallers",quality:5,id:137058,prediction:"tidecallersPredictionAmount",gear:"tidecallersAmount"}},{init:function(){rV.jonatAmount=0,pV.jonatCount=0,rV.jonatPredictionAmount=0,pV.jonatLast=0,pV.jonatPredictionLast=0,pV.jonatPredictionCount=0,pV.jonatPredictionCountNow=0},parse:["heal",function(t,e,a){1064==e&&(t.timestamp<pV.jonatLast&&(rV.jonatAmount+=a*(1-1/(1+.1*pV.jonatCount))),t.timestamp<pV.jonatPredictionLast&&(rV.jonatPredictionAmount+=a*(.1*pV.jonatPredictionCountNow)))},"cast",function(t,e){1064==e?(pV.jonatPredictionCountNow=pV.jonatPredictionCount,pV.jonatPredictionLast=t.timestamp+1e3,pV.jonatPredictionCount=0):77472!=e&&8004!=e||(pV.jonatPredictionCount=Math.min(pV.jonatPredictionCount+1,5))},"applybuff",function(t,e){210607==e&&(pV.jonatCount=1)},"applybuffstack",function(t,e){210607==e&&(pV.jonatCount=t.stack)},"removebuff",function(t,e){210607==e&&(pV.jonatLast=t.timestamp+500)},"removebuffstack",function(t,e){210607==e&&(pV.jonatLast=t.timestamp+500)}],obj:{type:"item",name:"Focuser of Jonat, the Elder",quality:5,id:137051,prediction:"jonatPredictionAmount",gear:"jonatAmount"}},{init:function(){rV.prydazAmount=0,rV.prydazPredictionAmount=0,pV.prydazNextReset=0,pV.prydazCurrent=0},parse:["damage",function(t,e){if(t.targetID==currFightData.actor&&currHP[t.targetID]){if(t.timestamp>pV.prydazNextReset)for(pV.prydazCurrent=.25*currHP[t.targetID].max;pV.prydazNextReset<t.timestamp;)pV.prydazNextReset+=3e4;var a=Math.min(pV.prydazCurrent,t.amount);rV.prydazPredictionAmount+=a,pV.prydazCurrent-=a}},"combantantInfo",function(t){pV.prydazNextReset=t.timestamp-1}],afterParse:function(){healingData[207472]&&(rV.prydazAmount=healingData[207472][0])},obj:{type:"item",name:"Prydaz, Xavaric's Magnum Opus",quality:5,id:132444,prediction:"prydazPredictionAmount",gear:"prydazAmount"}},{init:function(){rV.t20_2p_PredictionAmount=0,pV.t20_2p_gearCount=0,pV.t20_2p_last=0,pV.t20_2p_curr=0},parse:["heal",function(t,e,a){61295!=e||t.tick||(t.timestamp>pV.t20_2p_last&&(pV.t20_2p_last=t.timestamp+6e4,pV.t20_2p_curr=2),pV.t20_2p_curr>0&&(1==t.hitType&&(rV.t20_2p_PredictionAmount+=a,pV.t20_4p_PredictionNext=t.timestamp+15e3),pV.t20_2p_curr--))},"gear",function(t,e){147175!=e&&147176!=e&&147177!=e&&147178!=e&&147179!=e&&147180!=e||pV.t20_2p_gearCount++}],obj:{type:"spell",name:"T20 2 set Bonus",quality:10,id:242287,prediction:"t20_2p_PredictionAmount","predictionСondition":function(){return pV.t20_2p_gearCount<2}}},{init:function(){rV.t20_4p_PredictionAmount=0,pV.t20_4p_gearCount=0,pV.t20_4p_PredictionNext=0},parse:["heal",function(t,e,a){61295!=e||t.tick||2!=t.hitType?73921==e&&pV.t20_4p_PredictionEnabled&&(rV.t20_4p_PredictionAmount+=.5*a):pV.t20_4p_PredictionNext=t.timestamp+15e3},"cast",function(t,e){73920==e&&(pV.t20_4p_PredictionEnabled=!1,t.timestamp<pV.t20_4p_PredictionNext&&(pV.t20_4p_PredictionEnabled=!0),pV.t20_4p_PredictionNext=0)},"gear",function(t,e){147175!=e&&147176!=e&&147177!=e&&147178!=e&&147179!=e&&147180!=e||pV.t20_4p_gearCount++}],obj:{type:"spell",name:"T20 4 set Bonus",quality:10,id:242288,prediction:"t20_4p_PredictionAmount","predictionСondition":function(){return pV.t20_2p_gearCount<4}}},{init:function(){rV.paradoxAmount=0,rV.paradoxMana=0},parse:["energize",function(t,e){225772==e&&(rV.manaGain+=19800,rV.paradoxAmount+=$event.resourceChange+19800,$manaUsage-=19800)}],afterParse:function(){rV.paradoxMana=rV.paradoxAmount,rV.paradoxAmount=rV.paradoxMana/rV.manaUsage*rV.healFromMana},obj:{type:"item",name:"Ephemeral Paradox",quality:4,id:140805,gear:"paradoxAmount",text:function(){return"Mana gain: "+NumberToFormattedNumber(rV.paradoxMana,0,2)}}}],TRAITS=[{init:function(){rV.traits[1352]=0},parse:["heal",function(t,e,a){spellsIgnoreStat[e]&&!spellsNotIgnoreInt[e]||(rV.traits[1352]+=a*(1-1/1.06))}],obj:{name:"Grace of the Sea",id:1352,spellID:224841,icon:"inv_elemental_crystal_water.jpg"}},{init:function(){rV.traits[1693]=0},parse:["heal",function(t,e,a){spellsIgnoreStat[e]&&!spellsNotIgnoreInt[e]||(rV.traits[1693]+=a*(1-1/1.1))}],obj:{name:"Echo of the Earthen Ring",id:1693,spellID:241205,icon:"misc_legionfall_shaman.jpg"}},{init:function(){rV.traits[1600]=0},parse:["heal",function(t,e,a){spellsIgnoreStat[e]&&!spellsNotIgnoreInt[e]||pV.paragonTraitActive&&GetTraitRank(1600)>0&&(rV.traits[1600]+=a/cV.intellect*(1.05*(4e3+300*(GetTraitRank(1600)-1))))},"applybuff",function(t,e){242586==e&&(pV.paragonTraitActive=!0)},"removebuff",function(t,e){242586==e&&(pV.paragonTraitActive=!1)}],obj:{name:"Concordance of the Legionfall",id:1600,spellID:239042,icon:"trade_archaeology_sharkjaws.jpg",additionalText:function(){var t=GetTraitRank(1600);if(1==t)return"";var e=300*t/(300*t+4e3)*rV.traits[1600];return t--,"Per rank: "+NumberToFormattedNumber(e/t,0,2)+" ("+(e/t/rV.total*100).toFixed(2)+"%)"}}},{init:function(){rV.traits[1112]=0},parse:["heal",function(t,e,a){spellsIgnoreStat[e]&&!spellsNotIgnoreInt[e]||pV.blTraitActive&&(rV.traits[1112]+=a*(1-.8))},"applybuff",function(t,e){208416==e&&(pV.blTraitActive=!0)},"removebuff",function(t,e){208416==e&&(pV.blTraitActive=!1)}],obj:{name:"Sense of Urgency",id:1112,spellID:207355,icon:"inv_misc_pocketwatch_02.jpg"}},{init:function(){rV.traits[1109]=0},parse:["heal",function(t,e,a){1064==e&&2==t.hitType&&(rV.traits[1109]+=pV.critAmount*(4*GetTraitRank(1109)*400/pV.critNow))}],obj:{name:"Floodwaters",id:1109,spellID:207348,icon:"spell_nature_healingwavegreater.jpg"}},{init:function(){rV.traits[1107]=0},parse:["heal",function(t,e,a){73921==e&&(2==t.hitType&&(rV.traits[1107]+=pV.critAmount*(2*GetTraitRank(1107)*400/pV.critNow)),rV.traits[1107]+=a*(1-1/(1+.02*GetTraitRank(1107))))}],obj:{name:"Empowered Droplets",id:1107,spellID:207255,icon:"spell_nature_giftofthewaterspirit.jpg"}},{init:function(){rV.traits[1113]=0},afterParse:function(){rV.trait_1113=rV.traits[1113],rV.traits[1113]=rV.traits[1113]/rV.manaUsage*rV.healFromMana},parse:["energize",function(t,e){101033==e&&4125==t.resourceChange&&(rV.traits[1113]+=1325)}],obj:{name:"Refreshing Currents",id:1113,spellID:207356,icon:"ability_monk_cracklingjadelightning.jpg",additionalText:function(){return"Total mana gained: "+NumberToFormattedNumber(rV.trait_1113,0,2)}}},{init:function(){rV.traits[1117]=0,pV.httTraitLast=0,pV.httTraitCount=0},parse:["heal",function(t,e,a){114942==e&&(t.timestamp-pV.httTraitLast>15e3?pV.httTraitCount=0:t.timestamp-pV.httTraitLast>=300&&(pV.httTraitCount=Math.min(pV.httTraitCount+1,7)),pV.httTraitLast=t.timestamp,rV.traits[1117]+=a*(1-1/(1+.1*pV.httTraitCount)))}],obj:{name:"Cumulative Upkeep",id:1117,spellID:207362,icon:"ability_shaman_healingtide.jpg"}},{init:function(){rV.traits[1598]=0},parse:["heal",function(t,e,a){73921==e&&(rV.traits[1598]+=a*(1-1/1.3))}],obj:{name:"Pitter-Patter",id:1598,spellID:242652,icon:"spell_nature_giftofthewaterspirit.jpg"}},{init:function(){rV.traits[1599]=0,pV.gotqLast=0},parse:["heal",function(t,e,a){207778==e&&t.timestamp-pV.gotqLast>2e3&&t.timestamp-pV.gotqLast<4e3&&(rV.traits[1599]+=a)},"cast",function(t,e){207778==e&&(pV.gotqLast=t.timestamp)}],obj:{name:"Deep Waters",id:1599,spellID:238143,icon:"inv_mace_1h_artifactazshara_d_02.jpg"}},{init:function(){rV.traits[1116]=0},afterParse:function(){healingData[208899]&&(rV.traits[1116]=healingData[208899][0])},obj:{name:"Queen's Decree",id:1116,spellID:207360,icon:"inv_misc_volatilewater.jpg"}},{init:function(){rV.traits[1115]=0},afterParse:function(){healingData[209069]&&(rV.traits[1115]=healingData[209069][0])},obj:{name:"Tidal Pools",id:1115,spellID:207358,icon:"achievement_dungeon_throneofthetides.jpg"}},{init:function(){rV.traits[1105]=0},parse:["heal",function(t,e,a){207778==e&&(rV.traits[1105]+=a*(1-1/(1+.05*GetTraitRank(1105))))}],obj:{name:"Pull of the Sea",id:1105,spellID:210031,icon:"inv_tradeskillitem_sorcererswater.jpg"}},{init:function(){rV.traits[1106]=0},parse:["heal",function(t,e,a){52042==e&&(rV.traits[1106]+=a*(1-1/(1+.1*GetTraitRank(1106))))}],obj:{name:"Wavecrash",id:1106,spellID:207206,icon:"inv_spear_04.jpg"}},{init:function(){rV.traits[1104]=0},parse:["heal",function(t,e,a){77472!=e&&8004!=e||(rV.traits[1104]+=a*(1-1/(1+.05*GetTraitRank(1104))))}],obj:{name:"Buffeting Waves",id:1104,spellID:207092,icon:"ability_skyreach_four_wind.jpg"}}],TALENTS=[{init:function(){rV.talents[157153]=0},afterParse:function(){healingData[157503]&&(rV.talents[157153]=healingData[157503][0])},obj:{name:"Cloudburst Totem",id:157153}},{init:function(){rV.talents[200072]=0},parse:["heal",function(t,e,a){61295!=e||t.tick||(rV.talents[200072]+=a*(1-1/1.3))}],obj:{name:"Torrent",id:200072}},{init:function(){rV.talents[73685]=0,pV.ulLossTime=0},parse:["heal",function(t,e,a){t.timestamp-pV.ulLossTime<=300&&(61295==e&&!t.tick||77472==e||8004==e||1064==e)&&(rV.talents[73685]+=a*(1-1/1.45))},"removebuff",function(t,e){73685==e&&(pV.ulLossTime=t.timestamp)}],obj:{name:"Unleash Life",id:73685}},{init:function(){rV.talents[108281]=0},afterParse:function(){healingData[114911]&&(rV.talents[108281]=healingData[114911][0])},obj:{name:"Ancestral Guidance",id:108281}},{init:function(){rV.talents[198838]=0},afterParse:function(){healingData[201633]&&(rV.talents[198838]=healingData[201633][0])},obj:{name:"Earthen Shield Totem",id:198838}},{init:function(){rV.talents[114052]=0},afterParse:function(){healingData[114083]&&(rV.talents[114052]=healingData[114083][0])},obj:{name:"Ascendance",id:114052}},{init:function(){rV.talents[197995]=0},afterParse:function(){healingData[197997]&&(rV.talents[197995]=healingData[197997][0])},obj:{name:"Wellspring",id:197995}},{init:function(){rV.talents[157154]=0,pV.highTideBounds=0},parse:["heal",function(t,e,a){1064==e&&(pV.highTideBounds>=4?rV.talents[157154]+=a:rV.talents[157154]+=a*(1-Math.pow(.7,pV.highTideBounds)/Math.pow(.85,pV.highTideBounds)),pV.highTideBounds++)},"cast",function(t,e){1064==e&&(pV.highTideBounds=0)}],obj:{name:"High Tide",id:157154}},{init:function(){rV.talents[200071]=0,pV.undulationLossTime=0},parse:["heal",function(t,e,a){(77472==e||8004==e)&&t.timestamp-pV.undulationLossTime<=300&&(rV.talents[200071]+=a*(1-1/1.5))},"removebuff",function(t,e){216251==e&&(pV.undulationLossTime=t.timestamp)}],obj:{name:"Undulation",id:200071}}],RESURGENCE=[{init:function(){rV.resurgence[8004]=[0,0]},parse:["cast",function(t,e){8004==e&&(pV.resurgenceLast6600=8004)},"energize",function(t,e){6600==t.resourceChange&&101033==e&&8004==pV.resurgenceLast6600&&(rV.resurgence[8004][0]+=t.resourceChange,rV.resurgence[8004][1]++)}],obj:{id:8004,name:"Healing Surge",icon:"spell_nature_healingway.jpg"}},{init:function(){rV.resurgence[61295]=[0,0]},parse:["cast",function(t,e){61295==e&&(pV.resurgenceLast6600=61295)},"energize",function(t,e){6600==t.resourceChange&&101033==e&&61295==pV.resurgenceLast6600&&(rV.resurgence[61295][0]+=t.resourceChange,rV.resurgence[61295][1]++)}],obj:{id:61295,name:"Riptide",icon:"spell_nature_riptide.jpg"}},{init:function(){rV.resurgence[73685]=[0,0]},parse:["cast",function(t,e){73685==e&&(pV.resurgenceLast6600=73685)},"energize",function(t,e){6600==t.resourceChange&&101033==e&&73685==pV.resurgenceLast6600&&(rV.resurgence[73685][0]+=t.resourceChange,rV.resurgence[73685][1]++)}],obj:{id:73685,name:"Unleash Life",icon:"spell_shaman_unleashweapon_life.jpg"}},{init:function(){rV.resurgence[1064]=[0,0]},parse:["energize",function(t,e){4125!=t.resourceChange&&2750!=t.resourceChange||101033!=e||(rV.resurgence[1064][0]+=t.resourceChange,rV.resurgence[1064][1]++)}],obj:{id:1064,name:"Chain Heal",icon:"spell_nature_healingwavegreater.jpg"}},{init:function(){rV.resurgence[77472]=[0,0]},parse:["energize",function(t,e){11e3==t.resourceChange&&101033==e&&(rV.resurgence[77472][0]+=t.resourceChange,rV.resurgence[77472][1]++)}],obj:{id:77472,name:"Healing Wave",icon:"spell_nature_healingwavelesser.jpg"}}],POTIONS=[{init:function(){rV.potions[188016]=0},parse:["heal",function(t,e,a){188016==e&&(rV.potions[188016]+=a)}],obj:{id:188016,name:"Ancient Healing Potion",icon:"inv_alchemy_70_red.jpg"}},{init:function(){rV.potions[229206]=0,rV.prolongedTemp=0},parse:["heal",function(t,e,a){spellsIgnoreStat[e]&&!spellsNotIgnoreInt[e]||(pV.prolongedActive?rV.potions[229206]+=a/cV.intellect*2500*1.05:rV.prolongedTemp+=a/cV.intellect*2500*1.05)},"applybuff",function(t,e){229206==e&&(pV.prolongedActive=!0)},"removebuff",function(t,e){229206==e&&(pV.prolongedActive||(rV.potions[229206]=rV.prolongedTemp),pV.prolongedActive=!1)}],obj:{id:229206,name:"Potion of Prolonged Power",icon:"trade_alchemy_dpotion_a28.jpg"}},{init:function(){rV.potions[188017]=0},parse:["energize",function(t,e){188017==e&&(rV.potions[188017]+=t.resourceChange)}],obj:{id:188017,name:"Ancient Mana Potion",icon:"inv_alchemy_70_blue.jpg",text:function(){var t=rV.potions[188017]/rV.manaUsage*rV.healFromMana;return'Mana gained: <em class="result">'+NumberToFormattedNumber(rV.potions[188017],0,2)+"</em> ("+(rV.potions[188017]/rV.manaUsage*100).toFixed(2)+'%)<br>Helaing: <em class="result-hps">'+NumberToFormattedNumber(t,0,2)+"</em>"}}},{init:function(){rV.potions[188030]=0},parse:["energize",function(t,e){188030==e&&(rV.potions[188030]+=t.resourceChange)}],obj:{id:188030,name:"Leytorrent Potion",icon:"inv_alchemy_70_flask01.jpg",text:function(){var t=rV.potions[188030]/rV.manaUsage*rV.healFromMana;return'Mana gained: <em class="result">'+NumberToFormattedNumber(rV.potions[188030],0,2)+"</em> ("+(rV.potions[188030]/rV.manaUsage*100).toFixed(2)+'%)<br>Helaing: <em class="result-hps">'+NumberToFormattedNumber(t,0,2)+"</em>"}}}],parsePlugins={heal:[],applybuff:[],applybuffstack:[],removebuff:[],removebuffstack:[],cast:[],damage:[],energize:[],gear:[],combantantInfo:[]},pluginsList=[ITEMS,TRAITS,TALENTS,RESURGENCE,POTIONS],k=0,k_len=pluginsList.length;k<k_len;k++)for(var pluginData=pluginsList[k],i=0,len=pluginData.length;i<len;i++)if(pluginData[i].parse)for(var j=0,j_len=pluginData[i].parse.length;j<j_len;j+=2)parsePlugins[pluginData[i].parse[j]].push(pluginData[i].parse[j+1]);var IsWowheadResponceRewritten=!1;$(document).ready(function(){var t=QueryString();t.report&&t.fight&&t.actor?ParseHeader(reportFightCode=t.report,!1,function(){PrepParse(t.fight,t.actor)}):t.report?ParseHeader(reportFightCode=t.report,!0):BuildMainPage()});